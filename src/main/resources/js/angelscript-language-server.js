"use strict";var Yg=Object.create;var Wu=Object.defineProperty;var Zg=Object.getOwnPropertyDescriptor;var ey=Object.getOwnPropertyNames;var ty=Object.getPrototypeOf,ny=Object.prototype.hasOwnProperty;var L=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var iy=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ey(t))!ny.call(e,o)&&o!==n&&Wu(e,o,{get:()=>t[o],enumerable:!(i=Zg(t,o))||i.enumerable});return e};var ue=(e,t,n)=>(n=e!=null?Yg(ty(e)):{},iy(t||!e||!e.__esModule?Wu(n,"default",{value:e,enumerable:!0}):n,e));var Io=L(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.thenable=xe.typedArray=xe.stringArray=xe.array=xe.func=xe.error=xe.number=xe.string=xe.boolean=void 0;function oy(e){return e===!0||e===!1}xe.boolean=oy;function Hu(e){return typeof e=="string"||e instanceof String}xe.string=Hu;function ry(e){return typeof e=="number"||e instanceof Number}xe.number=ry;function sy(e){return e instanceof Error}xe.error=sy;function Vu(e){return typeof e=="function"}xe.func=Vu;function $u(e){return Array.isArray(e)}xe.array=$u;function ay(e){return $u(e)&&e.every(t=>Hu(t))}xe.stringArray=ay;function cy(e,t){return Array.isArray(e)&&e.every(t)}xe.typedArray=cy;function uy(e){return e&&Vu(e.then)}xe.thenable=uy});var Wn=L(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.stringArray=Ie.array=Ie.func=Ie.error=Ie.number=Ie.string=Ie.boolean=void 0;function dy(e){return e===!0||e===!1}Ie.boolean=dy;function zu(e){return typeof e=="string"||e instanceof String}Ie.string=zu;function ly(e){return typeof e=="number"||e instanceof Number}Ie.number=ly;function fy(e){return e instanceof Error}Ie.error=fy;function py(e){return typeof e=="function"}Ie.func=py;function Uu(e){return Array.isArray(e)}Ie.array=Uu;function my(e){return Uu(e)&&e.every(t=>zu(t))}Ie.stringArray=my});var ma=L(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.Message=F.NotificationType9=F.NotificationType8=F.NotificationType7=F.NotificationType6=F.NotificationType5=F.NotificationType4=F.NotificationType3=F.NotificationType2=F.NotificationType1=F.NotificationType0=F.NotificationType=F.RequestType9=F.RequestType8=F.RequestType7=F.RequestType6=F.RequestType5=F.RequestType4=F.RequestType3=F.RequestType2=F.RequestType1=F.RequestType=F.RequestType0=F.AbstractMessageSignature=F.ParameterStructures=F.ResponseError=F.ErrorCodes=void 0;var vn=Wn(),$s;(function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3})($s||(F.ErrorCodes=$s={}));var zs=class e extends Error{constructor(t,n,i){super(n),this.code=vn.number(t)?t:$s.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,e.prototype)}toJson(){let t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),t}};F.ResponseError=zs;var He=class e{constructor(t){this.kind=t}static is(t){return t===e.auto||t===e.byName||t===e.byPosition}toString(){return this.kind}};F.ParameterStructures=He;He.auto=new He("auto");He.byPosition=new He("byPosition");He.byName=new He("byName");var de=class{constructor(t,n){this.method=t,this.numberOfParams=n}get parameterStructures(){return He.auto}};F.AbstractMessageSignature=de;var Us=class extends de{constructor(t){super(t,0)}};F.RequestType0=Us;var Gs=class extends de{constructor(t,n=He.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};F.RequestType=Gs;var Ks=class extends de{constructor(t,n=He.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};F.RequestType1=Ks;var Qs=class extends de{constructor(t){super(t,2)}};F.RequestType2=Qs;var Js=class extends de{constructor(t){super(t,3)}};F.RequestType3=Js;var Xs=class extends de{constructor(t){super(t,4)}};F.RequestType4=Xs;var Ys=class extends de{constructor(t){super(t,5)}};F.RequestType5=Ys;var Zs=class extends de{constructor(t){super(t,6)}};F.RequestType6=Zs;var ea=class extends de{constructor(t){super(t,7)}};F.RequestType7=ea;var ta=class extends de{constructor(t){super(t,8)}};F.RequestType8=ta;var na=class extends de{constructor(t){super(t,9)}};F.RequestType9=na;var ia=class extends de{constructor(t,n=He.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};F.NotificationType=ia;var oa=class extends de{constructor(t){super(t,0)}};F.NotificationType0=oa;var ra=class extends de{constructor(t,n=He.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};F.NotificationType1=ra;var sa=class extends de{constructor(t){super(t,2)}};F.NotificationType2=sa;var aa=class extends de{constructor(t){super(t,3)}};F.NotificationType3=aa;var ca=class extends de{constructor(t){super(t,4)}};F.NotificationType4=ca;var ua=class extends de{constructor(t){super(t,5)}};F.NotificationType5=ua;var da=class extends de{constructor(t){super(t,6)}};F.NotificationType6=da;var la=class extends de{constructor(t){super(t,7)}};F.NotificationType7=la;var fa=class extends de{constructor(t){super(t,8)}};F.NotificationType8=fa;var pa=class extends de{constructor(t){super(t,9)}};F.NotificationType9=pa;var Gu;(function(e){function t(o){let r=o;return r&&vn.string(r.method)&&(vn.string(r.id)||vn.number(r.id))}e.isRequest=t;function n(o){let r=o;return r&&vn.string(r.method)&&o.id===void 0}e.isNotification=n;function i(o){let r=o;return r&&(r.result!==void 0||!!r.error)&&(vn.string(r.id)||vn.number(r.id)||r.id===null)}e.isResponse=i})(Gu||(F.Message=Gu={}))});var ga=L(zt=>{"use strict";var Ku;Object.defineProperty(zt,"__esModule",{value:!0});zt.LRUCache=zt.LinkedMap=zt.Touch=void 0;var Fe;(function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last})(Fe||(zt.Touch=Fe={}));var Fo=class{constructor(){this[Ku]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(t){return this._map.has(t)}get(t,n=Fe.None){let i=this._map.get(t);if(i)return n!==Fe.None&&this.touch(i,n),i.value}set(t,n,i=Fe.None){let o=this._map.get(t);if(o)o.value=n,i!==Fe.None&&this.touch(o,i);else{switch(o={key:t,value:n,next:void 0,previous:void 0},i){case Fe.None:this.addItemLast(o);break;case Fe.First:this.addItemFirst(o);break;case Fe.Last:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(t,o),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){let n=this._map.get(t);if(n)return this._map.delete(t),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,n){let i=this._state,o=this._head;for(;o;){if(n?t.bind(n)(o.value,o.key,this):t(o.value,o.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let t=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let t=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let t=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(Ku=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let n=this._head,i=this.size;for(;n&&i>t;)this._map.delete(n.key),n=n.next,i--;this._head=n,this._size=i,n&&(n.previous=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{let n=t.next,i=t.previous;if(!n||!i)throw new Error("Invalid list");n.previous=i,i.next=n}t.next=void 0,t.previous=void 0,this._state++}touch(t,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Fe.First&&n!==Fe.Last)){if(n===Fe.First){if(t===this._head)return;let i=t.next,o=t.previous;t===this._tail?(o.next=void 0,this._tail=o):(i.previous=o,o.next=i),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(n===Fe.Last){if(t===this._tail)return;let i=t.next,o=t.previous;t===this._head?(i.previous=void 0,this._head=i):(i.previous=o,o.next=i),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){let t=[];return this.forEach((n,i)=>{t.push([i,n])}),t}fromJSON(t){this.clear();for(let[n,i]of t)this.set(n,i)}};zt.LinkedMap=Fo;var ha=class extends Fo{constructor(t,n=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,n=Fe.AsNew){return super.get(t,n)}peek(t){return super.get(t,Fe.None)}set(t,n){return super.set(t,n,Fe.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};zt.LRUCache=ha});var Ju=L(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.Disposable=void 0;var Qu;(function(e){function t(n){return{dispose:n}}e.create=t})(Qu||(Ao.Disposable=Qu={}))});var Ut=L(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});var ya;function ba(){if(ya===void 0)throw new Error("No runtime abstraction layer installed");return ya}(function(e){function t(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");ya=n}e.install=t})(ba||(ba={}));Ta.default=ba});var Vn=L(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.Emitter=Hn.Event=void 0;var hy=Ut(),Xu;(function(e){let t={dispose(){}};e.None=function(){return t}})(Xu||(Hn.Event=Xu={}));var Sa=class{add(t,n=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(t),this._contexts.push(n),Array.isArray(i)&&i.push({dispose:()=>this.remove(t,n)})}remove(t,n=null){if(!this._callbacks)return;let i=!1;for(let o=0,r=this._callbacks.length;o<r;o++)if(this._callbacks[o]===t)if(this._contexts[o]===n){this._callbacks.splice(o,1),this._contexts.splice(o,1);return}else i=!0;if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...t){if(!this._callbacks)return[];let n=[],i=this._callbacks.slice(0),o=this._contexts.slice(0);for(let r=0,s=i.length;r<s;r++)try{n.push(i[r].apply(o[r],t))}catch(u){(0,hy.default)().console.error(u)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Mo=class e{constructor(t){this._options=t}get event(){return this._event||(this._event=(t,n,i)=>{this._callbacks||(this._callbacks=new Sa),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(t,n);let o={dispose:()=>{this._callbacks&&(this._callbacks.remove(t,n),o.dispose=e._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(o),o}),this._event}fire(t){this._callbacks&&this._callbacks.invoke.call(this._callbacks,t)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Hn.Emitter=Mo;Mo._noop=function(){}});var Bo=L($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.CancellationTokenSource=$n.CancellationToken=void 0;var gy=Ut(),yy=Wn(),va=Vn(),qo;(function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:va.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:va.Event.None});function t(n){let i=n;return i&&(i===e.None||i===e.Cancelled||yy.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}e.is=t})(qo||($n.CancellationToken=qo={}));var by=Object.freeze(function(e,t){let n=(0,gy.default)().timer.setTimeout(e.bind(t),0);return{dispose(){n.dispose()}}}),jo=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?by:(this._emitter||(this._emitter=new va.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},xa=class{get token(){return this._token||(this._token=new jo),this._token}cancel(){this._token?this._token.cancel():this._token=qo.Cancelled}dispose(){this._token?this._token instanceof jo&&this._token.dispose():this._token=qo.None}};$n.CancellationTokenSource=xa});var Yu=L(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.SharedArrayReceiverStrategy=zn.SharedArraySenderStrategy=void 0;var Ty=Bo(),Oi;(function(e){e.Continue=0,e.Cancelled=1})(Oi||(Oi={}));var Na=class{constructor(){this.buffers=new Map}enableCancellation(t){if(t.id===null)return;let n=new SharedArrayBuffer(4),i=new Int32Array(n,0,1);i[0]=Oi.Continue,this.buffers.set(t.id,n),t.$cancellationData=n}async sendCancellation(t,n){let i=this.buffers.get(n);if(i===void 0)return;let o=new Int32Array(i,0,1);Atomics.store(o,0,Oi.Cancelled)}cleanup(t){this.buffers.delete(t)}dispose(){this.buffers.clear()}};zn.SharedArraySenderStrategy=Na;var ka=class{constructor(t){this.data=new Int32Array(t,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Oi.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Ra=class{constructor(t){this.token=new ka(t)}cancel(){}dispose(){}},Pa=class{constructor(){this.kind="request"}createCancellationTokenSource(t){let n=t.$cancellationData;return n===void 0?new Ty.CancellationTokenSource:new Ra(n)}};zn.SharedArrayReceiverStrategy=Pa});var _a=L(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.Semaphore=void 0;var Sy=Ut(),Ca=class{constructor(t=1){if(t<=0)throw new Error("Capacity must be greater than 0");this._capacity=t,this._active=0,this._waiting=[]}lock(t){return new Promise((n,i)=>{this._waiting.push({thunk:t,resolve:n,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Sy.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let t=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=t.thunk();n instanceof Promise?n.then(i=>{this._active--,t.resolve(i),this.runNext()},i=>{this._active--,t.reject(i),this.runNext()}):(this._active--,t.resolve(n),this.runNext())}catch(n){this._active--,t.reject(n),this.runNext()}}};Wo.Semaphore=Ca});var ed=L(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.ReadableStreamMessageReader=Gt.AbstractMessageReader=Gt.MessageReader=void 0;var Da=Ut(),Un=Wn(),Oa=Vn(),vy=_a(),Zu;(function(e){function t(n){let i=n;return i&&Un.func(i.listen)&&Un.func(i.dispose)&&Un.func(i.onError)&&Un.func(i.onClose)&&Un.func(i.onPartialMessage)}e.is=t})(Zu||(Gt.MessageReader=Zu={}));var Ho=class{constructor(){this.errorEmitter=new Oa.Emitter,this.closeEmitter=new Oa.Emitter,this.partialMessageEmitter=new Oa.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t){this.errorEmitter.fire(this.asError(t))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(t){this.partialMessageEmitter.fire(t)}asError(t){return t instanceof Error?t:new Error(`Reader received error. Reason: ${Un.string(t.message)?t.message:"unknown"}`)}};Gt.AbstractMessageReader=Ho;var wa;(function(e){function t(n){let i,o,r,s=new Map,u,f=new Map;if(n===void 0||typeof n=="string")i=n??"utf-8";else{if(i=n.charset??"utf-8",n.contentDecoder!==void 0&&(r=n.contentDecoder,s.set(r.name,r)),n.contentDecoders!==void 0)for(let g of n.contentDecoders)s.set(g.name,g);if(n.contentTypeDecoder!==void 0&&(u=n.contentTypeDecoder,f.set(u.name,u)),n.contentTypeDecoders!==void 0)for(let g of n.contentTypeDecoders)f.set(g.name,g)}return u===void 0&&(u=(0,Da.default)().applicationJson.decoder,f.set(u.name,u)),{charset:i,contentDecoder:r,contentDecoders:s,contentTypeDecoder:u,contentTypeDecoders:f}}e.fromOptions=t})(wa||(wa={}));var Ea=class extends Ho{constructor(t,n){super(),this.readable=t,this.options=wa.fromOptions(n),this.buffer=(0,Da.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new vy.Semaphore(1)}set partialMessageTimeout(t){this._partialMessageTimeout=t}get partialMessageTimeout(){return this._partialMessageTimeout}listen(t){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=t;let n=this.readable.onData(i=>{this.onData(i)});return this.readable.onError(i=>this.fireError(i)),this.readable.onClose(()=>this.fireClose()),n}onData(t){try{for(this.buffer.append(t);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders(!0);if(!i)return;let o=i.get("content-length");if(!o){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(i))}`));return}let r=parseInt(o);if(isNaN(r)){this.fireError(new Error(`Content-Length value must be a number. Got ${o}`));return}this.nextMessageLength=r}let n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let i=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,o=await this.options.contentTypeDecoder.decode(i,this.options);this.callback(o)}).catch(i=>{this.fireError(i)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Da.default)().timer.setTimeout((t,n)=>{this.partialMessageTimer=void 0,t===this.messageToken&&(this.firePartialMessage({messageToken:t,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};Gt.ReadableStreamMessageReader=Ea});var rd=L(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.WriteableStreamMessageWriter=Kt.AbstractMessageWriter=Kt.MessageWriter=void 0;var td=Ut(),Di=Wn(),xy=_a(),nd=Vn(),Ny="Content-Length: ",id=`\r
`,od;(function(e){function t(n){let i=n;return i&&Di.func(i.dispose)&&Di.func(i.onClose)&&Di.func(i.onError)&&Di.func(i.write)}e.is=t})(od||(Kt.MessageWriter=od={}));var Vo=class{constructor(){this.errorEmitter=new nd.Emitter,this.closeEmitter=new nd.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t,n,i){this.errorEmitter.fire([this.asError(t),n,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(t){return t instanceof Error?t:new Error(`Writer received error. Reason: ${Di.string(t.message)?t.message:"unknown"}`)}};Kt.AbstractMessageWriter=Vo;var La;(function(e){function t(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,td.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,td.default)().applicationJson.encoder}}e.fromOptions=t})(La||(La={}));var Ia=class extends Vo{constructor(t,n){super(),this.writable=t,this.options=La.fromOptions(n),this.errorCount=0,this.writeSemaphore=new xy.Semaphore(1),this.writable.onError(i=>this.fireError(i)),this.writable.onClose(()=>this.fireClose())}async write(t){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(t,this.options).then(i=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(i):i).then(i=>{let o=[];return o.push(Ny,i.byteLength.toString(),id),o.push(id),this.doWrite(t,o,i)},i=>{throw this.fireError(i),i}))}async doWrite(t,n,i){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(i)}catch(o){return this.handleError(o,t),Promise.reject(o)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){this.writable.end()}};Kt.WriteableStreamMessageWriter=Ia});var sd=L($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.AbstractMessageBuffer=void 0;var ky=13,Ry=10,Py=`\r
`,Fa=class{constructor(t="utf-8"){this._encoding=t,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(t){let n=typeof t=="string"?this.fromString(t,this._encoding):t;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(t=!1){if(this._chunks.length===0)return;let n=0,i=0,o=0,r=0;e:for(;i<this._chunks.length;){let g=this._chunks[i];for(o=0;o<g.length;){switch(g[o]){case ky:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case Ry:switch(n){case 1:n=2;break;case 3:n=4,o++;break e;default:n=0}break;default:n=0}o++}r+=g.byteLength,i++}if(n!==4)return;let s=this._read(r+o),u=new Map,f=this.toString(s,"ascii").split(Py);if(f.length<2)return u;for(let g=0;g<f.length-2;g++){let v=f[g],_=v.indexOf(":");if(_===-1)throw new Error(`Message header must separate key and value using ':'
${v}`);let w=v.substr(0,_),ee=v.substr(_+1).trim();u.set(t?w.toLowerCase():w,ee)}return u}tryReadBody(t){if(!(this._totalLength<t))return this._read(t)}get numberOfBytes(){return this._totalLength}_read(t){if(t===0)return this.emptyBuffer();if(t>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===t){let r=this._chunks[0];return this._chunks.shift(),this._totalLength-=t,this.asNative(r)}if(this._chunks[0].byteLength>t){let r=this._chunks[0],s=this.asNative(r,t);return this._chunks[0]=r.slice(t),this._totalLength-=t,s}let n=this.allocNative(t),i=0,o=0;for(;t>0;){let r=this._chunks[o];if(r.byteLength>t){let s=r.slice(0,t);n.set(s,i),i+=t,this._chunks[o]=r.slice(t),this._totalLength-=t,t-=t}else n.set(r,i),i+=r.byteLength,this._chunks.shift(),this._totalLength-=r.byteLength,t-=r.byteLength}return n}};$o.AbstractMessageBuffer=Fa});var ld=L(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.createMessageConnection=B.ConnectionOptions=B.MessageStrategy=B.CancellationStrategy=B.CancellationSenderStrategy=B.CancellationReceiverStrategy=B.RequestCancellationReceiverStrategy=B.IdCancellationReceiverStrategy=B.ConnectionStrategy=B.ConnectionError=B.ConnectionErrors=B.LogTraceNotification=B.SetTraceNotification=B.TraceFormat=B.TraceValues=B.Trace=B.NullLogger=B.ProgressType=B.ProgressToken=void 0;var ad=Ut(),he=Wn(),M=ma(),cd=ga(),wi=Vn(),Aa=Bo(),Ii;(function(e){e.type=new M.NotificationType("$/cancelRequest")})(Ii||(Ii={}));var Ma;(function(e){function t(n){return typeof n=="string"||typeof n=="number"}e.is=t})(Ma||(B.ProgressToken=Ma={}));var Ei;(function(e){e.type=new M.NotificationType("$/progress")})(Ei||(Ei={}));var qa=class{constructor(){}};B.ProgressType=qa;var ja;(function(e){function t(n){return he.func(n)}e.is=t})(ja||(ja={}));B.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var J;(function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"})(J||(B.Trace=J={}));var ud;(function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"})(ud||(B.TraceValues=ud={}));(function(e){function t(i){if(!he.string(i))return e.Off;switch(i=i.toLowerCase(),i){case"off":return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose;default:return e.Off}}e.fromString=t;function n(i){switch(i){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}e.toString=n})(J||(B.Trace=J={}));var Ye;(function(e){e.Text="text",e.JSON="json"})(Ye||(B.TraceFormat=Ye={}));(function(e){function t(n){return he.string(n)?(n=n.toLowerCase(),n==="json"?e.JSON:e.Text):e.Text}e.fromString=t})(Ye||(B.TraceFormat=Ye={}));var Ba;(function(e){e.type=new M.NotificationType("$/setTrace")})(Ba||(B.SetTraceNotification=Ba={}));var zo;(function(e){e.type=new M.NotificationType("$/logTrace")})(zo||(B.LogTraceNotification=zo={}));var Li;(function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"})(Li||(B.ConnectionErrors=Li={}));var Gn=class e extends Error{constructor(t,n){super(n),this.code=t,Object.setPrototypeOf(this,e.prototype)}};B.ConnectionError=Gn;var Wa;(function(e){function t(n){let i=n;return i&&he.func(i.cancelUndispatched)}e.is=t})(Wa||(B.ConnectionStrategy=Wa={}));var Uo;(function(e){function t(n){let i=n;return i&&(i.kind===void 0||i.kind==="id")&&he.func(i.createCancellationTokenSource)&&(i.dispose===void 0||he.func(i.dispose))}e.is=t})(Uo||(B.IdCancellationReceiverStrategy=Uo={}));var Ha;(function(e){function t(n){let i=n;return i&&i.kind==="request"&&he.func(i.createCancellationTokenSource)&&(i.dispose===void 0||he.func(i.dispose))}e.is=t})(Ha||(B.RequestCancellationReceiverStrategy=Ha={}));var Go;(function(e){e.Message=Object.freeze({createCancellationTokenSource(n){return new Aa.CancellationTokenSource}});function t(n){return Uo.is(n)||Ha.is(n)}e.is=t})(Go||(B.CancellationReceiverStrategy=Go={}));var Ko;(function(e){e.Message=Object.freeze({sendCancellation(n,i){return n.sendNotification(Ii.type,{id:i})},cleanup(n){}});function t(n){let i=n;return i&&he.func(i.sendCancellation)&&he.func(i.cleanup)}e.is=t})(Ko||(B.CancellationSenderStrategy=Ko={}));var Qo;(function(e){e.Message=Object.freeze({receiver:Go.Message,sender:Ko.Message});function t(n){let i=n;return i&&Go.is(i.receiver)&&Ko.is(i.sender)}e.is=t})(Qo||(B.CancellationStrategy=Qo={}));var Jo;(function(e){function t(n){let i=n;return i&&he.func(i.handleMessage)}e.is=t})(Jo||(B.MessageStrategy=Jo={}));var dd;(function(e){function t(n){let i=n;return i&&(Qo.is(i.cancellationStrategy)||Wa.is(i.connectionStrategy)||Jo.is(i.messageStrategy))}e.is=t})(dd||(B.ConnectionOptions=dd={}));var gt;(function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"})(gt||(gt={}));function Cy(e,t,n,i){let o=n!==void 0?n:B.NullLogger,r=0,s=0,u=0,f="2.0",g,v=new Map,_,w=new Map,ee=new Map,De,ve=new cd.LinkedMap,Re=new Map,Q=new Set,S=new Map,T=J.Off,C=Ye.Text,W,re=gt.New,ge=new wi.Emitter,ft=new wi.Emitter,yn=new wi.Emitter,Ht=new wi.Emitter,Vt=new wi.Emitter,We=i&&i.cancellationStrategy?i.cancellationStrategy:Qo.Message;function In(p){if(p===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+p.toString()}function Fn(p){return p===null?"res-unknown-"+(++u).toString():"res-"+p.toString()}function bo(){return"not-"+(++s).toString()}function Vs(p,k){M.Message.isRequest(k)?p.set(In(k.id),k):M.Message.isResponse(k)?p.set(Fn(k.id),k):p.set(bo(),k)}function To(p){}function Ni(){return re===gt.Listening}function bn(){return re===gt.Closed}function wt(){return re===gt.Disposed}function An(){(re===gt.New||re===gt.Listening)&&(re=gt.Closed,ft.fire(void 0))}function Tn(p){ge.fire([p,void 0,void 0])}function So(p){ge.fire(p)}e.onClose(An),e.onError(Tn),t.onClose(An),t.onError(So);function ki(){De||ve.size===0||(De=(0,ad.default)().timer.setImmediate(()=>{De=void 0,vo()}))}function Ri(p){M.Message.isRequest(p)?No(p):M.Message.isNotification(p)?Ro(p):M.Message.isResponse(p)?ko(p):Mn(p)}function vo(){if(ve.size===0)return;let p=ve.shift();try{let k=i?.messageStrategy;Jo.is(k)?k.handleMessage(p,Ri):Ri(p)}finally{ki()}}let xo=p=>{try{if(M.Message.isNotification(p)&&p.method===Ii.type.method){let k=p.params.id,O=In(k),I=ve.get(O);if(M.Message.isRequest(I)){let X=i?.connectionStrategy,ce=X&&X.cancelUndispatched?X.cancelUndispatched(I,To):void 0;if(ce&&(ce.error!==void 0||ce.result!==void 0)){ve.delete(O),S.delete(k),ce.id=I.id,Sn(ce,p.method,Date.now()),t.write(ce).catch(()=>o.error("Sending response for canceled message failed."));return}}let te=S.get(k);if(te!==void 0){te.cancel(),qn(p);return}else Q.add(k)}Vs(ve,p)}finally{ki()}};function No(p){if(wt())return;function k(V,ne,G){let ye={jsonrpc:f,id:p.id};V instanceof M.ResponseError?ye.error=V.toJson():ye.result=V===void 0?null:V,Sn(ye,ne,G),t.write(ye).catch(()=>o.error("Sending response failed."))}function O(V,ne,G){let ye={jsonrpc:f,id:p.id,error:V.toJson()};Sn(ye,ne,G),t.write(ye).catch(()=>o.error("Sending response failed."))}function I(V,ne,G){V===void 0&&(V=null);let ye={jsonrpc:f,id:p.id,result:V};Sn(ye,ne,G),t.write(ye).catch(()=>o.error("Sending response failed."))}_o(p);let te=v.get(p.method),X,ce;te&&(X=te.type,ce=te.handler);let fe=Date.now();if(ce||g){let V=p.id??String(Date.now()),ne=Uo.is(We.receiver)?We.receiver.createCancellationTokenSource(V):We.receiver.createCancellationTokenSource(p);p.id!==null&&Q.has(p.id)&&ne.cancel(),p.id!==null&&S.set(V,ne);try{let G;if(ce)if(p.params===void 0){if(X!==void 0&&X.numberOfParams!==0){O(new M.ResponseError(M.ErrorCodes.InvalidParams,`Request ${p.method} defines ${X.numberOfParams} params but received none.`),p.method,fe);return}G=ce(ne.token)}else if(Array.isArray(p.params)){if(X!==void 0&&X.parameterStructures===M.ParameterStructures.byName){O(new M.ResponseError(M.ErrorCodes.InvalidParams,`Request ${p.method} defines parameters by name but received parameters by position`),p.method,fe);return}G=ce(...p.params,ne.token)}else{if(X!==void 0&&X.parameterStructures===M.ParameterStructures.byPosition){O(new M.ResponseError(M.ErrorCodes.InvalidParams,`Request ${p.method} defines parameters by position but received parameters by name`),p.method,fe);return}G=ce(p.params,ne.token)}else g&&(G=g(p.method,p.params,ne.token));let ye=G;G?ye.then?ye.then(Ce=>{S.delete(V),k(Ce,p.method,fe)},Ce=>{S.delete(V),Ce instanceof M.ResponseError?O(Ce,p.method,fe):Ce&&he.string(Ce.message)?O(new M.ResponseError(M.ErrorCodes.InternalError,`Request ${p.method} failed with message: ${Ce.message}`),p.method,fe):O(new M.ResponseError(M.ErrorCodes.InternalError,`Request ${p.method} failed unexpectedly without providing any details.`),p.method,fe)}):(S.delete(V),k(G,p.method,fe)):(S.delete(V),I(G,p.method,fe))}catch(G){S.delete(V),G instanceof M.ResponseError?k(G,p.method,fe):G&&he.string(G.message)?O(new M.ResponseError(M.ErrorCodes.InternalError,`Request ${p.method} failed with message: ${G.message}`),p.method,fe):O(new M.ResponseError(M.ErrorCodes.InternalError,`Request ${p.method} failed unexpectedly without providing any details.`),p.method,fe)}}else O(new M.ResponseError(M.ErrorCodes.MethodNotFound,`Unhandled method ${p.method}`),p.method,fe)}function ko(p){if(!wt())if(p.id===null)p.error?o.error(`Received response message without id: Error is: 
${JSON.stringify(p.error,void 0,4)}`):o.error("Received response message without id. No further error information provided.");else{let k=p.id,O=Re.get(k);if(Oo(p,O),O!==void 0){Re.delete(k);try{if(p.error){let I=p.error;O.reject(new M.ResponseError(I.code,I.message,I.data))}else if(p.result!==void 0)O.resolve(p.result);else throw new Error("Should never happen.")}catch(I){I.message?o.error(`Response handler '${O.method}' failed with message: ${I.message}`):o.error(`Response handler '${O.method}' failed unexpectedly.`)}}}}function Ro(p){if(wt())return;let k,O;if(p.method===Ii.type.method){let I=p.params.id;Q.delete(I),qn(p);return}else{let I=w.get(p.method);I&&(O=I.handler,k=I.type)}if(O||_)try{if(qn(p),O)if(p.params===void 0)k!==void 0&&k.numberOfParams!==0&&k.parameterStructures!==M.ParameterStructures.byName&&o.error(`Notification ${p.method} defines ${k.numberOfParams} params but received none.`),O();else if(Array.isArray(p.params)){let I=p.params;p.method===Ei.type.method&&I.length===2&&Ma.is(I[0])?O({token:I[0],value:I[1]}):(k!==void 0&&(k.parameterStructures===M.ParameterStructures.byName&&o.error(`Notification ${p.method} defines parameters by name but received parameters by position`),k.numberOfParams!==p.params.length&&o.error(`Notification ${p.method} defines ${k.numberOfParams} params but received ${I.length} arguments`)),O(...I))}else k!==void 0&&k.parameterStructures===M.ParameterStructures.byPosition&&o.error(`Notification ${p.method} defines parameters by position but received parameters by name`),O(p.params);else _&&_(p.method,p.params)}catch(I){I.message?o.error(`Notification handler '${p.method}' failed with message: ${I.message}`):o.error(`Notification handler '${p.method}' failed unexpectedly.`)}else yn.fire(p)}function Mn(p){if(!p){o.error("Received empty message.");return}o.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(p,null,4)}`);let k=p;if(he.string(k.id)||he.number(k.id)){let O=k.id,I=Re.get(O);I&&I.reject(new Error("The received response has neither a result nor an error property."))}}function pt(p){if(p!=null)switch(T){case J.Verbose:return JSON.stringify(p,null,4);case J.Compact:return JSON.stringify(p);default:return}}function Po(p){if(!(T===J.Off||!W))if(C===Ye.Text){let k;(T===J.Verbose||T===J.Compact)&&p.params&&(k=`Params: ${pt(p.params)}

`),W.log(`Sending request '${p.method} - (${p.id})'.`,k)}else Et("send-request",p)}function Co(p){if(!(T===J.Off||!W))if(C===Ye.Text){let k;(T===J.Verbose||T===J.Compact)&&(p.params?k=`Params: ${pt(p.params)}

`:k=`No parameters provided.

`),W.log(`Sending notification '${p.method}'.`,k)}else Et("send-notification",p)}function Sn(p,k,O){if(!(T===J.Off||!W))if(C===Ye.Text){let I;(T===J.Verbose||T===J.Compact)&&(p.error&&p.error.data?I=`Error data: ${pt(p.error.data)}

`:p.result?I=`Result: ${pt(p.result)}

`:p.error===void 0&&(I=`No result returned.

`)),W.log(`Sending response '${k} - (${p.id})'. Processing request took ${Date.now()-O}ms`,I)}else Et("send-response",p)}function _o(p){if(!(T===J.Off||!W))if(C===Ye.Text){let k;(T===J.Verbose||T===J.Compact)&&p.params&&(k=`Params: ${pt(p.params)}

`),W.log(`Received request '${p.method} - (${p.id})'.`,k)}else Et("receive-request",p)}function qn(p){if(!(T===J.Off||!W||p.method===zo.type.method))if(C===Ye.Text){let k;(T===J.Verbose||T===J.Compact)&&(p.params?k=`Params: ${pt(p.params)}

`:k=`No parameters provided.

`),W.log(`Received notification '${p.method}'.`,k)}else Et("receive-notification",p)}function Oo(p,k){if(!(T===J.Off||!W))if(C===Ye.Text){let O;if((T===J.Verbose||T===J.Compact)&&(p.error&&p.error.data?O=`Error data: ${pt(p.error.data)}

`:p.result?O=`Result: ${pt(p.result)}

`:p.error===void 0&&(O=`No result returned.

`)),k){let I=p.error?` Request failed: ${p.error.message} (${p.error.code}).`:"";W.log(`Received response '${k.method} - (${p.id})' in ${Date.now()-k.timerStart}ms.${I}`,O)}else W.log(`Received response ${p.id} without active response promise.`,O)}else Et("receive-response",p)}function Et(p,k){if(!W||T===J.Off)return;let O={isLSPMessage:!0,type:p,message:k,timestamp:Date.now()};W.log(O)}function $t(){if(bn())throw new Gn(Li.Closed,"Connection is closed.");if(wt())throw new Gn(Li.Disposed,"Connection is disposed.")}function Do(){if(Ni())throw new Gn(Li.AlreadyListening,"Connection is already listening")}function wo(){if(!Ni())throw new Error("Call listen() first.")}function vt(p){return p===void 0?null:p}function Pi(p){if(p!==null)return p}function Ci(p){return p!=null&&!Array.isArray(p)&&typeof p=="object"}function jn(p,k){switch(p){case M.ParameterStructures.auto:return Ci(k)?Pi(k):[vt(k)];case M.ParameterStructures.byName:if(!Ci(k))throw new Error("Received parameters by name but param is not an object literal.");return Pi(k);case M.ParameterStructures.byPosition:return[vt(k)];default:throw new Error(`Unknown parameter structure ${p.toString()}`)}}function _i(p,k){let O,I=p.numberOfParams;switch(I){case 0:O=void 0;break;case 1:O=jn(p.parameterStructures,k[0]);break;default:O=[];for(let te=0;te<k.length&&te<I;te++)O.push(vt(k[te]));if(k.length<I)for(let te=k.length;te<I;te++)O.push(null);break}return O}let Lt={sendNotification:(p,...k)=>{$t();let O,I;if(he.string(p)){O=p;let X=k[0],ce=0,fe=M.ParameterStructures.auto;M.ParameterStructures.is(X)&&(ce=1,fe=X);let V=k.length,ne=V-ce;switch(ne){case 0:I=void 0;break;case 1:I=jn(fe,k[ce]);break;default:if(fe===M.ParameterStructures.byName)throw new Error(`Received ${ne} parameters for 'by Name' notification parameter structure.`);I=k.slice(ce,V).map(G=>vt(G));break}}else{let X=k;O=p.method,I=_i(p,X)}let te={jsonrpc:f,method:O,params:I};return Co(te),t.write(te).catch(X=>{throw o.error("Sending notification failed."),X})},onNotification:(p,k)=>{$t();let O;return he.func(p)?_=p:k&&(he.string(p)?(O=p,w.set(p,{type:void 0,handler:k})):(O=p.method,w.set(p.method,{type:p,handler:k}))),{dispose:()=>{O!==void 0?w.delete(O):_=void 0}}},onProgress:(p,k,O)=>{if(ee.has(k))throw new Error(`Progress handler for token ${k} already registered`);return ee.set(k,O),{dispose:()=>{ee.delete(k)}}},sendProgress:(p,k,O)=>Lt.sendNotification(Ei.type,{token:k,value:O}),onUnhandledProgress:Ht.event,sendRequest:(p,...k)=>{$t(),wo();let O,I,te;if(he.string(p)){O=p;let V=k[0],ne=k[k.length-1],G=0,ye=M.ParameterStructures.auto;M.ParameterStructures.is(V)&&(G=1,ye=V);let Ce=k.length;Aa.CancellationToken.is(ne)&&(Ce=Ce-1,te=ne);let Xe=Ce-G;switch(Xe){case 0:I=void 0;break;case 1:I=jn(ye,k[G]);break;default:if(ye===M.ParameterStructures.byName)throw new Error(`Received ${Xe} parameters for 'by Name' request parameter structure.`);I=k.slice(G,Ce).map(Eo=>vt(Eo));break}}else{let V=k;O=p.method,I=_i(p,V);let ne=p.numberOfParams;te=Aa.CancellationToken.is(V[ne])?V[ne]:void 0}let X=r++,ce;te&&(ce=te.onCancellationRequested(()=>{let V=We.sender.sendCancellation(Lt,X);return V===void 0?(o.log(`Received no promise from cancellation strategy when cancelling id ${X}`),Promise.resolve()):V.catch(()=>{o.log(`Sending cancellation messages for id ${X} failed`)})}));let fe={jsonrpc:f,id:X,method:O,params:I};return Po(fe),typeof We.sender.enableCancellation=="function"&&We.sender.enableCancellation(fe),new Promise(async(V,ne)=>{let G=Xe=>{V(Xe),We.sender.cleanup(X),ce?.dispose()},ye=Xe=>{ne(Xe),We.sender.cleanup(X),ce?.dispose()},Ce={method:O,timerStart:Date.now(),resolve:G,reject:ye};try{await t.write(fe),Re.set(X,Ce)}catch(Xe){throw o.error("Sending request failed."),Ce.reject(new M.ResponseError(M.ErrorCodes.MessageWriteError,Xe.message?Xe.message:"Unknown reason")),Xe}})},onRequest:(p,k)=>{$t();let O=null;return ja.is(p)?(O=void 0,g=p):he.string(p)?(O=null,k!==void 0&&(O=p,v.set(p,{handler:k,type:void 0}))):k!==void 0&&(O=p.method,v.set(p.method,{type:p,handler:k})),{dispose:()=>{O!==null&&(O!==void 0?v.delete(O):g=void 0)}}},hasPendingResponse:()=>Re.size>0,trace:async(p,k,O)=>{let I=!1,te=Ye.Text;O!==void 0&&(he.boolean(O)?I=O:(I=O.sendNotification||!1,te=O.traceFormat||Ye.Text)),T=p,C=te,T===J.Off?W=void 0:W=k,I&&!bn()&&!wt()&&await Lt.sendNotification(Ba.type,{value:J.toString(p)})},onError:ge.event,onClose:ft.event,onUnhandledNotification:yn.event,onDispose:Vt.event,end:()=>{t.end()},dispose:()=>{if(wt())return;re=gt.Disposed,Vt.fire(void 0);let p=new M.ResponseError(M.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let k of Re.values())k.reject(p);Re=new Map,S=new Map,Q=new Set,ve=new cd.LinkedMap,he.func(t.dispose)&&t.dispose(),he.func(e.dispose)&&e.dispose()},listen:()=>{$t(),Do(),re=gt.Listening,e.listen(xo)},inspect:()=>{(0,ad.default)().console.log("inspect")}};return Lt.onNotification(zo.type,p=>{if(T===J.Off||!W)return;let k=T===J.Verbose||T===J.Compact;W.log(p.message,k?p.verbose:void 0)}),Lt.onNotification(Ei.type,p=>{let k=ee.get(p.token);k?k(p.value):Ht.fire(p)}),Lt}B.createMessageConnection=Cy});var Xo=L(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.ProgressType=x.ProgressToken=x.createMessageConnection=x.NullLogger=x.ConnectionOptions=x.ConnectionStrategy=x.AbstractMessageBuffer=x.WriteableStreamMessageWriter=x.AbstractMessageWriter=x.MessageWriter=x.ReadableStreamMessageReader=x.AbstractMessageReader=x.MessageReader=x.SharedArrayReceiverStrategy=x.SharedArraySenderStrategy=x.CancellationToken=x.CancellationTokenSource=x.Emitter=x.Event=x.Disposable=x.LRUCache=x.Touch=x.LinkedMap=x.ParameterStructures=x.NotificationType9=x.NotificationType8=x.NotificationType7=x.NotificationType6=x.NotificationType5=x.NotificationType4=x.NotificationType3=x.NotificationType2=x.NotificationType1=x.NotificationType0=x.NotificationType=x.ErrorCodes=x.ResponseError=x.RequestType9=x.RequestType8=x.RequestType7=x.RequestType6=x.RequestType5=x.RequestType4=x.RequestType3=x.RequestType2=x.RequestType1=x.RequestType0=x.RequestType=x.Message=x.RAL=void 0;x.MessageStrategy=x.CancellationStrategy=x.CancellationSenderStrategy=x.CancellationReceiverStrategy=x.ConnectionError=x.ConnectionErrors=x.LogTraceNotification=x.SetTraceNotification=x.TraceFormat=x.TraceValues=x.Trace=void 0;var ae=ma();Object.defineProperty(x,"Message",{enumerable:!0,get:function(){return ae.Message}});Object.defineProperty(x,"RequestType",{enumerable:!0,get:function(){return ae.RequestType}});Object.defineProperty(x,"RequestType0",{enumerable:!0,get:function(){return ae.RequestType0}});Object.defineProperty(x,"RequestType1",{enumerable:!0,get:function(){return ae.RequestType1}});Object.defineProperty(x,"RequestType2",{enumerable:!0,get:function(){return ae.RequestType2}});Object.defineProperty(x,"RequestType3",{enumerable:!0,get:function(){return ae.RequestType3}});Object.defineProperty(x,"RequestType4",{enumerable:!0,get:function(){return ae.RequestType4}});Object.defineProperty(x,"RequestType5",{enumerable:!0,get:function(){return ae.RequestType5}});Object.defineProperty(x,"RequestType6",{enumerable:!0,get:function(){return ae.RequestType6}});Object.defineProperty(x,"RequestType7",{enumerable:!0,get:function(){return ae.RequestType7}});Object.defineProperty(x,"RequestType8",{enumerable:!0,get:function(){return ae.RequestType8}});Object.defineProperty(x,"RequestType9",{enumerable:!0,get:function(){return ae.RequestType9}});Object.defineProperty(x,"ResponseError",{enumerable:!0,get:function(){return ae.ResponseError}});Object.defineProperty(x,"ErrorCodes",{enumerable:!0,get:function(){return ae.ErrorCodes}});Object.defineProperty(x,"NotificationType",{enumerable:!0,get:function(){return ae.NotificationType}});Object.defineProperty(x,"NotificationType0",{enumerable:!0,get:function(){return ae.NotificationType0}});Object.defineProperty(x,"NotificationType1",{enumerable:!0,get:function(){return ae.NotificationType1}});Object.defineProperty(x,"NotificationType2",{enumerable:!0,get:function(){return ae.NotificationType2}});Object.defineProperty(x,"NotificationType3",{enumerable:!0,get:function(){return ae.NotificationType3}});Object.defineProperty(x,"NotificationType4",{enumerable:!0,get:function(){return ae.NotificationType4}});Object.defineProperty(x,"NotificationType5",{enumerable:!0,get:function(){return ae.NotificationType5}});Object.defineProperty(x,"NotificationType6",{enumerable:!0,get:function(){return ae.NotificationType6}});Object.defineProperty(x,"NotificationType7",{enumerable:!0,get:function(){return ae.NotificationType7}});Object.defineProperty(x,"NotificationType8",{enumerable:!0,get:function(){return ae.NotificationType8}});Object.defineProperty(x,"NotificationType9",{enumerable:!0,get:function(){return ae.NotificationType9}});Object.defineProperty(x,"ParameterStructures",{enumerable:!0,get:function(){return ae.ParameterStructures}});var Va=ga();Object.defineProperty(x,"LinkedMap",{enumerable:!0,get:function(){return Va.LinkedMap}});Object.defineProperty(x,"LRUCache",{enumerable:!0,get:function(){return Va.LRUCache}});Object.defineProperty(x,"Touch",{enumerable:!0,get:function(){return Va.Touch}});var _y=Ju();Object.defineProperty(x,"Disposable",{enumerable:!0,get:function(){return _y.Disposable}});var fd=Vn();Object.defineProperty(x,"Event",{enumerable:!0,get:function(){return fd.Event}});Object.defineProperty(x,"Emitter",{enumerable:!0,get:function(){return fd.Emitter}});var pd=Bo();Object.defineProperty(x,"CancellationTokenSource",{enumerable:!0,get:function(){return pd.CancellationTokenSource}});Object.defineProperty(x,"CancellationToken",{enumerable:!0,get:function(){return pd.CancellationToken}});var md=Yu();Object.defineProperty(x,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return md.SharedArraySenderStrategy}});Object.defineProperty(x,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return md.SharedArrayReceiverStrategy}});var $a=ed();Object.defineProperty(x,"MessageReader",{enumerable:!0,get:function(){return $a.MessageReader}});Object.defineProperty(x,"AbstractMessageReader",{enumerable:!0,get:function(){return $a.AbstractMessageReader}});Object.defineProperty(x,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return $a.ReadableStreamMessageReader}});var za=rd();Object.defineProperty(x,"MessageWriter",{enumerable:!0,get:function(){return za.MessageWriter}});Object.defineProperty(x,"AbstractMessageWriter",{enumerable:!0,get:function(){return za.AbstractMessageWriter}});Object.defineProperty(x,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return za.WriteableStreamMessageWriter}});var Oy=sd();Object.defineProperty(x,"AbstractMessageBuffer",{enumerable:!0,get:function(){return Oy.AbstractMessageBuffer}});var we=ld();Object.defineProperty(x,"ConnectionStrategy",{enumerable:!0,get:function(){return we.ConnectionStrategy}});Object.defineProperty(x,"ConnectionOptions",{enumerable:!0,get:function(){return we.ConnectionOptions}});Object.defineProperty(x,"NullLogger",{enumerable:!0,get:function(){return we.NullLogger}});Object.defineProperty(x,"createMessageConnection",{enumerable:!0,get:function(){return we.createMessageConnection}});Object.defineProperty(x,"ProgressToken",{enumerable:!0,get:function(){return we.ProgressToken}});Object.defineProperty(x,"ProgressType",{enumerable:!0,get:function(){return we.ProgressType}});Object.defineProperty(x,"Trace",{enumerable:!0,get:function(){return we.Trace}});Object.defineProperty(x,"TraceValues",{enumerable:!0,get:function(){return we.TraceValues}});Object.defineProperty(x,"TraceFormat",{enumerable:!0,get:function(){return we.TraceFormat}});Object.defineProperty(x,"SetTraceNotification",{enumerable:!0,get:function(){return we.SetTraceNotification}});Object.defineProperty(x,"LogTraceNotification",{enumerable:!0,get:function(){return we.LogTraceNotification}});Object.defineProperty(x,"ConnectionErrors",{enumerable:!0,get:function(){return we.ConnectionErrors}});Object.defineProperty(x,"ConnectionError",{enumerable:!0,get:function(){return we.ConnectionError}});Object.defineProperty(x,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return we.CancellationReceiverStrategy}});Object.defineProperty(x,"CancellationSenderStrategy",{enumerable:!0,get:function(){return we.CancellationSenderStrategy}});Object.defineProperty(x,"CancellationStrategy",{enumerable:!0,get:function(){return we.CancellationStrategy}});Object.defineProperty(x,"MessageStrategy",{enumerable:!0,get:function(){return we.MessageStrategy}});var Dy=Ut();x.RAL=Dy.default});var yd=L(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});var hd=require("util"),Ft=Xo(),Yo=class e extends Ft.AbstractMessageBuffer{constructor(t="utf-8"){super(t)}emptyBuffer(){return e.emptyBuffer}fromString(t,n){return Buffer.from(t,n)}toString(t,n){return t instanceof Buffer?t.toString(n):new hd.TextDecoder(n).decode(t)}asNative(t,n){return n===void 0?t instanceof Buffer?t:Buffer.from(t):t instanceof Buffer?t.slice(0,n):Buffer.from(t,0,n)}allocNative(t){return Buffer.allocUnsafe(t)}};Yo.emptyBuffer=Buffer.allocUnsafe(0);var Ua=class{constructor(t){this.stream=t}onClose(t){return this.stream.on("close",t),Ft.Disposable.create(()=>this.stream.off("close",t))}onError(t){return this.stream.on("error",t),Ft.Disposable.create(()=>this.stream.off("error",t))}onEnd(t){return this.stream.on("end",t),Ft.Disposable.create(()=>this.stream.off("end",t))}onData(t){return this.stream.on("data",t),Ft.Disposable.create(()=>this.stream.off("data",t))}},Ga=class{constructor(t){this.stream=t}onClose(t){return this.stream.on("close",t),Ft.Disposable.create(()=>this.stream.off("close",t))}onError(t){return this.stream.on("error",t),Ft.Disposable.create(()=>this.stream.off("error",t))}onEnd(t){return this.stream.on("end",t),Ft.Disposable.create(()=>this.stream.off("end",t))}write(t,n){return new Promise((i,o)=>{let r=s=>{s==null?i():o(s)};typeof t=="string"?this.stream.write(t,n,r):this.stream.write(t,r)})}end(){this.stream.end()}},gd=Object.freeze({messageBuffer:Object.freeze({create:e=>new Yo(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(n){return Promise.reject(n)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new hd.TextDecoder(t.charset).decode(e)))}catch(n){return Promise.reject(n)}}})}),stream:Object.freeze({asReadableStream:e=>new Ua(e),asWritableStream:e=>new Ga(e)}),console,timer:Object.freeze({setTimeout(e,t,...n){let i=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(e,...t){let n=setImmediate(e,...t);return{dispose:()=>clearImmediate(n)}},setInterval(e,t,...n){let i=setInterval(e,t,...n);return{dispose:()=>clearInterval(i)}}})});function Ka(){return gd}(function(e){function t(){Ft.RAL.install(gd)}e.install=t})(Ka||(Ka={}));Qa.default=Ka});var kn=L(z=>{"use strict";var wy=z&&z.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Ey=z&&z.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&wy(t,e,n)};Object.defineProperty(z,"__esModule",{value:!0});z.createMessageConnection=z.createServerSocketTransport=z.createClientSocketTransport=z.createServerPipeTransport=z.createClientPipeTransport=z.generateRandomPipeName=z.StreamMessageWriter=z.StreamMessageReader=z.SocketMessageWriter=z.SocketMessageReader=z.PortMessageWriter=z.PortMessageReader=z.IPCMessageWriter=z.IPCMessageReader=void 0;var Kn=yd();Kn.default.install();var bd=require("path"),Ly=require("os"),Iy=require("crypto"),tr=require("net"),Ze=Xo();Ey(Xo(),z);var Ja=class extends Ze.AbstractMessageReader{constructor(t){super(),this.process=t;let n=this.process;n.on("error",i=>this.fireError(i)),n.on("close",()=>this.fireClose())}listen(t){return this.process.on("message",t),Ze.Disposable.create(()=>this.process.off("message",t))}};z.IPCMessageReader=Ja;var Xa=class extends Ze.AbstractMessageWriter{constructor(t){super(),this.process=t,this.errorCount=0;let n=this.process;n.on("error",i=>this.fireError(i)),n.on("close",()=>this.fireClose)}write(t){try{return typeof this.process.send=="function"&&this.process.send(t,void 0,void 0,n=>{n?(this.errorCount++,this.handleError(n,t)):this.errorCount=0}),Promise.resolve()}catch(n){return this.handleError(n,t),Promise.reject(n)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){}};z.IPCMessageWriter=Xa;var Ya=class extends Ze.AbstractMessageReader{constructor(t){super(),this.onData=new Ze.Emitter,t.on("close",()=>this.fireClose),t.on("error",n=>this.fireError(n)),t.on("message",n=>{this.onData.fire(n)})}listen(t){return this.onData.event(t)}};z.PortMessageReader=Ya;var Za=class extends Ze.AbstractMessageWriter{constructor(t){super(),this.port=t,this.errorCount=0,t.on("close",()=>this.fireClose()),t.on("error",n=>this.fireError(n))}write(t){try{return this.port.postMessage(t),Promise.resolve()}catch(n){return this.handleError(n,t),Promise.reject(n)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){}};z.PortMessageWriter=Za;var xn=class extends Ze.ReadableStreamMessageReader{constructor(t,n="utf-8"){super((0,Kn.default)().stream.asReadableStream(t),n)}};z.SocketMessageReader=xn;var Nn=class extends Ze.WriteableStreamMessageWriter{constructor(t,n){super((0,Kn.default)().stream.asWritableStream(t),n),this.socket=t}dispose(){super.dispose(),this.socket.destroy()}};z.SocketMessageWriter=Nn;var Zo=class extends Ze.ReadableStreamMessageReader{constructor(t,n){super((0,Kn.default)().stream.asReadableStream(t),n)}};z.StreamMessageReader=Zo;var er=class extends Ze.WriteableStreamMessageWriter{constructor(t,n){super((0,Kn.default)().stream.asWritableStream(t),n)}};z.StreamMessageWriter=er;var Td=process.env.XDG_RUNTIME_DIR,Fy=new Map([["linux",107],["darwin",103]]);function Ay(){let e=(0,Iy.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;Td?t=bd.join(Td,`vscode-ipc-${e}.sock`):t=bd.join(Ly.tmpdir(),`vscode-${e}.sock`);let n=Fy.get(process.platform);return n!==void 0&&t.length>n&&(0,Kn.default)().console.warn(`WARNING: IPC handle "${t}" is longer than ${n} characters.`),t}z.generateRandomPipeName=Ay;function My(e,t="utf-8"){let n,i=new Promise((o,r)=>{n=o});return new Promise((o,r)=>{let s=(0,tr.createServer)(u=>{s.close(),n([new xn(u,t),new Nn(u,t)])});s.on("error",r),s.listen(e,()=>{s.removeListener("error",r),o({onConnected:()=>i})})})}z.createClientPipeTransport=My;function qy(e,t="utf-8"){let n=(0,tr.createConnection)(e);return[new xn(n,t),new Nn(n,t)]}z.createServerPipeTransport=qy;function jy(e,t="utf-8"){let n,i=new Promise((o,r)=>{n=o});return new Promise((o,r)=>{let s=(0,tr.createServer)(u=>{s.close(),n([new xn(u,t),new Nn(u,t)])});s.on("error",r),s.listen(e,"127.0.0.1",()=>{s.removeListener("error",r),o({onConnected:()=>i})})})}z.createClientSocketTransport=jy;function By(e,t="utf-8"){let n=(0,tr.createConnection)(e,"127.0.0.1");return[new xn(n,t),new Nn(n,t)]}z.createServerSocketTransport=By;function Wy(e){let t=e;return t.read!==void 0&&t.addListener!==void 0}function Hy(e){let t=e;return t.write!==void 0&&t.addListener!==void 0}function Vy(e,t,n,i){n||(n=Ze.NullLogger);let o=Wy(e)?new Zo(e):e,r=Hy(t)?new er(t):t;return Ze.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,Ze.createMessageConnection)(o,r,n,i)}z.createMessageConnection=Vy});var ec=L((pk,Sd)=>{"use strict";Sd.exports=kn()});var ir=L((vd,nr)=>{(function(e){if(typeof nr=="object"&&typeof nr.exports=="object"){var t=e(require,vd);t!==void 0&&(nr.exports=t)}else typeof define=="function"&&define.amd&&define(["require","exports"],e)})(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=t.EOL=t.WorkspaceFolder=t.InlineCompletionContext=t.SelectedCompletionInfo=t.InlineCompletionTriggerKind=t.InlineCompletionList=t.InlineCompletionItem=t.StringValue=t.InlayHint=t.InlayHintLabelPart=t.InlayHintKind=t.InlineValueContext=t.InlineValueEvaluatableExpression=t.InlineValueVariableLookup=t.InlineValueText=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.SelectionRange=t.DocumentLink=t.FormattingOptions=t.CodeLens=t.CodeAction=t.CodeActionContext=t.CodeActionTriggerKind=t.CodeActionKind=t.DocumentSymbol=t.WorkspaceSymbol=t.SymbolInformation=t.SymbolTag=t.SymbolKind=t.DocumentHighlight=t.DocumentHighlightKind=t.SignatureInformation=t.ParameterInformation=t.Hover=t.MarkedString=t.CompletionList=t.CompletionItem=t.CompletionItemLabelDetails=t.InsertTextMode=t.InsertReplaceEdit=t.CompletionItemTag=t.InsertTextFormat=t.CompletionItemKind=t.MarkupContent=t.MarkupKind=t.TextDocumentItem=t.OptionalVersionedTextDocumentIdentifier=t.VersionedTextDocumentIdentifier=t.TextDocumentIdentifier=t.WorkspaceChange=t.WorkspaceEdit=t.DeleteFile=t.RenameFile=t.CreateFile=t.TextDocumentEdit=t.AnnotatedTextEdit=t.ChangeAnnotationIdentifier=t.ChangeAnnotation=t.TextEdit=t.Command=t.Diagnostic=t.CodeDescription=t.DiagnosticTag=t.DiagnosticSeverity=t.DiagnosticRelatedInformation=t.FoldingRange=t.FoldingRangeKind=t.ColorPresentation=t.ColorInformation=t.Color=t.LocationLink=t.Location=t.Range=t.Position=t.uinteger=t.integer=t.URI=t.DocumentUri=void 0;var n;(function(c){function m(h){return typeof h=="string"}c.is=m})(n||(t.DocumentUri=n={}));var i;(function(c){function m(h){return typeof h=="string"}c.is=m})(i||(t.URI=i={}));var o;(function(c){c.MIN_VALUE=-2147483648,c.MAX_VALUE=2147483647;function m(h){return typeof h=="number"&&c.MIN_VALUE<=h&&h<=c.MAX_VALUE}c.is=m})(o||(t.integer=o={}));var r;(function(c){c.MIN_VALUE=0,c.MAX_VALUE=2147483647;function m(h){return typeof h=="number"&&c.MIN_VALUE<=h&&h<=c.MAX_VALUE}c.is=m})(r||(t.uinteger=r={}));var s;(function(c){function m(d,a){return d===Number.MAX_VALUE&&(d=r.MAX_VALUE),a===Number.MAX_VALUE&&(a=r.MAX_VALUE),{line:d,character:a}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&b.uinteger(a.line)&&b.uinteger(a.character)}c.is=h})(s||(t.Position=s={}));var u;(function(c){function m(d,a,y,R){if(b.uinteger(d)&&b.uinteger(a)&&b.uinteger(y)&&b.uinteger(R))return{start:s.create(d,a),end:s.create(y,R)};if(s.is(d)&&s.is(a))return{start:d,end:a};throw new Error("Range#create called with invalid arguments[".concat(d,", ").concat(a,", ").concat(y,", ").concat(R,"]"))}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&s.is(a.start)&&s.is(a.end)}c.is=h})(u||(t.Range=u={}));var f;(function(c){function m(d,a){return{uri:d,range:a}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&u.is(a.range)&&(b.string(a.uri)||b.undefined(a.uri))}c.is=h})(f||(t.Location=f={}));var g;(function(c){function m(d,a,y,R){return{targetUri:d,targetRange:a,targetSelectionRange:y,originSelectionRange:R}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&u.is(a.targetRange)&&b.string(a.targetUri)&&u.is(a.targetSelectionRange)&&(u.is(a.originSelectionRange)||b.undefined(a.originSelectionRange))}c.is=h})(g||(t.LocationLink=g={}));var v;(function(c){function m(d,a,y,R){return{red:d,green:a,blue:y,alpha:R}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&b.numberRange(a.red,0,1)&&b.numberRange(a.green,0,1)&&b.numberRange(a.blue,0,1)&&b.numberRange(a.alpha,0,1)}c.is=h})(v||(t.Color=v={}));var _;(function(c){function m(d,a){return{range:d,color:a}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&u.is(a.range)&&v.is(a.color)}c.is=h})(_||(t.ColorInformation=_={}));var w;(function(c){function m(d,a,y){return{label:d,textEdit:a,additionalTextEdits:y}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&b.string(a.label)&&(b.undefined(a.textEdit)||W.is(a))&&(b.undefined(a.additionalTextEdits)||b.typedArray(a.additionalTextEdits,W.is))}c.is=h})(w||(t.ColorPresentation=w={}));var ee;(function(c){c.Comment="comment",c.Imports="imports",c.Region="region"})(ee||(t.FoldingRangeKind=ee={}));var De;(function(c){function m(d,a,y,R,j,be){var se={startLine:d,endLine:a};return b.defined(y)&&(se.startCharacter=y),b.defined(R)&&(se.endCharacter=R),b.defined(j)&&(se.kind=j),b.defined(be)&&(se.collapsedText=be),se}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&b.uinteger(a.startLine)&&b.uinteger(a.startLine)&&(b.undefined(a.startCharacter)||b.uinteger(a.startCharacter))&&(b.undefined(a.endCharacter)||b.uinteger(a.endCharacter))&&(b.undefined(a.kind)||b.string(a.kind))}c.is=h})(De||(t.FoldingRange=De={}));var ve;(function(c){function m(d,a){return{location:d,message:a}}c.create=m;function h(d){var a=d;return b.defined(a)&&f.is(a.location)&&b.string(a.message)}c.is=h})(ve||(t.DiagnosticRelatedInformation=ve={}));var Re;(function(c){c.Error=1,c.Warning=2,c.Information=3,c.Hint=4})(Re||(t.DiagnosticSeverity=Re={}));var Q;(function(c){c.Unnecessary=1,c.Deprecated=2})(Q||(t.DiagnosticTag=Q={}));var S;(function(c){function m(h){var d=h;return b.objectLiteral(d)&&b.string(d.href)}c.is=m})(S||(t.CodeDescription=S={}));var T;(function(c){function m(d,a,y,R,j,be){var se={range:d,message:a};return b.defined(y)&&(se.severity=y),b.defined(R)&&(se.code=R),b.defined(j)&&(se.source=j),b.defined(be)&&(se.relatedInformation=be),se}c.create=m;function h(d){var a,y=d;return b.defined(y)&&u.is(y.range)&&b.string(y.message)&&(b.number(y.severity)||b.undefined(y.severity))&&(b.integer(y.code)||b.string(y.code)||b.undefined(y.code))&&(b.undefined(y.codeDescription)||b.string((a=y.codeDescription)===null||a===void 0?void 0:a.href))&&(b.string(y.source)||b.undefined(y.source))&&(b.undefined(y.relatedInformation)||b.typedArray(y.relatedInformation,ve.is))}c.is=h})(T||(t.Diagnostic=T={}));var C;(function(c){function m(d,a){for(var y=[],R=2;R<arguments.length;R++)y[R-2]=arguments[R];var j={title:d,command:a};return b.defined(y)&&y.length>0&&(j.arguments=y),j}c.create=m;function h(d){var a=d;return b.defined(a)&&b.string(a.title)&&b.string(a.command)}c.is=h})(C||(t.Command=C={}));var W;(function(c){function m(y,R){return{range:y,newText:R}}c.replace=m;function h(y,R){return{range:{start:y,end:y},newText:R}}c.insert=h;function d(y){return{range:y,newText:""}}c.del=d;function a(y){var R=y;return b.objectLiteral(R)&&b.string(R.newText)&&u.is(R.range)}c.is=a})(W||(t.TextEdit=W={}));var re;(function(c){function m(d,a,y){var R={label:d};return a!==void 0&&(R.needsConfirmation=a),y!==void 0&&(R.description=y),R}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&b.string(a.label)&&(b.boolean(a.needsConfirmation)||a.needsConfirmation===void 0)&&(b.string(a.description)||a.description===void 0)}c.is=h})(re||(t.ChangeAnnotation=re={}));var ge;(function(c){function m(h){var d=h;return b.string(d)}c.is=m})(ge||(t.ChangeAnnotationIdentifier=ge={}));var ft;(function(c){function m(y,R,j){return{range:y,newText:R,annotationId:j}}c.replace=m;function h(y,R,j){return{range:{start:y,end:y},newText:R,annotationId:j}}c.insert=h;function d(y,R){return{range:y,newText:"",annotationId:R}}c.del=d;function a(y){var R=y;return W.is(R)&&(re.is(R.annotationId)||ge.is(R.annotationId))}c.is=a})(ft||(t.AnnotatedTextEdit=ft={}));var yn;(function(c){function m(d,a){return{textDocument:d,edits:a}}c.create=m;function h(d){var a=d;return b.defined(a)&&bn.is(a.textDocument)&&Array.isArray(a.edits)}c.is=h})(yn||(t.TextDocumentEdit=yn={}));var Ht;(function(c){function m(d,a,y){var R={kind:"create",uri:d};return a!==void 0&&(a.overwrite!==void 0||a.ignoreIfExists!==void 0)&&(R.options=a),y!==void 0&&(R.annotationId=y),R}c.create=m;function h(d){var a=d;return a&&a.kind==="create"&&b.string(a.uri)&&(a.options===void 0||(a.options.overwrite===void 0||b.boolean(a.options.overwrite))&&(a.options.ignoreIfExists===void 0||b.boolean(a.options.ignoreIfExists)))&&(a.annotationId===void 0||ge.is(a.annotationId))}c.is=h})(Ht||(t.CreateFile=Ht={}));var Vt;(function(c){function m(d,a,y,R){var j={kind:"rename",oldUri:d,newUri:a};return y!==void 0&&(y.overwrite!==void 0||y.ignoreIfExists!==void 0)&&(j.options=y),R!==void 0&&(j.annotationId=R),j}c.create=m;function h(d){var a=d;return a&&a.kind==="rename"&&b.string(a.oldUri)&&b.string(a.newUri)&&(a.options===void 0||(a.options.overwrite===void 0||b.boolean(a.options.overwrite))&&(a.options.ignoreIfExists===void 0||b.boolean(a.options.ignoreIfExists)))&&(a.annotationId===void 0||ge.is(a.annotationId))}c.is=h})(Vt||(t.RenameFile=Vt={}));var We;(function(c){function m(d,a,y){var R={kind:"delete",uri:d};return a!==void 0&&(a.recursive!==void 0||a.ignoreIfNotExists!==void 0)&&(R.options=a),y!==void 0&&(R.annotationId=y),R}c.create=m;function h(d){var a=d;return a&&a.kind==="delete"&&b.string(a.uri)&&(a.options===void 0||(a.options.recursive===void 0||b.boolean(a.options.recursive))&&(a.options.ignoreIfNotExists===void 0||b.boolean(a.options.ignoreIfNotExists)))&&(a.annotationId===void 0||ge.is(a.annotationId))}c.is=h})(We||(t.DeleteFile=We={}));var In;(function(c){function m(h){var d=h;return d&&(d.changes!==void 0||d.documentChanges!==void 0)&&(d.documentChanges===void 0||d.documentChanges.every(function(a){return b.string(a.kind)?Ht.is(a)||Vt.is(a)||We.is(a):yn.is(a)}))}c.is=m})(In||(t.WorkspaceEdit=In={}));var Fn=function(){function c(m,h){this.edits=m,this.changeAnnotations=h}return c.prototype.insert=function(m,h,d){var a,y;if(d===void 0?a=W.insert(m,h):ge.is(d)?(y=d,a=ft.insert(m,h,d)):(this.assertChangeAnnotations(this.changeAnnotations),y=this.changeAnnotations.manage(d),a=ft.insert(m,h,y)),this.edits.push(a),y!==void 0)return y},c.prototype.replace=function(m,h,d){var a,y;if(d===void 0?a=W.replace(m,h):ge.is(d)?(y=d,a=ft.replace(m,h,d)):(this.assertChangeAnnotations(this.changeAnnotations),y=this.changeAnnotations.manage(d),a=ft.replace(m,h,y)),this.edits.push(a),y!==void 0)return y},c.prototype.delete=function(m,h){var d,a;if(h===void 0?d=W.del(m):ge.is(h)?(a=h,d=ft.del(m,h)):(this.assertChangeAnnotations(this.changeAnnotations),a=this.changeAnnotations.manage(h),d=ft.del(m,a)),this.edits.push(d),a!==void 0)return a},c.prototype.add=function(m){this.edits.push(m)},c.prototype.all=function(){return this.edits},c.prototype.clear=function(){this.edits.splice(0,this.edits.length)},c.prototype.assertChangeAnnotations=function(m){if(m===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},c}(),bo=function(){function c(m){this._annotations=m===void 0?Object.create(null):m,this._counter=0,this._size=0}return c.prototype.all=function(){return this._annotations},Object.defineProperty(c.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),c.prototype.manage=function(m,h){var d;if(ge.is(m)?d=m:(d=this.nextId(),h=m),this._annotations[d]!==void 0)throw new Error("Id ".concat(d," is already in use."));if(h===void 0)throw new Error("No annotation provided for id ".concat(d));return this._annotations[d]=h,this._size++,d},c.prototype.nextId=function(){return this._counter++,this._counter.toString()},c}(),Vs=function(){function c(m){var h=this;this._textEditChanges=Object.create(null),m!==void 0?(this._workspaceEdit=m,m.documentChanges?(this._changeAnnotations=new bo(m.changeAnnotations),m.changeAnnotations=this._changeAnnotations.all(),m.documentChanges.forEach(function(d){if(yn.is(d)){var a=new Fn(d.edits,h._changeAnnotations);h._textEditChanges[d.textDocument.uri]=a}})):m.changes&&Object.keys(m.changes).forEach(function(d){var a=new Fn(m.changes[d]);h._textEditChanges[d]=a})):this._workspaceEdit={}}return Object.defineProperty(c.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),c.prototype.getTextEditChange=function(m){if(bn.is(m)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var h={uri:m.uri,version:m.version},d=this._textEditChanges[h.uri];if(!d){var a=[],y={textDocument:h,edits:a};this._workspaceEdit.documentChanges.push(y),d=new Fn(a,this._changeAnnotations),this._textEditChanges[h.uri]=d}return d}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var d=this._textEditChanges[m];if(!d){var a=[];this._workspaceEdit.changes[m]=a,d=new Fn(a),this._textEditChanges[m]=d}return d}},c.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new bo,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},c.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},c.prototype.createFile=function(m,h,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var a;re.is(h)||ge.is(h)?a=h:d=h;var y,R;if(a===void 0?y=Ht.create(m,d):(R=ge.is(a)?a:this._changeAnnotations.manage(a),y=Ht.create(m,d,R)),this._workspaceEdit.documentChanges.push(y),R!==void 0)return R},c.prototype.renameFile=function(m,h,d,a){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var y;re.is(d)||ge.is(d)?y=d:a=d;var R,j;if(y===void 0?R=Vt.create(m,h,a):(j=ge.is(y)?y:this._changeAnnotations.manage(y),R=Vt.create(m,h,a,j)),this._workspaceEdit.documentChanges.push(R),j!==void 0)return j},c.prototype.deleteFile=function(m,h,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var a;re.is(h)||ge.is(h)?a=h:d=h;var y,R;if(a===void 0?y=We.create(m,d):(R=ge.is(a)?a:this._changeAnnotations.manage(a),y=We.create(m,d,R)),this._workspaceEdit.documentChanges.push(y),R!==void 0)return R},c}();t.WorkspaceChange=Vs;var To;(function(c){function m(d){return{uri:d}}c.create=m;function h(d){var a=d;return b.defined(a)&&b.string(a.uri)}c.is=h})(To||(t.TextDocumentIdentifier=To={}));var Ni;(function(c){function m(d,a){return{uri:d,version:a}}c.create=m;function h(d){var a=d;return b.defined(a)&&b.string(a.uri)&&b.integer(a.version)}c.is=h})(Ni||(t.VersionedTextDocumentIdentifier=Ni={}));var bn;(function(c){function m(d,a){return{uri:d,version:a}}c.create=m;function h(d){var a=d;return b.defined(a)&&b.string(a.uri)&&(a.version===null||b.integer(a.version))}c.is=h})(bn||(t.OptionalVersionedTextDocumentIdentifier=bn={}));var wt;(function(c){function m(d,a,y,R){return{uri:d,languageId:a,version:y,text:R}}c.create=m;function h(d){var a=d;return b.defined(a)&&b.string(a.uri)&&b.string(a.languageId)&&b.integer(a.version)&&b.string(a.text)}c.is=h})(wt||(t.TextDocumentItem=wt={}));var An;(function(c){c.PlainText="plaintext",c.Markdown="markdown";function m(h){var d=h;return d===c.PlainText||d===c.Markdown}c.is=m})(An||(t.MarkupKind=An={}));var Tn;(function(c){function m(h){var d=h;return b.objectLiteral(h)&&An.is(d.kind)&&b.string(d.value)}c.is=m})(Tn||(t.MarkupContent=Tn={}));var So;(function(c){c.Text=1,c.Method=2,c.Function=3,c.Constructor=4,c.Field=5,c.Variable=6,c.Class=7,c.Interface=8,c.Module=9,c.Property=10,c.Unit=11,c.Value=12,c.Enum=13,c.Keyword=14,c.Snippet=15,c.Color=16,c.File=17,c.Reference=18,c.Folder=19,c.EnumMember=20,c.Constant=21,c.Struct=22,c.Event=23,c.Operator=24,c.TypeParameter=25})(So||(t.CompletionItemKind=So={}));var ki;(function(c){c.PlainText=1,c.Snippet=2})(ki||(t.InsertTextFormat=ki={}));var Ri;(function(c){c.Deprecated=1})(Ri||(t.CompletionItemTag=Ri={}));var vo;(function(c){function m(d,a,y){return{newText:d,insert:a,replace:y}}c.create=m;function h(d){var a=d;return a&&b.string(a.newText)&&u.is(a.insert)&&u.is(a.replace)}c.is=h})(vo||(t.InsertReplaceEdit=vo={}));var xo;(function(c){c.asIs=1,c.adjustIndentation=2})(xo||(t.InsertTextMode=xo={}));var No;(function(c){function m(h){var d=h;return d&&(b.string(d.detail)||d.detail===void 0)&&(b.string(d.description)||d.description===void 0)}c.is=m})(No||(t.CompletionItemLabelDetails=No={}));var ko;(function(c){function m(h){return{label:h}}c.create=m})(ko||(t.CompletionItem=ko={}));var Ro;(function(c){function m(h,d){return{items:h||[],isIncomplete:!!d}}c.create=m})(Ro||(t.CompletionList=Ro={}));var Mn;(function(c){function m(d){return d.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}c.fromPlainText=m;function h(d){var a=d;return b.string(a)||b.objectLiteral(a)&&b.string(a.language)&&b.string(a.value)}c.is=h})(Mn||(t.MarkedString=Mn={}));var pt;(function(c){function m(h){var d=h;return!!d&&b.objectLiteral(d)&&(Tn.is(d.contents)||Mn.is(d.contents)||b.typedArray(d.contents,Mn.is))&&(h.range===void 0||u.is(h.range))}c.is=m})(pt||(t.Hover=pt={}));var Po;(function(c){function m(h,d){return d?{label:h,documentation:d}:{label:h}}c.create=m})(Po||(t.ParameterInformation=Po={}));var Co;(function(c){function m(h,d){for(var a=[],y=2;y<arguments.length;y++)a[y-2]=arguments[y];var R={label:h};return b.defined(d)&&(R.documentation=d),b.defined(a)?R.parameters=a:R.parameters=[],R}c.create=m})(Co||(t.SignatureInformation=Co={}));var Sn;(function(c){c.Text=1,c.Read=2,c.Write=3})(Sn||(t.DocumentHighlightKind=Sn={}));var _o;(function(c){function m(h,d){var a={range:h};return b.number(d)&&(a.kind=d),a}c.create=m})(_o||(t.DocumentHighlight=_o={}));var qn;(function(c){c.File=1,c.Module=2,c.Namespace=3,c.Package=4,c.Class=5,c.Method=6,c.Property=7,c.Field=8,c.Constructor=9,c.Enum=10,c.Interface=11,c.Function=12,c.Variable=13,c.Constant=14,c.String=15,c.Number=16,c.Boolean=17,c.Array=18,c.Object=19,c.Key=20,c.Null=21,c.EnumMember=22,c.Struct=23,c.Event=24,c.Operator=25,c.TypeParameter=26})(qn||(t.SymbolKind=qn={}));var Oo;(function(c){c.Deprecated=1})(Oo||(t.SymbolTag=Oo={}));var Et;(function(c){function m(h,d,a,y,R){var j={name:h,kind:d,location:{uri:y,range:a}};return R&&(j.containerName=R),j}c.create=m})(Et||(t.SymbolInformation=Et={}));var $t;(function(c){function m(h,d,a,y){return y!==void 0?{name:h,kind:d,location:{uri:a,range:y}}:{name:h,kind:d,location:{uri:a}}}c.create=m})($t||(t.WorkspaceSymbol=$t={}));var Do;(function(c){function m(d,a,y,R,j,be){var se={name:d,detail:a,kind:y,range:R,selectionRange:j};return be!==void 0&&(se.children=be),se}c.create=m;function h(d){var a=d;return a&&b.string(a.name)&&b.number(a.kind)&&u.is(a.range)&&u.is(a.selectionRange)&&(a.detail===void 0||b.string(a.detail))&&(a.deprecated===void 0||b.boolean(a.deprecated))&&(a.children===void 0||Array.isArray(a.children))&&(a.tags===void 0||Array.isArray(a.tags))}c.is=h})(Do||(t.DocumentSymbol=Do={}));var wo;(function(c){c.Empty="",c.QuickFix="quickfix",c.Refactor="refactor",c.RefactorExtract="refactor.extract",c.RefactorInline="refactor.inline",c.RefactorRewrite="refactor.rewrite",c.Source="source",c.SourceOrganizeImports="source.organizeImports",c.SourceFixAll="source.fixAll"})(wo||(t.CodeActionKind=wo={}));var vt;(function(c){c.Invoked=1,c.Automatic=2})(vt||(t.CodeActionTriggerKind=vt={}));var Pi;(function(c){function m(d,a,y){var R={diagnostics:d};return a!=null&&(R.only=a),y!=null&&(R.triggerKind=y),R}c.create=m;function h(d){var a=d;return b.defined(a)&&b.typedArray(a.diagnostics,T.is)&&(a.only===void 0||b.typedArray(a.only,b.string))&&(a.triggerKind===void 0||a.triggerKind===vt.Invoked||a.triggerKind===vt.Automatic)}c.is=h})(Pi||(t.CodeActionContext=Pi={}));var Ci;(function(c){function m(d,a,y){var R={title:d},j=!0;return typeof a=="string"?(j=!1,R.kind=a):C.is(a)?R.command=a:R.edit=a,j&&y!==void 0&&(R.kind=y),R}c.create=m;function h(d){var a=d;return a&&b.string(a.title)&&(a.diagnostics===void 0||b.typedArray(a.diagnostics,T.is))&&(a.kind===void 0||b.string(a.kind))&&(a.edit!==void 0||a.command!==void 0)&&(a.command===void 0||C.is(a.command))&&(a.isPreferred===void 0||b.boolean(a.isPreferred))&&(a.edit===void 0||In.is(a.edit))}c.is=h})(Ci||(t.CodeAction=Ci={}));var jn;(function(c){function m(d,a){var y={range:d};return b.defined(a)&&(y.data=a),y}c.create=m;function h(d){var a=d;return b.defined(a)&&u.is(a.range)&&(b.undefined(a.command)||C.is(a.command))}c.is=h})(jn||(t.CodeLens=jn={}));var _i;(function(c){function m(d,a){return{tabSize:d,insertSpaces:a}}c.create=m;function h(d){var a=d;return b.defined(a)&&b.uinteger(a.tabSize)&&b.boolean(a.insertSpaces)}c.is=h})(_i||(t.FormattingOptions=_i={}));var Lt;(function(c){function m(d,a,y){return{range:d,target:a,data:y}}c.create=m;function h(d){var a=d;return b.defined(a)&&u.is(a.range)&&(b.undefined(a.target)||b.string(a.target))}c.is=h})(Lt||(t.DocumentLink=Lt={}));var p;(function(c){function m(d,a){return{range:d,parent:a}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&u.is(a.range)&&(a.parent===void 0||c.is(a.parent))}c.is=h})(p||(t.SelectionRange=p={}));var k;(function(c){c.namespace="namespace",c.type="type",c.class="class",c.enum="enum",c.interface="interface",c.struct="struct",c.typeParameter="typeParameter",c.parameter="parameter",c.variable="variable",c.property="property",c.enumMember="enumMember",c.event="event",c.function="function",c.method="method",c.macro="macro",c.keyword="keyword",c.modifier="modifier",c.comment="comment",c.string="string",c.number="number",c.regexp="regexp",c.operator="operator",c.decorator="decorator"})(k||(t.SemanticTokenTypes=k={}));var O;(function(c){c.declaration="declaration",c.definition="definition",c.readonly="readonly",c.static="static",c.deprecated="deprecated",c.abstract="abstract",c.async="async",c.modification="modification",c.documentation="documentation",c.defaultLibrary="defaultLibrary"})(O||(t.SemanticTokenModifiers=O={}));var I;(function(c){function m(h){var d=h;return b.objectLiteral(d)&&(d.resultId===void 0||typeof d.resultId=="string")&&Array.isArray(d.data)&&(d.data.length===0||typeof d.data[0]=="number")}c.is=m})(I||(t.SemanticTokens=I={}));var te;(function(c){function m(d,a){return{range:d,text:a}}c.create=m;function h(d){var a=d;return a!=null&&u.is(a.range)&&b.string(a.text)}c.is=h})(te||(t.InlineValueText=te={}));var X;(function(c){function m(d,a,y){return{range:d,variableName:a,caseSensitiveLookup:y}}c.create=m;function h(d){var a=d;return a!=null&&u.is(a.range)&&b.boolean(a.caseSensitiveLookup)&&(b.string(a.variableName)||a.variableName===void 0)}c.is=h})(X||(t.InlineValueVariableLookup=X={}));var ce;(function(c){function m(d,a){return{range:d,expression:a}}c.create=m;function h(d){var a=d;return a!=null&&u.is(a.range)&&(b.string(a.expression)||a.expression===void 0)}c.is=h})(ce||(t.InlineValueEvaluatableExpression=ce={}));var fe;(function(c){function m(d,a){return{frameId:d,stoppedLocation:a}}c.create=m;function h(d){var a=d;return b.defined(a)&&u.is(d.stoppedLocation)}c.is=h})(fe||(t.InlineValueContext=fe={}));var V;(function(c){c.Type=1,c.Parameter=2;function m(h){return h===1||h===2}c.is=m})(V||(t.InlayHintKind=V={}));var ne;(function(c){function m(d){return{value:d}}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&(a.tooltip===void 0||b.string(a.tooltip)||Tn.is(a.tooltip))&&(a.location===void 0||f.is(a.location))&&(a.command===void 0||C.is(a.command))}c.is=h})(ne||(t.InlayHintLabelPart=ne={}));var G;(function(c){function m(d,a,y){var R={position:d,label:a};return y!==void 0&&(R.kind=y),R}c.create=m;function h(d){var a=d;return b.objectLiteral(a)&&s.is(a.position)&&(b.string(a.label)||b.typedArray(a.label,ne.is))&&(a.kind===void 0||V.is(a.kind))&&a.textEdits===void 0||b.typedArray(a.textEdits,W.is)&&(a.tooltip===void 0||b.string(a.tooltip)||Tn.is(a.tooltip))&&(a.paddingLeft===void 0||b.boolean(a.paddingLeft))&&(a.paddingRight===void 0||b.boolean(a.paddingRight))}c.is=h})(G||(t.InlayHint=G={}));var ye;(function(c){function m(h){return{kind:"snippet",value:h}}c.createSnippet=m})(ye||(t.StringValue=ye={}));var Ce;(function(c){function m(h,d,a,y){return{insertText:h,filterText:d,range:a,command:y}}c.create=m})(Ce||(t.InlineCompletionItem=Ce={}));var Xe;(function(c){function m(h){return{items:h}}c.create=m})(Xe||(t.InlineCompletionList=Xe={}));var Eo;(function(c){c.Invoked=0,c.Automatic=1})(Eo||(t.InlineCompletionTriggerKind=Eo={}));var Au;(function(c){function m(h,d){return{range:h,text:d}}c.create=m})(Au||(t.SelectedCompletionInfo=Au={}));var Mu;(function(c){function m(h,d){return{triggerKind:h,selectedCompletionInfo:d}}c.create=m})(Mu||(t.InlineCompletionContext=Mu={}));var qu;(function(c){function m(h){var d=h;return b.objectLiteral(d)&&i.is(d.uri)&&b.string(d.name)}c.is=m})(qu||(t.WorkspaceFolder=qu={})),t.EOL=[`
`,`\r
`,"\r"];var ju;(function(c){function m(y,R,j,be){return new Xg(y,R,j,be)}c.create=m;function h(y){var R=y;return!!(b.defined(R)&&b.string(R.uri)&&(b.undefined(R.languageId)||b.string(R.languageId))&&b.uinteger(R.lineCount)&&b.func(R.getText)&&b.func(R.positionAt)&&b.func(R.offsetAt))}c.is=h;function d(y,R){for(var j=y.getText(),be=a(R,function(Bn,Lo){var Bu=Bn.range.start.line-Lo.range.start.line;return Bu===0?Bn.range.start.character-Lo.range.start.character:Bu}),se=j.length,mt=be.length-1;mt>=0;mt--){var ht=be[mt],It=y.offsetAt(ht.range.start),$=y.offsetAt(ht.range.end);if($<=se)j=j.substring(0,It)+ht.newText+j.substring($,j.length);else throw new Error("Overlapping edit");se=It}return j}c.applyEdits=d;function a(y,R){if(y.length<=1)return y;var j=y.length/2|0,be=y.slice(0,j),se=y.slice(j);a(be,R),a(se,R);for(var mt=0,ht=0,It=0;mt<be.length&&ht<se.length;){var $=R(be[mt],se[ht]);$<=0?y[It++]=be[mt++]:y[It++]=se[ht++]}for(;mt<be.length;)y[It++]=be[mt++];for(;ht<se.length;)y[It++]=se[ht++];return y}})(ju||(t.TextDocument=ju={}));var Xg=function(){function c(m,h,d,a){this._uri=m,this._languageId=h,this._version=d,this._content=a,this._lineOffsets=void 0}return Object.defineProperty(c.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),c.prototype.getText=function(m){if(m){var h=this.offsetAt(m.start),d=this.offsetAt(m.end);return this._content.substring(h,d)}return this._content},c.prototype.update=function(m,h){this._content=m.text,this._version=h,this._lineOffsets=void 0},c.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var m=[],h=this._content,d=!0,a=0;a<h.length;a++){d&&(m.push(a),d=!1);var y=h.charAt(a);d=y==="\r"||y===`
`,y==="\r"&&a+1<h.length&&h.charAt(a+1)===`
`&&a++}d&&h.length>0&&m.push(h.length),this._lineOffsets=m}return this._lineOffsets},c.prototype.positionAt=function(m){m=Math.max(Math.min(m,this._content.length),0);var h=this.getLineOffsets(),d=0,a=h.length;if(a===0)return s.create(0,m);for(;d<a;){var y=Math.floor((d+a)/2);h[y]>m?a=y:d=y+1}var R=d-1;return s.create(R,m-h[R])},c.prototype.offsetAt=function(m){var h=this.getLineOffsets();if(m.line>=h.length)return this._content.length;if(m.line<0)return 0;var d=h[m.line],a=m.line+1<h.length?h[m.line+1]:this._content.length;return Math.max(Math.min(d+m.character,a),d)},Object.defineProperty(c.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),c}(),b;(function(c){var m=Object.prototype.toString;function h($){return typeof $<"u"}c.defined=h;function d($){return typeof $>"u"}c.undefined=d;function a($){return $===!0||$===!1}c.boolean=a;function y($){return m.call($)==="[object String]"}c.string=y;function R($){return m.call($)==="[object Number]"}c.number=R;function j($,Bn,Lo){return m.call($)==="[object Number]"&&Bn<=$&&$<=Lo}c.numberRange=j;function be($){return m.call($)==="[object Number]"&&-2147483648<=$&&$<=2147483647}c.integer=be;function se($){return m.call($)==="[object Number]"&&0<=$&&$<=2147483647}c.uinteger=se;function mt($){return m.call($)==="[object Function]"}c.func=mt;function ht($){return $!==null&&typeof $=="object"}c.objectLiteral=ht;function It($,Bn){return Array.isArray($)&&$.every(Bn)}c.typedArray=It})(b||(b={}))})});var pe=L(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.ProtocolNotificationType=Ve.ProtocolNotificationType0=Ve.ProtocolRequestType=Ve.ProtocolRequestType0=Ve.RegistrationType=Ve.MessageDirection=void 0;var Qn=kn(),xd;(function(e){e.clientToServer="clientToServer",e.serverToClient="serverToClient",e.both="both"})(xd||(Ve.MessageDirection=xd={}));var tc=class{constructor(t){this.method=t}};Ve.RegistrationType=tc;var nc=class extends Qn.RequestType0{constructor(t){super(t)}};Ve.ProtocolRequestType0=nc;var ic=class extends Qn.RequestType{constructor(t){super(t,Qn.ParameterStructures.byName)}};Ve.ProtocolRequestType=ic;var oc=class extends Qn.NotificationType0{constructor(t){super(t)}};Ve.ProtocolNotificationType0=oc;var rc=class extends Qn.NotificationType{constructor(t){super(t,Qn.ParameterStructures.byName)}};Ve.ProtocolNotificationType=rc});var or=L(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.objectLiteral=Ne.typedArray=Ne.stringArray=Ne.array=Ne.func=Ne.error=Ne.number=Ne.string=Ne.boolean=void 0;function $y(e){return e===!0||e===!1}Ne.boolean=$y;function Nd(e){return typeof e=="string"||e instanceof String}Ne.string=Nd;function zy(e){return typeof e=="number"||e instanceof Number}Ne.number=zy;function Uy(e){return e instanceof Error}Ne.error=Uy;function Gy(e){return typeof e=="function"}Ne.func=Gy;function kd(e){return Array.isArray(e)}Ne.array=kd;function Ky(e){return kd(e)&&e.every(t=>Nd(t))}Ne.stringArray=Ky;function Qy(e,t){return Array.isArray(e)&&e.every(t)}Ne.typedArray=Qy;function Jy(e){return e!==null&&typeof e=="object"}Ne.objectLiteral=Jy});var Cd=L(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.ImplementationRequest=void 0;var Rd=pe(),Pd;(function(e){e.method="textDocument/implementation",e.messageDirection=Rd.MessageDirection.clientToServer,e.type=new Rd.ProtocolRequestType(e.method)})(Pd||(rr.ImplementationRequest=Pd={}))});var Dd=L(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.TypeDefinitionRequest=void 0;var _d=pe(),Od;(function(e){e.method="textDocument/typeDefinition",e.messageDirection=_d.MessageDirection.clientToServer,e.type=new _d.ProtocolRequestType(e.method)})(Od||(sr.TypeDefinitionRequest=Od={}))});var Ld=L(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.DidChangeWorkspaceFoldersNotification=Jn.WorkspaceFoldersRequest=void 0;var ar=pe(),wd;(function(e){e.method="workspace/workspaceFolders",e.messageDirection=ar.MessageDirection.serverToClient,e.type=new ar.ProtocolRequestType0(e.method)})(wd||(Jn.WorkspaceFoldersRequest=wd={}));var Ed;(function(e){e.method="workspace/didChangeWorkspaceFolders",e.messageDirection=ar.MessageDirection.clientToServer,e.type=new ar.ProtocolNotificationType(e.method)})(Ed||(Jn.DidChangeWorkspaceFoldersNotification=Ed={}))});var Ad=L(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});cr.ConfigurationRequest=void 0;var Id=pe(),Fd;(function(e){e.method="workspace/configuration",e.messageDirection=Id.MessageDirection.serverToClient,e.type=new Id.ProtocolRequestType(e.method)})(Fd||(cr.ConfigurationRequest=Fd={}))});var jd=L(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.ColorPresentationRequest=Xn.DocumentColorRequest=void 0;var ur=pe(),Md;(function(e){e.method="textDocument/documentColor",e.messageDirection=ur.MessageDirection.clientToServer,e.type=new ur.ProtocolRequestType(e.method)})(Md||(Xn.DocumentColorRequest=Md={}));var qd;(function(e){e.method="textDocument/colorPresentation",e.messageDirection=ur.MessageDirection.clientToServer,e.type=new ur.ProtocolRequestType(e.method)})(qd||(Xn.ColorPresentationRequest=qd={}))});var Hd=L(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.FoldingRangeRefreshRequest=Yn.FoldingRangeRequest=void 0;var dr=pe(),Bd;(function(e){e.method="textDocument/foldingRange",e.messageDirection=dr.MessageDirection.clientToServer,e.type=new dr.ProtocolRequestType(e.method)})(Bd||(Yn.FoldingRangeRequest=Bd={}));var Wd;(function(e){e.method="workspace/foldingRange/refresh",e.messageDirection=dr.MessageDirection.serverToClient,e.type=new dr.ProtocolRequestType0(e.method)})(Wd||(Yn.FoldingRangeRefreshRequest=Wd={}))});var zd=L(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.DeclarationRequest=void 0;var Vd=pe(),$d;(function(e){e.method="textDocument/declaration",e.messageDirection=Vd.MessageDirection.clientToServer,e.type=new Vd.ProtocolRequestType(e.method)})($d||(lr.DeclarationRequest=$d={}))});var Kd=L(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.SelectionRangeRequest=void 0;var Ud=pe(),Gd;(function(e){e.method="textDocument/selectionRange",e.messageDirection=Ud.MessageDirection.clientToServer,e.type=new Ud.ProtocolRequestType(e.method)})(Gd||(fr.SelectionRangeRequest=Gd={}))});var Yd=L(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.WorkDoneProgressCancelNotification=Qt.WorkDoneProgressCreateRequest=Qt.WorkDoneProgress=void 0;var Xy=kn(),pr=pe(),Qd;(function(e){e.type=new Xy.ProgressType;function t(n){return n===e.type}e.is=t})(Qd||(Qt.WorkDoneProgress=Qd={}));var Jd;(function(e){e.method="window/workDoneProgress/create",e.messageDirection=pr.MessageDirection.serverToClient,e.type=new pr.ProtocolRequestType(e.method)})(Jd||(Qt.WorkDoneProgressCreateRequest=Jd={}));var Xd;(function(e){e.method="window/workDoneProgress/cancel",e.messageDirection=pr.MessageDirection.clientToServer,e.type=new pr.ProtocolNotificationType(e.method)})(Xd||(Qt.WorkDoneProgressCancelNotification=Xd={}))});var nl=L(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.CallHierarchyOutgoingCallsRequest=Jt.CallHierarchyIncomingCallsRequest=Jt.CallHierarchyPrepareRequest=void 0;var Zn=pe(),Zd;(function(e){e.method="textDocument/prepareCallHierarchy",e.messageDirection=Zn.MessageDirection.clientToServer,e.type=new Zn.ProtocolRequestType(e.method)})(Zd||(Jt.CallHierarchyPrepareRequest=Zd={}));var el;(function(e){e.method="callHierarchy/incomingCalls",e.messageDirection=Zn.MessageDirection.clientToServer,e.type=new Zn.ProtocolRequestType(e.method)})(el||(Jt.CallHierarchyIncomingCallsRequest=el={}));var tl;(function(e){e.method="callHierarchy/outgoingCalls",e.messageDirection=Zn.MessageDirection.clientToServer,e.type=new Zn.ProtocolRequestType(e.method)})(tl||(Jt.CallHierarchyOutgoingCallsRequest=tl={}))});var cl=L($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.SemanticTokensRefreshRequest=$e.SemanticTokensRangeRequest=$e.SemanticTokensDeltaRequest=$e.SemanticTokensRequest=$e.SemanticTokensRegistrationType=$e.TokenFormat=void 0;var At=pe(),il;(function(e){e.Relative="relative"})(il||($e.TokenFormat=il={}));var Fi;(function(e){e.method="textDocument/semanticTokens",e.type=new At.RegistrationType(e.method)})(Fi||($e.SemanticTokensRegistrationType=Fi={}));var ol;(function(e){e.method="textDocument/semanticTokens/full",e.messageDirection=At.MessageDirection.clientToServer,e.type=new At.ProtocolRequestType(e.method),e.registrationMethod=Fi.method})(ol||($e.SemanticTokensRequest=ol={}));var rl;(function(e){e.method="textDocument/semanticTokens/full/delta",e.messageDirection=At.MessageDirection.clientToServer,e.type=new At.ProtocolRequestType(e.method),e.registrationMethod=Fi.method})(rl||($e.SemanticTokensDeltaRequest=rl={}));var sl;(function(e){e.method="textDocument/semanticTokens/range",e.messageDirection=At.MessageDirection.clientToServer,e.type=new At.ProtocolRequestType(e.method),e.registrationMethod=Fi.method})(sl||($e.SemanticTokensRangeRequest=sl={}));var al;(function(e){e.method="workspace/semanticTokens/refresh",e.messageDirection=At.MessageDirection.serverToClient,e.type=new At.ProtocolRequestType0(e.method)})(al||($e.SemanticTokensRefreshRequest=al={}))});var ll=L(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.ShowDocumentRequest=void 0;var ul=pe(),dl;(function(e){e.method="window/showDocument",e.messageDirection=ul.MessageDirection.serverToClient,e.type=new ul.ProtocolRequestType(e.method)})(dl||(mr.ShowDocumentRequest=dl={}))});var ml=L(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.LinkedEditingRangeRequest=void 0;var fl=pe(),pl;(function(e){e.method="textDocument/linkedEditingRange",e.messageDirection=fl.MessageDirection.clientToServer,e.type=new fl.ProtocolRequestType(e.method)})(pl||(hr.LinkedEditingRangeRequest=pl={}))});var xl=L(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.WillDeleteFilesRequest=Ae.DidDeleteFilesNotification=Ae.DidRenameFilesNotification=Ae.WillRenameFilesRequest=Ae.DidCreateFilesNotification=Ae.WillCreateFilesRequest=Ae.FileOperationPatternKind=void 0;var nt=pe(),hl;(function(e){e.file="file",e.folder="folder"})(hl||(Ae.FileOperationPatternKind=hl={}));var gl;(function(e){e.method="workspace/willCreateFiles",e.messageDirection=nt.MessageDirection.clientToServer,e.type=new nt.ProtocolRequestType(e.method)})(gl||(Ae.WillCreateFilesRequest=gl={}));var yl;(function(e){e.method="workspace/didCreateFiles",e.messageDirection=nt.MessageDirection.clientToServer,e.type=new nt.ProtocolNotificationType(e.method)})(yl||(Ae.DidCreateFilesNotification=yl={}));var bl;(function(e){e.method="workspace/willRenameFiles",e.messageDirection=nt.MessageDirection.clientToServer,e.type=new nt.ProtocolRequestType(e.method)})(bl||(Ae.WillRenameFilesRequest=bl={}));var Tl;(function(e){e.method="workspace/didRenameFiles",e.messageDirection=nt.MessageDirection.clientToServer,e.type=new nt.ProtocolNotificationType(e.method)})(Tl||(Ae.DidRenameFilesNotification=Tl={}));var Sl;(function(e){e.method="workspace/didDeleteFiles",e.messageDirection=nt.MessageDirection.clientToServer,e.type=new nt.ProtocolNotificationType(e.method)})(Sl||(Ae.DidDeleteFilesNotification=Sl={}));var vl;(function(e){e.method="workspace/willDeleteFiles",e.messageDirection=nt.MessageDirection.clientToServer,e.type=new nt.ProtocolRequestType(e.method)})(vl||(Ae.WillDeleteFilesRequest=vl={}))});var Cl=L(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.MonikerRequest=Xt.MonikerKind=Xt.UniquenessLevel=void 0;var Nl=pe(),kl;(function(e){e.document="document",e.project="project",e.group="group",e.scheme="scheme",e.global="global"})(kl||(Xt.UniquenessLevel=kl={}));var Rl;(function(e){e.$import="import",e.$export="export",e.local="local"})(Rl||(Xt.MonikerKind=Rl={}));var Pl;(function(e){e.method="textDocument/moniker",e.messageDirection=Nl.MessageDirection.clientToServer,e.type=new Nl.ProtocolRequestType(e.method)})(Pl||(Xt.MonikerRequest=Pl={}))});var wl=L(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.TypeHierarchySubtypesRequest=Yt.TypeHierarchySupertypesRequest=Yt.TypeHierarchyPrepareRequest=void 0;var ei=pe(),_l;(function(e){e.method="textDocument/prepareTypeHierarchy",e.messageDirection=ei.MessageDirection.clientToServer,e.type=new ei.ProtocolRequestType(e.method)})(_l||(Yt.TypeHierarchyPrepareRequest=_l={}));var Ol;(function(e){e.method="typeHierarchy/supertypes",e.messageDirection=ei.MessageDirection.clientToServer,e.type=new ei.ProtocolRequestType(e.method)})(Ol||(Yt.TypeHierarchySupertypesRequest=Ol={}));var Dl;(function(e){e.method="typeHierarchy/subtypes",e.messageDirection=ei.MessageDirection.clientToServer,e.type=new ei.ProtocolRequestType(e.method)})(Dl||(Yt.TypeHierarchySubtypesRequest=Dl={}))});var Il=L(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.InlineValueRefreshRequest=ti.InlineValueRequest=void 0;var gr=pe(),El;(function(e){e.method="textDocument/inlineValue",e.messageDirection=gr.MessageDirection.clientToServer,e.type=new gr.ProtocolRequestType(e.method)})(El||(ti.InlineValueRequest=El={}));var Ll;(function(e){e.method="workspace/inlineValue/refresh",e.messageDirection=gr.MessageDirection.serverToClient,e.type=new gr.ProtocolRequestType0(e.method)})(Ll||(ti.InlineValueRefreshRequest=Ll={}))});var ql=L(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.InlayHintRefreshRequest=Zt.InlayHintResolveRequest=Zt.InlayHintRequest=void 0;var ni=pe(),Fl;(function(e){e.method="textDocument/inlayHint",e.messageDirection=ni.MessageDirection.clientToServer,e.type=new ni.ProtocolRequestType(e.method)})(Fl||(Zt.InlayHintRequest=Fl={}));var Al;(function(e){e.method="inlayHint/resolve",e.messageDirection=ni.MessageDirection.clientToServer,e.type=new ni.ProtocolRequestType(e.method)})(Al||(Zt.InlayHintResolveRequest=Al={}));var Ml;(function(e){e.method="workspace/inlayHint/refresh",e.messageDirection=ni.MessageDirection.serverToClient,e.type=new ni.ProtocolRequestType0(e.method)})(Ml||(Zt.InlayHintRefreshRequest=Ml={}))});var zl=L(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.DiagnosticRefreshRequest=it.WorkspaceDiagnosticRequest=it.DocumentDiagnosticRequest=it.DocumentDiagnosticReportKind=it.DiagnosticServerCancellationData=void 0;var $l=kn(),Yy=or(),ii=pe(),jl;(function(e){function t(n){let i=n;return i&&Yy.boolean(i.retriggerRequest)}e.is=t})(jl||(it.DiagnosticServerCancellationData=jl={}));var Bl;(function(e){e.Full="full",e.Unchanged="unchanged"})(Bl||(it.DocumentDiagnosticReportKind=Bl={}));var Wl;(function(e){e.method="textDocument/diagnostic",e.messageDirection=ii.MessageDirection.clientToServer,e.type=new ii.ProtocolRequestType(e.method),e.partialResult=new $l.ProgressType})(Wl||(it.DocumentDiagnosticRequest=Wl={}));var Hl;(function(e){e.method="workspace/diagnostic",e.messageDirection=ii.MessageDirection.clientToServer,e.type=new ii.ProtocolRequestType(e.method),e.partialResult=new $l.ProgressType})(Hl||(it.WorkspaceDiagnosticRequest=Hl={}));var Vl;(function(e){e.method="workspace/diagnostic/refresh",e.messageDirection=ii.MessageDirection.serverToClient,e.type=new ii.ProtocolRequestType0(e.method)})(Vl||(it.DiagnosticRefreshRequest=Vl={}))});var Yl=L(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.DidCloseNotebookDocumentNotification=Te.DidSaveNotebookDocumentNotification=Te.DidChangeNotebookDocumentNotification=Te.NotebookCellArrayChange=Te.DidOpenNotebookDocumentNotification=Te.NotebookDocumentSyncRegistrationType=Te.NotebookDocument=Te.NotebookCell=Te.ExecutionSummary=Te.NotebookCellKind=void 0;var Ai=ir(),yt=or(),xt=pe(),sc;(function(e){e.Markup=1,e.Code=2;function t(n){return n===1||n===2}e.is=t})(sc||(Te.NotebookCellKind=sc={}));var ac;(function(e){function t(o,r){let s={executionOrder:o};return(r===!0||r===!1)&&(s.success=r),s}e.create=t;function n(o){let r=o;return yt.objectLiteral(r)&&Ai.uinteger.is(r.executionOrder)&&(r.success===void 0||yt.boolean(r.success))}e.is=n;function i(o,r){return o===r?!0:o==null||r===null||r===void 0?!1:o.executionOrder===r.executionOrder&&o.success===r.success}e.equals=i})(ac||(Te.ExecutionSummary=ac={}));var yr;(function(e){function t(r,s){return{kind:r,document:s}}e.create=t;function n(r){let s=r;return yt.objectLiteral(s)&&sc.is(s.kind)&&Ai.DocumentUri.is(s.document)&&(s.metadata===void 0||yt.objectLiteral(s.metadata))}e.is=n;function i(r,s){let u=new Set;return r.document!==s.document&&u.add("document"),r.kind!==s.kind&&u.add("kind"),r.executionSummary!==s.executionSummary&&u.add("executionSummary"),(r.metadata!==void 0||s.metadata!==void 0)&&!o(r.metadata,s.metadata)&&u.add("metadata"),(r.executionSummary!==void 0||s.executionSummary!==void 0)&&!ac.equals(r.executionSummary,s.executionSummary)&&u.add("executionSummary"),u}e.diff=i;function o(r,s){if(r===s)return!0;if(r==null||s===null||s===void 0||typeof r!=typeof s||typeof r!="object")return!1;let u=Array.isArray(r),f=Array.isArray(s);if(u!==f)return!1;if(u&&f){if(r.length!==s.length)return!1;for(let g=0;g<r.length;g++)if(!o(r[g],s[g]))return!1}if(yt.objectLiteral(r)&&yt.objectLiteral(s)){let g=Object.keys(r),v=Object.keys(s);if(g.length!==v.length||(g.sort(),v.sort(),!o(g,v)))return!1;for(let _=0;_<g.length;_++){let w=g[_];if(!o(r[w],s[w]))return!1}}return!0}})(yr||(Te.NotebookCell=yr={}));var Ul;(function(e){function t(i,o,r,s){return{uri:i,notebookType:o,version:r,cells:s}}e.create=t;function n(i){let o=i;return yt.objectLiteral(o)&&yt.string(o.uri)&&Ai.integer.is(o.version)&&yt.typedArray(o.cells,yr.is)}e.is=n})(Ul||(Te.NotebookDocument=Ul={}));var oi;(function(e){e.method="notebookDocument/sync",e.messageDirection=xt.MessageDirection.clientToServer,e.type=new xt.RegistrationType(e.method)})(oi||(Te.NotebookDocumentSyncRegistrationType=oi={}));var Gl;(function(e){e.method="notebookDocument/didOpen",e.messageDirection=xt.MessageDirection.clientToServer,e.type=new xt.ProtocolNotificationType(e.method),e.registrationMethod=oi.method})(Gl||(Te.DidOpenNotebookDocumentNotification=Gl={}));var Kl;(function(e){function t(i){let o=i;return yt.objectLiteral(o)&&Ai.uinteger.is(o.start)&&Ai.uinteger.is(o.deleteCount)&&(o.cells===void 0||yt.typedArray(o.cells,yr.is))}e.is=t;function n(i,o,r){let s={start:i,deleteCount:o};return r!==void 0&&(s.cells=r),s}e.create=n})(Kl||(Te.NotebookCellArrayChange=Kl={}));var Ql;(function(e){e.method="notebookDocument/didChange",e.messageDirection=xt.MessageDirection.clientToServer,e.type=new xt.ProtocolNotificationType(e.method),e.registrationMethod=oi.method})(Ql||(Te.DidChangeNotebookDocumentNotification=Ql={}));var Jl;(function(e){e.method="notebookDocument/didSave",e.messageDirection=xt.MessageDirection.clientToServer,e.type=new xt.ProtocolNotificationType(e.method),e.registrationMethod=oi.method})(Jl||(Te.DidSaveNotebookDocumentNotification=Jl={}));var Xl;(function(e){e.method="notebookDocument/didClose",e.messageDirection=xt.MessageDirection.clientToServer,e.type=new xt.ProtocolNotificationType(e.method),e.registrationMethod=oi.method})(Xl||(Te.DidCloseNotebookDocumentNotification=Xl={}))});var tf=L(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.InlineCompletionRequest=void 0;var Zl=pe(),ef;(function(e){e.method="textDocument/inlineCompletion",e.messageDirection=Zl.MessageDirection.clientToServer,e.type=new Zl.ProtocolRequestType(e.method)})(ef||(br.InlineCompletionRequest=ef={}))});var hp=L(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.WorkspaceSymbolRequest=l.CodeActionResolveRequest=l.CodeActionRequest=l.DocumentSymbolRequest=l.DocumentHighlightRequest=l.ReferencesRequest=l.DefinitionRequest=l.SignatureHelpRequest=l.SignatureHelpTriggerKind=l.HoverRequest=l.CompletionResolveRequest=l.CompletionRequest=l.CompletionTriggerKind=l.PublishDiagnosticsNotification=l.WatchKind=l.RelativePattern=l.FileChangeType=l.DidChangeWatchedFilesNotification=l.WillSaveTextDocumentWaitUntilRequest=l.WillSaveTextDocumentNotification=l.TextDocumentSaveReason=l.DidSaveTextDocumentNotification=l.DidCloseTextDocumentNotification=l.DidChangeTextDocumentNotification=l.TextDocumentContentChangeEvent=l.DidOpenTextDocumentNotification=l.TextDocumentSyncKind=l.TelemetryEventNotification=l.LogMessageNotification=l.ShowMessageRequest=l.ShowMessageNotification=l.MessageType=l.DidChangeConfigurationNotification=l.ExitNotification=l.ShutdownRequest=l.InitializedNotification=l.InitializeErrorCodes=l.InitializeRequest=l.WorkDoneProgressOptions=l.TextDocumentRegistrationOptions=l.StaticRegistrationOptions=l.PositionEncodingKind=l.FailureHandlingKind=l.ResourceOperationKind=l.UnregistrationRequest=l.RegistrationRequest=l.DocumentSelector=l.NotebookCellTextDocumentFilter=l.NotebookDocumentFilter=l.TextDocumentFilter=void 0;l.MonikerRequest=l.MonikerKind=l.UniquenessLevel=l.WillDeleteFilesRequest=l.DidDeleteFilesNotification=l.WillRenameFilesRequest=l.DidRenameFilesNotification=l.WillCreateFilesRequest=l.DidCreateFilesNotification=l.FileOperationPatternKind=l.LinkedEditingRangeRequest=l.ShowDocumentRequest=l.SemanticTokensRegistrationType=l.SemanticTokensRefreshRequest=l.SemanticTokensRangeRequest=l.SemanticTokensDeltaRequest=l.SemanticTokensRequest=l.TokenFormat=l.CallHierarchyPrepareRequest=l.CallHierarchyOutgoingCallsRequest=l.CallHierarchyIncomingCallsRequest=l.WorkDoneProgressCancelNotification=l.WorkDoneProgressCreateRequest=l.WorkDoneProgress=l.SelectionRangeRequest=l.DeclarationRequest=l.FoldingRangeRefreshRequest=l.FoldingRangeRequest=l.ColorPresentationRequest=l.DocumentColorRequest=l.ConfigurationRequest=l.DidChangeWorkspaceFoldersNotification=l.WorkspaceFoldersRequest=l.TypeDefinitionRequest=l.ImplementationRequest=l.ApplyWorkspaceEditRequest=l.ExecuteCommandRequest=l.PrepareRenameRequest=l.RenameRequest=l.PrepareSupportDefaultBehavior=l.DocumentOnTypeFormattingRequest=l.DocumentRangesFormattingRequest=l.DocumentRangeFormattingRequest=l.DocumentFormattingRequest=l.DocumentLinkResolveRequest=l.DocumentLinkRequest=l.CodeLensRefreshRequest=l.CodeLensResolveRequest=l.CodeLensRequest=l.WorkspaceSymbolResolveRequest=void 0;l.InlineCompletionRequest=l.DidCloseNotebookDocumentNotification=l.DidSaveNotebookDocumentNotification=l.DidChangeNotebookDocumentNotification=l.NotebookCellArrayChange=l.DidOpenNotebookDocumentNotification=l.NotebookDocumentSyncRegistrationType=l.NotebookDocument=l.NotebookCell=l.ExecutionSummary=l.NotebookCellKind=l.DiagnosticRefreshRequest=l.WorkspaceDiagnosticRequest=l.DocumentDiagnosticRequest=l.DocumentDiagnosticReportKind=l.DiagnosticServerCancellationData=l.InlayHintRefreshRequest=l.InlayHintResolveRequest=l.InlayHintRequest=l.InlineValueRefreshRequest=l.InlineValueRequest=l.TypeHierarchySupertypesRequest=l.TypeHierarchySubtypesRequest=l.TypeHierarchyPrepareRequest=void 0;var P=pe(),nf=ir(),_e=or(),Zy=Cd();Object.defineProperty(l,"ImplementationRequest",{enumerable:!0,get:function(){return Zy.ImplementationRequest}});var eb=Dd();Object.defineProperty(l,"TypeDefinitionRequest",{enumerable:!0,get:function(){return eb.TypeDefinitionRequest}});var lp=Ld();Object.defineProperty(l,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return lp.WorkspaceFoldersRequest}});Object.defineProperty(l,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return lp.DidChangeWorkspaceFoldersNotification}});var tb=Ad();Object.defineProperty(l,"ConfigurationRequest",{enumerable:!0,get:function(){return tb.ConfigurationRequest}});var fp=jd();Object.defineProperty(l,"DocumentColorRequest",{enumerable:!0,get:function(){return fp.DocumentColorRequest}});Object.defineProperty(l,"ColorPresentationRequest",{enumerable:!0,get:function(){return fp.ColorPresentationRequest}});var pp=Hd();Object.defineProperty(l,"FoldingRangeRequest",{enumerable:!0,get:function(){return pp.FoldingRangeRequest}});Object.defineProperty(l,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return pp.FoldingRangeRefreshRequest}});var nb=zd();Object.defineProperty(l,"DeclarationRequest",{enumerable:!0,get:function(){return nb.DeclarationRequest}});var ib=Kd();Object.defineProperty(l,"SelectionRangeRequest",{enumerable:!0,get:function(){return ib.SelectionRangeRequest}});var fc=Yd();Object.defineProperty(l,"WorkDoneProgress",{enumerable:!0,get:function(){return fc.WorkDoneProgress}});Object.defineProperty(l,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return fc.WorkDoneProgressCreateRequest}});Object.defineProperty(l,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return fc.WorkDoneProgressCancelNotification}});var pc=nl();Object.defineProperty(l,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return pc.CallHierarchyIncomingCallsRequest}});Object.defineProperty(l,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return pc.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(l,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return pc.CallHierarchyPrepareRequest}});var ri=cl();Object.defineProperty(l,"TokenFormat",{enumerable:!0,get:function(){return ri.TokenFormat}});Object.defineProperty(l,"SemanticTokensRequest",{enumerable:!0,get:function(){return ri.SemanticTokensRequest}});Object.defineProperty(l,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return ri.SemanticTokensDeltaRequest}});Object.defineProperty(l,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return ri.SemanticTokensRangeRequest}});Object.defineProperty(l,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return ri.SemanticTokensRefreshRequest}});Object.defineProperty(l,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return ri.SemanticTokensRegistrationType}});var ob=ll();Object.defineProperty(l,"ShowDocumentRequest",{enumerable:!0,get:function(){return ob.ShowDocumentRequest}});var rb=ml();Object.defineProperty(l,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return rb.LinkedEditingRangeRequest}});var Rn=xl();Object.defineProperty(l,"FileOperationPatternKind",{enumerable:!0,get:function(){return Rn.FileOperationPatternKind}});Object.defineProperty(l,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Rn.DidCreateFilesNotification}});Object.defineProperty(l,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Rn.WillCreateFilesRequest}});Object.defineProperty(l,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Rn.DidRenameFilesNotification}});Object.defineProperty(l,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Rn.WillRenameFilesRequest}});Object.defineProperty(l,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Rn.DidDeleteFilesNotification}});Object.defineProperty(l,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Rn.WillDeleteFilesRequest}});var mc=Cl();Object.defineProperty(l,"UniquenessLevel",{enumerable:!0,get:function(){return mc.UniquenessLevel}});Object.defineProperty(l,"MonikerKind",{enumerable:!0,get:function(){return mc.MonikerKind}});Object.defineProperty(l,"MonikerRequest",{enumerable:!0,get:function(){return mc.MonikerRequest}});var hc=wl();Object.defineProperty(l,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return hc.TypeHierarchyPrepareRequest}});Object.defineProperty(l,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return hc.TypeHierarchySubtypesRequest}});Object.defineProperty(l,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return hc.TypeHierarchySupertypesRequest}});var mp=Il();Object.defineProperty(l,"InlineValueRequest",{enumerable:!0,get:function(){return mp.InlineValueRequest}});Object.defineProperty(l,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return mp.InlineValueRefreshRequest}});var gc=ql();Object.defineProperty(l,"InlayHintRequest",{enumerable:!0,get:function(){return gc.InlayHintRequest}});Object.defineProperty(l,"InlayHintResolveRequest",{enumerable:!0,get:function(){return gc.InlayHintResolveRequest}});Object.defineProperty(l,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return gc.InlayHintRefreshRequest}});var Mi=zl();Object.defineProperty(l,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Mi.DiagnosticServerCancellationData}});Object.defineProperty(l,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Mi.DocumentDiagnosticReportKind}});Object.defineProperty(l,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Mi.DocumentDiagnosticRequest}});Object.defineProperty(l,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Mi.WorkspaceDiagnosticRequest}});Object.defineProperty(l,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Mi.DiagnosticRefreshRequest}});var Nt=Yl();Object.defineProperty(l,"NotebookCellKind",{enumerable:!0,get:function(){return Nt.NotebookCellKind}});Object.defineProperty(l,"ExecutionSummary",{enumerable:!0,get:function(){return Nt.ExecutionSummary}});Object.defineProperty(l,"NotebookCell",{enumerable:!0,get:function(){return Nt.NotebookCell}});Object.defineProperty(l,"NotebookDocument",{enumerable:!0,get:function(){return Nt.NotebookDocument}});Object.defineProperty(l,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Nt.NotebookDocumentSyncRegistrationType}});Object.defineProperty(l,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Nt.DidOpenNotebookDocumentNotification}});Object.defineProperty(l,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Nt.NotebookCellArrayChange}});Object.defineProperty(l,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Nt.DidChangeNotebookDocumentNotification}});Object.defineProperty(l,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Nt.DidSaveNotebookDocumentNotification}});Object.defineProperty(l,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Nt.DidCloseNotebookDocumentNotification}});var sb=tf();Object.defineProperty(l,"InlineCompletionRequest",{enumerable:!0,get:function(){return sb.InlineCompletionRequest}});var cc;(function(e){function t(n){let i=n;return _e.string(i)||_e.string(i.language)||_e.string(i.scheme)||_e.string(i.pattern)}e.is=t})(cc||(l.TextDocumentFilter=cc={}));var uc;(function(e){function t(n){let i=n;return _e.objectLiteral(i)&&(_e.string(i.notebookType)||_e.string(i.scheme)||_e.string(i.pattern))}e.is=t})(uc||(l.NotebookDocumentFilter=uc={}));var dc;(function(e){function t(n){let i=n;return _e.objectLiteral(i)&&(_e.string(i.notebook)||uc.is(i.notebook))&&(i.language===void 0||_e.string(i.language))}e.is=t})(dc||(l.NotebookCellTextDocumentFilter=dc={}));var lc;(function(e){function t(n){if(!Array.isArray(n))return!1;for(let i of n)if(!_e.string(i)&&!cc.is(i)&&!dc.is(i))return!1;return!0}e.is=t})(lc||(l.DocumentSelector=lc={}));var of;(function(e){e.method="client/registerCapability",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolRequestType(e.method)})(of||(l.RegistrationRequest=of={}));var rf;(function(e){e.method="client/unregisterCapability",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolRequestType(e.method)})(rf||(l.UnregistrationRequest=rf={}));var sf;(function(e){e.Create="create",e.Rename="rename",e.Delete="delete"})(sf||(l.ResourceOperationKind=sf={}));var af;(function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"})(af||(l.FailureHandlingKind=af={}));var cf;(function(e){e.UTF8="utf-8",e.UTF16="utf-16",e.UTF32="utf-32"})(cf||(l.PositionEncodingKind=cf={}));var uf;(function(e){function t(n){let i=n;return i&&_e.string(i.id)&&i.id.length>0}e.hasId=t})(uf||(l.StaticRegistrationOptions=uf={}));var df;(function(e){function t(n){let i=n;return i&&(i.documentSelector===null||lc.is(i.documentSelector))}e.is=t})(df||(l.TextDocumentRegistrationOptions=df={}));var lf;(function(e){function t(i){let o=i;return _e.objectLiteral(o)&&(o.workDoneProgress===void 0||_e.boolean(o.workDoneProgress))}e.is=t;function n(i){let o=i;return o&&_e.boolean(o.workDoneProgress)}e.hasWorkDoneProgress=n})(lf||(l.WorkDoneProgressOptions=lf={}));var ff;(function(e){e.method="initialize",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(ff||(l.InitializeRequest=ff={}));var pf;(function(e){e.unknownProtocolVersion=1})(pf||(l.InitializeErrorCodes=pf={}));var mf;(function(e){e.method="initialized",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(mf||(l.InitializedNotification=mf={}));var hf;(function(e){e.method="shutdown",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType0(e.method)})(hf||(l.ShutdownRequest=hf={}));var gf;(function(e){e.method="exit",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType0(e.method)})(gf||(l.ExitNotification=gf={}));var yf;(function(e){e.method="workspace/didChangeConfiguration",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(yf||(l.DidChangeConfigurationNotification=yf={}));var bf;(function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4,e.Debug=5})(bf||(l.MessageType=bf={}));var Tf;(function(e){e.method="window/showMessage",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolNotificationType(e.method)})(Tf||(l.ShowMessageNotification=Tf={}));var Sf;(function(e){e.method="window/showMessageRequest",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolRequestType(e.method)})(Sf||(l.ShowMessageRequest=Sf={}));var vf;(function(e){e.method="window/logMessage",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolNotificationType(e.method)})(vf||(l.LogMessageNotification=vf={}));var xf;(function(e){e.method="telemetry/event",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolNotificationType(e.method)})(xf||(l.TelemetryEventNotification=xf={}));var Nf;(function(e){e.None=0,e.Full=1,e.Incremental=2})(Nf||(l.TextDocumentSyncKind=Nf={}));var kf;(function(e){e.method="textDocument/didOpen",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(kf||(l.DidOpenTextDocumentNotification=kf={}));var Rf;(function(e){function t(i){let o=i;return o!=null&&typeof o.text=="string"&&o.range!==void 0&&(o.rangeLength===void 0||typeof o.rangeLength=="number")}e.isIncremental=t;function n(i){let o=i;return o!=null&&typeof o.text=="string"&&o.range===void 0&&o.rangeLength===void 0}e.isFull=n})(Rf||(l.TextDocumentContentChangeEvent=Rf={}));var Pf;(function(e){e.method="textDocument/didChange",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(Pf||(l.DidChangeTextDocumentNotification=Pf={}));var Cf;(function(e){e.method="textDocument/didClose",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(Cf||(l.DidCloseTextDocumentNotification=Cf={}));var _f;(function(e){e.method="textDocument/didSave",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(_f||(l.DidSaveTextDocumentNotification=_f={}));var Of;(function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3})(Of||(l.TextDocumentSaveReason=Of={}));var Df;(function(e){e.method="textDocument/willSave",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(Df||(l.WillSaveTextDocumentNotification=Df={}));var wf;(function(e){e.method="textDocument/willSaveWaitUntil",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(wf||(l.WillSaveTextDocumentWaitUntilRequest=wf={}));var Ef;(function(e){e.method="workspace/didChangeWatchedFiles",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolNotificationType(e.method)})(Ef||(l.DidChangeWatchedFilesNotification=Ef={}));var Lf;(function(e){e.Created=1,e.Changed=2,e.Deleted=3})(Lf||(l.FileChangeType=Lf={}));var If;(function(e){function t(n){let i=n;return _e.objectLiteral(i)&&(nf.URI.is(i.baseUri)||nf.WorkspaceFolder.is(i.baseUri))&&_e.string(i.pattern)}e.is=t})(If||(l.RelativePattern=If={}));var Ff;(function(e){e.Create=1,e.Change=2,e.Delete=4})(Ff||(l.WatchKind=Ff={}));var Af;(function(e){e.method="textDocument/publishDiagnostics",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolNotificationType(e.method)})(Af||(l.PublishDiagnosticsNotification=Af={}));var Mf;(function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3})(Mf||(l.CompletionTriggerKind=Mf={}));var qf;(function(e){e.method="textDocument/completion",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(qf||(l.CompletionRequest=qf={}));var jf;(function(e){e.method="completionItem/resolve",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(jf||(l.CompletionResolveRequest=jf={}));var Bf;(function(e){e.method="textDocument/hover",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Bf||(l.HoverRequest=Bf={}));var Wf;(function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3})(Wf||(l.SignatureHelpTriggerKind=Wf={}));var Hf;(function(e){e.method="textDocument/signatureHelp",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Hf||(l.SignatureHelpRequest=Hf={}));var Vf;(function(e){e.method="textDocument/definition",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Vf||(l.DefinitionRequest=Vf={}));var $f;(function(e){e.method="textDocument/references",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})($f||(l.ReferencesRequest=$f={}));var zf;(function(e){e.method="textDocument/documentHighlight",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(zf||(l.DocumentHighlightRequest=zf={}));var Uf;(function(e){e.method="textDocument/documentSymbol",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Uf||(l.DocumentSymbolRequest=Uf={}));var Gf;(function(e){e.method="textDocument/codeAction",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Gf||(l.CodeActionRequest=Gf={}));var Kf;(function(e){e.method="codeAction/resolve",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Kf||(l.CodeActionResolveRequest=Kf={}));var Qf;(function(e){e.method="workspace/symbol",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Qf||(l.WorkspaceSymbolRequest=Qf={}));var Jf;(function(e){e.method="workspaceSymbol/resolve",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Jf||(l.WorkspaceSymbolResolveRequest=Jf={}));var Xf;(function(e){e.method="textDocument/codeLens",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Xf||(l.CodeLensRequest=Xf={}));var Yf;(function(e){e.method="codeLens/resolve",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(Yf||(l.CodeLensResolveRequest=Yf={}));var Zf;(function(e){e.method="workspace/codeLens/refresh",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolRequestType0(e.method)})(Zf||(l.CodeLensRefreshRequest=Zf={}));var ep;(function(e){e.method="textDocument/documentLink",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(ep||(l.DocumentLinkRequest=ep={}));var tp;(function(e){e.method="documentLink/resolve",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(tp||(l.DocumentLinkResolveRequest=tp={}));var np;(function(e){e.method="textDocument/formatting",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(np||(l.DocumentFormattingRequest=np={}));var ip;(function(e){e.method="textDocument/rangeFormatting",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(ip||(l.DocumentRangeFormattingRequest=ip={}));var op;(function(e){e.method="textDocument/rangesFormatting",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(op||(l.DocumentRangesFormattingRequest=op={}));var rp;(function(e){e.method="textDocument/onTypeFormatting",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(rp||(l.DocumentOnTypeFormattingRequest=rp={}));var sp;(function(e){e.Identifier=1})(sp||(l.PrepareSupportDefaultBehavior=sp={}));var ap;(function(e){e.method="textDocument/rename",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(ap||(l.RenameRequest=ap={}));var cp;(function(e){e.method="textDocument/prepareRename",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(cp||(l.PrepareRenameRequest=cp={}));var up;(function(e){e.method="workspace/executeCommand",e.messageDirection=P.MessageDirection.clientToServer,e.type=new P.ProtocolRequestType(e.method)})(up||(l.ExecuteCommandRequest=up={}));var dp;(function(e){e.method="workspace/applyEdit",e.messageDirection=P.MessageDirection.serverToClient,e.type=new P.ProtocolRequestType("workspace/applyEdit")})(dp||(l.ApplyWorkspaceEditRequest=dp={}))});var yp=L(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.createProtocolConnection=void 0;var gp=kn();function ab(e,t,n,i){return gp.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,gp.createMessageConnection)(e,t,n,i)}Tr.createProtocolConnection=ab});var Tp=L(ze=>{"use strict";var cb=ze&&ze.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Sr=ze&&ze.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&cb(t,e,n)};Object.defineProperty(ze,"__esModule",{value:!0});ze.LSPErrorCodes=ze.createProtocolConnection=void 0;Sr(kn(),ze);Sr(ir(),ze);Sr(pe(),ze);Sr(hp(),ze);var ub=yp();Object.defineProperty(ze,"createProtocolConnection",{enumerable:!0,get:function(){return ub.createProtocolConnection}});var bp;(function(e){e.lspReservedErrorRangeStart=-32899,e.RequestFailed=-32803,e.ServerCancelled=-32802,e.ContentModified=-32801,e.RequestCancelled=-32800,e.lspReservedErrorRangeEnd=-32800})(bp||(ze.LSPErrorCodes=bp={}))});var Se=L(kt=>{"use strict";var db=kt&&kt.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Sp=kt&&kt.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&db(t,e,n)};Object.defineProperty(kt,"__esModule",{value:!0});kt.createProtocolConnection=void 0;var lb=ec();Sp(ec(),kt);Sp(Tp(),kt);function fb(e,t,n,i){return(0,lb.createMessageConnection)(e,t,n,i)}kt.createProtocolConnection=fb});var yc=L(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.generateUuid=ot.parse=ot.isUUID=ot.v4=ot.empty=void 0;var qi=class{constructor(t){this._value=t}asHex(){return this._value}equals(t){return this.asHex()===t.asHex()}},ji=class e extends qi{static _oneOf(t){return t[Math.floor(t.length*Math.random())]}static _randomHex(){return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-","4",e._randomHex(),e._randomHex(),e._randomHex(),"-",e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex()].join(""))}};ji._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];ji._timeHighBits=["8","9","a","b"];ot.empty=new qi("00000000-0000-0000-0000-000000000000");function vp(){return new ji}ot.v4=vp;var pb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function xp(e){return pb.test(e)}ot.isUUID=xp;function mb(e){if(!xp(e))throw new Error("invalid uuid");return new qi(e)}ot.parse=mb;function hb(){return vp().asHex()}ot.generateUuid=hb});var Np=L(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.attachPartialResult=tn.ProgressFeature=tn.attachWorkDone=void 0;var en=Se(),gb=yc(),Pn=class e{constructor(t,n){this._connection=t,this._token=n,e.Instances.set(this._token,this)}begin(t,n,i,o){let r={kind:"begin",title:t,percentage:n,message:i,cancellable:o};this._connection.sendProgress(en.WorkDoneProgress.type,this._token,r)}report(t,n){let i={kind:"report"};typeof t=="number"?(i.percentage=t,n!==void 0&&(i.message=n)):i.message=t,this._connection.sendProgress(en.WorkDoneProgress.type,this._token,i)}done(){e.Instances.delete(this._token),this._connection.sendProgress(en.WorkDoneProgress.type,this._token,{kind:"end"})}};Pn.Instances=new Map;var vr=class extends Pn{constructor(t,n){super(t,n),this._source=new en.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},Bi=class{constructor(){}begin(){}report(){}done(){}},xr=class extends Bi{constructor(){super(),this._source=new en.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function yb(e,t){if(t===void 0||t.workDoneToken===void 0)return new Bi;let n=t.workDoneToken;return delete t.workDoneToken,new Pn(e,n)}tn.attachWorkDone=yb;var bb=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(t){super.initialize(t),t?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(en.WorkDoneProgressCancelNotification.type,n=>{let i=Pn.Instances.get(n.token);(i instanceof vr||i instanceof xr)&&i.cancel()}))}attachWorkDoneProgress(t){return t===void 0?new Bi:new Pn(this.connection,t)}createWorkDoneProgress(){if(this._progressSupported){let t=(0,gb.generateUuid)();return this.connection.sendRequest(en.WorkDoneProgressCreateRequest.type,{token:t}).then(()=>new vr(this.connection,t))}else return Promise.resolve(new xr)}};tn.ProgressFeature=bb;var bc;(function(e){e.type=new en.ProgressType})(bc||(bc={}));var Tc=class{constructor(t,n){this._connection=t,this._token=n}report(t){this._connection.sendProgress(bc.type,this._token,t)}};function Tb(e,t){if(t===void 0||t.partialResultToken===void 0)return;let n=t.partialResultToken;return delete t.partialResultToken,new Tc(e,n)}tn.attachPartialResult=Tb});var kp=L(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.ConfigurationFeature=void 0;var Sb=Se(),vb=Io(),xb=e=>class extends e{getConfiguration(t){return t?vb.string(t)?this._getConfiguration({section:t}):this._getConfiguration(t):this._getConfiguration({})}_getConfiguration(t){let n={items:Array.isArray(t)?t:[t]};return this.connection.sendRequest(Sb.ConfigurationRequest.type,n).then(i=>Array.isArray(i)?Array.isArray(t)?i:i[0]:Array.isArray(t)?[]:null)}};Nr.ConfigurationFeature=xb});var Rp=L(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.WorkspaceFoldersFeature=void 0;var kr=Se(),Nb=e=>class extends e{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(t){super.initialize(t);let n=t.workspace;n&&n.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new kr.Emitter,this.connection.onNotification(kr.DidChangeWorkspaceFoldersNotification.type,i=>{this._onDidChangeWorkspaceFolders.fire(i.event)}))}fillServerCapabilities(t){super.fillServerCapabilities(t);let n=t.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=n===!0||typeof n=="string"}getWorkspaceFolders(){return this.connection.sendRequest(kr.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(kr.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};Rr.WorkspaceFoldersFeature=Nb});var Pp=L(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.CallHierarchyFeature=void 0;var Sc=Se(),kb=e=>class extends e{get callHierarchy(){return{onPrepare:t=>this.connection.onRequest(Sc.CallHierarchyPrepareRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),void 0)),onIncomingCalls:t=>{let n=Sc.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onOutgoingCalls:t=>{let n=Sc.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};Pr.CallHierarchyFeature=kb});var xc=L(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.SemanticTokensBuilder=nn.SemanticTokensDiff=nn.SemanticTokensFeature=void 0;var Cr=Se(),Rb=e=>class extends e{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(Cr.SemanticTokensRefreshRequest.type),on:t=>{let n=Cr.SemanticTokensRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onDelta:t=>{let n=Cr.SemanticTokensDeltaRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onRange:t=>{let n=Cr.SemanticTokensRangeRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};nn.SemanticTokensFeature=Rb;var _r=class{constructor(t,n){this.originalSequence=t,this.modifiedSequence=n}computeDiff(){let t=this.originalSequence.length,n=this.modifiedSequence.length,i=0;for(;i<n&&i<t&&this.originalSequence[i]===this.modifiedSequence[i];)i++;if(i<n&&i<t){let o=t-1,r=n-1;for(;o>=i&&r>=i&&this.originalSequence[o]===this.modifiedSequence[r];)o--,r--;(o<i||r<i)&&(o++,r++);let s=o-i+1,u=this.modifiedSequence.slice(i,r+1);return u.length===1&&u[0]===this.originalSequence[o]?[{start:i,deleteCount:s-1}]:[{start:i,deleteCount:s,data:u}]}else return i<n?[{start:i,deleteCount:0,data:this.modifiedSequence.slice(i)}]:i<t?[{start:i,deleteCount:t-i}]:[]}};nn.SemanticTokensDiff=_r;var vc=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(t,n,i,o,r){let s=t,u=n;this._dataLen>0&&(s-=this._prevLine,s===0&&(u-=this._prevChar)),this._data[this._dataLen++]=s,this._data[this._dataLen++]=u,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._data[this._dataLen++]=r,this._prevLine=t,this._prevChar=n}get id(){return this._id.toString()}previousResult(t){this.id===t&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new _r(this._prevData,this._data).computeDiff()}:this.build()}};nn.SemanticTokensBuilder=vc});var Cp=L(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.ShowDocumentFeature=void 0;var Pb=Se(),Cb=e=>class extends e{showDocument(t){return this.connection.sendRequest(Pb.ShowDocumentRequest.type,t)}};Or.ShowDocumentFeature=Cb});var _p=L(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.FileOperationsFeature=void 0;var si=Se(),_b=e=>class extends e{onDidCreateFiles(t){return this.connection.onNotification(si.DidCreateFilesNotification.type,n=>{t(n)})}onDidRenameFiles(t){return this.connection.onNotification(si.DidRenameFilesNotification.type,n=>{t(n)})}onDidDeleteFiles(t){return this.connection.onNotification(si.DidDeleteFilesNotification.type,n=>{t(n)})}onWillCreateFiles(t){return this.connection.onRequest(si.WillCreateFilesRequest.type,(n,i)=>t(n,i))}onWillRenameFiles(t){return this.connection.onRequest(si.WillRenameFilesRequest.type,(n,i)=>t(n,i))}onWillDeleteFiles(t){return this.connection.onRequest(si.WillDeleteFilesRequest.type,(n,i)=>t(n,i))}};Dr.FileOperationsFeature=_b});var Op=L(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.LinkedEditingRangeFeature=void 0;var Ob=Se(),Db=e=>class extends e{onLinkedEditingRange(t){return this.connection.onRequest(Ob.LinkedEditingRangeRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),void 0))}};wr.LinkedEditingRangeFeature=Db});var Dp=L(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.TypeHierarchyFeature=void 0;var Nc=Se(),wb=e=>class extends e{get typeHierarchy(){return{onPrepare:t=>this.connection.onRequest(Nc.TypeHierarchyPrepareRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),void 0)),onSupertypes:t=>{let n=Nc.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onSubtypes:t=>{let n=Nc.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};Er.TypeHierarchyFeature=wb});var Ep=L(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.InlineValueFeature=void 0;var wp=Se(),Eb=e=>class extends e{get inlineValue(){return{refresh:()=>this.connection.sendRequest(wp.InlineValueRefreshRequest.type),on:t=>this.connection.onRequest(wp.InlineValueRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n)))}}};Lr.InlineValueFeature=Eb});var Ip=L(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.FoldingRangeFeature=void 0;var Lp=Se(),Lb=e=>class extends e{get foldingRange(){return{refresh:()=>this.connection.sendRequest(Lp.FoldingRangeRefreshRequest.type),on:t=>{let n=Lp.FoldingRangeRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};Ir.FoldingRangeFeature=Lb});var Fp=L(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.InlayHintFeature=void 0;var kc=Se(),Ib=e=>class extends e{get inlayHint(){return{refresh:()=>this.connection.sendRequest(kc.InlayHintRefreshRequest.type),on:t=>this.connection.onRequest(kc.InlayHintRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n))),resolve:t=>this.connection.onRequest(kc.InlayHintResolveRequest.type,(n,i)=>t(n,i))}}};Fr.InlayHintFeature=Ib});var Ap=L(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.DiagnosticFeature=void 0;var Wi=Se(),Fb=e=>class extends e{get diagnostics(){return{refresh:()=>this.connection.sendRequest(Wi.DiagnosticRefreshRequest.type),on:t=>this.connection.onRequest(Wi.DocumentDiagnosticRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(Wi.DocumentDiagnosticRequest.partialResult,n))),onWorkspace:t=>this.connection.onRequest(Wi.WorkspaceDiagnosticRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(Wi.WorkspaceDiagnosticRequest.partialResult,n)))}}};Ar.DiagnosticFeature=Fb});var Pc=L(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.TextDocuments=void 0;var Cn=Se(),Rc=class{constructor(t){this._configuration=t,this._syncedDocuments=new Map,this._onDidChangeContent=new Cn.Emitter,this._onDidOpen=new Cn.Emitter,this._onDidClose=new Cn.Emitter,this._onDidSave=new Cn.Emitter,this._onWillSave=new Cn.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(t){this._willSaveWaitUntil=t}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(t){return this._syncedDocuments.get(t)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(t){t.__textDocumentSync=Cn.TextDocumentSyncKind.Incremental;let n=[];return n.push(t.onDidOpenTextDocument(i=>{let o=i.textDocument,r=this._configuration.create(o.uri,o.languageId,o.version,o.text);this._syncedDocuments.set(o.uri,r);let s=Object.freeze({document:r});this._onDidOpen.fire(s),this._onDidChangeContent.fire(s)})),n.push(t.onDidChangeTextDocument(i=>{let o=i.textDocument,r=i.contentChanges;if(r.length===0)return;let{version:s}=o;if(s==null)throw new Error(`Received document change event for ${o.uri} without valid version identifier`);let u=this._syncedDocuments.get(o.uri);u!==void 0&&(u=this._configuration.update(u,r,s),this._syncedDocuments.set(o.uri,u),this._onDidChangeContent.fire(Object.freeze({document:u})))})),n.push(t.onDidCloseTextDocument(i=>{let o=this._syncedDocuments.get(i.textDocument.uri);o!==void 0&&(this._syncedDocuments.delete(i.textDocument.uri),this._onDidClose.fire(Object.freeze({document:o})))})),n.push(t.onWillSaveTextDocument(i=>{let o=this._syncedDocuments.get(i.textDocument.uri);o!==void 0&&this._onWillSave.fire(Object.freeze({document:o,reason:i.reason}))})),n.push(t.onWillSaveTextDocumentWaitUntil((i,o)=>{let r=this._syncedDocuments.get(i.textDocument.uri);return r!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:r,reason:i.reason}),o):[]})),n.push(t.onDidSaveTextDocument(i=>{let o=this._syncedDocuments.get(i.textDocument.uri);o!==void 0&&this._onDidSave.fire(Object.freeze({document:o}))})),Cn.Disposable.create(()=>{n.forEach(i=>i.dispose())})}};Mr.TextDocuments=Rc});var _c=L(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.NotebookDocuments=ai.NotebookSyncFeature=void 0;var rt=Se(),Mp=Pc(),Ab=e=>class extends e{get synchronization(){return{onDidOpenNotebookDocument:t=>this.connection.onNotification(rt.DidOpenNotebookDocumentNotification.type,n=>{t(n)}),onDidChangeNotebookDocument:t=>this.connection.onNotification(rt.DidChangeNotebookDocumentNotification.type,n=>{t(n)}),onDidSaveNotebookDocument:t=>this.connection.onNotification(rt.DidSaveNotebookDocumentNotification.type,n=>{t(n)}),onDidCloseNotebookDocument:t=>this.connection.onNotification(rt.DidCloseNotebookDocumentNotification.type,n=>{t(n)})}}};ai.NotebookSyncFeature=Ab;var qr=class e{onDidOpenTextDocument(t){return this.openHandler=t,rt.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(t){this.openHandler&&this.openHandler(t)}onDidChangeTextDocument(t){return this.changeHandler=t,rt.Disposable.create(()=>{this.changeHandler=t})}changeTextDocument(t){this.changeHandler&&this.changeHandler(t)}onDidCloseTextDocument(t){return this.closeHandler=t,rt.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(t){this.closeHandler&&this.closeHandler(t)}onWillSaveTextDocument(){return e.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return e.NULL_DISPOSE}onDidSaveTextDocument(){return e.NULL_DISPOSE}};qr.NULL_DISPOSE=Object.freeze({dispose:()=>{}});var Cc=class{constructor(t){t instanceof Mp.TextDocuments?this._cellTextDocuments=t:this._cellTextDocuments=new Mp.TextDocuments(t),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new rt.Emitter,this._onDidChange=new rt.Emitter,this._onDidSave=new rt.Emitter,this._onDidClose=new rt.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(t){return this._cellTextDocuments.get(t.document)}getNotebookDocument(t){return this.notebookDocuments.get(t)}getNotebookCell(t){let n=this.notebookCellMap.get(t);return n&&n[0]}findNotebookDocumentForCell(t){let n=typeof t=="string"?t:t.document,i=this.notebookCellMap.get(n);return i&&i[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(t){let n=new qr,i=[];return i.push(this.cellTextDocuments.listen(n)),i.push(t.notebooks.synchronization.onDidOpenNotebookDocument(o=>{this.notebookDocuments.set(o.notebookDocument.uri,o.notebookDocument);for(let r of o.cellTextDocuments)n.openTextDocument({textDocument:r});this.updateCellMap(o.notebookDocument),this._onDidOpen.fire(o.notebookDocument)})),i.push(t.notebooks.synchronization.onDidChangeNotebookDocument(o=>{let r=this.notebookDocuments.get(o.notebookDocument.uri);if(r===void 0)return;r.version=o.notebookDocument.version;let s=r.metadata,u=!1,f=o.change;f.metadata!==void 0&&(u=!0,r.metadata=f.metadata);let g=[],v=[],_=[],w=[];if(f.cells!==void 0){let Q=f.cells;if(Q.structure!==void 0){let S=Q.structure.array;if(r.cells.splice(S.start,S.deleteCount,...S.cells!==void 0?S.cells:[]),Q.structure.didOpen!==void 0)for(let T of Q.structure.didOpen)n.openTextDocument({textDocument:T}),g.push(T.uri);if(Q.structure.didClose)for(let T of Q.structure.didClose)n.closeTextDocument({textDocument:T}),v.push(T.uri)}if(Q.data!==void 0){let S=new Map(Q.data.map(T=>[T.document,T]));for(let T=0;T<=r.cells.length;T++){let C=S.get(r.cells[T].document);if(C!==void 0){let W=r.cells.splice(T,1,C);if(_.push({old:W[0],new:C}),S.delete(C.document),S.size===0)break}}}if(Q.textContent!==void 0)for(let S of Q.textContent)n.changeTextDocument({textDocument:S.document,contentChanges:S.changes}),w.push(S.document.uri)}this.updateCellMap(r);let ee={notebookDocument:r};u&&(ee.metadata={old:s,new:r.metadata});let De=[];for(let Q of g)De.push(this.getNotebookCell(Q));let ve=[];for(let Q of v)ve.push(this.getNotebookCell(Q));let Re=[];for(let Q of w)Re.push(this.getNotebookCell(Q));(De.length>0||ve.length>0||_.length>0||Re.length>0)&&(ee.cells={added:De,removed:ve,changed:{data:_,textContent:Re}}),(ee.metadata!==void 0||ee.cells!==void 0)&&this._onDidChange.fire(ee)})),i.push(t.notebooks.synchronization.onDidSaveNotebookDocument(o=>{let r=this.notebookDocuments.get(o.notebookDocument.uri);r!==void 0&&this._onDidSave.fire(r)})),i.push(t.notebooks.synchronization.onDidCloseNotebookDocument(o=>{let r=this.notebookDocuments.get(o.notebookDocument.uri);if(r!==void 0){this._onDidClose.fire(r);for(let s of o.cellTextDocuments)n.closeTextDocument({textDocument:s});this.notebookDocuments.delete(o.notebookDocument.uri);for(let s of r.cells)this.notebookCellMap.delete(s.document)}})),rt.Disposable.create(()=>{i.forEach(o=>o.dispose())})}updateCellMap(t){for(let n of t.cells)this.notebookCellMap.set(n.document,[n,t])}};ai.NotebookDocuments=Cc});var qp=L(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.MonikerFeature=void 0;var Mb=Se(),qb=e=>class extends e{get moniker(){return{on:t=>{let n=Mb.MonikerRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};jr.MonikerFeature=qb});var Ic=L(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.createConnection=K.combineFeatures=K.combineNotebooksFeatures=K.combineLanguagesFeatures=K.combineWorkspaceFeatures=K.combineWindowFeatures=K.combineClientFeatures=K.combineTracerFeatures=K.combineTelemetryFeatures=K.combineConsoleFeatures=K._NotebooksImpl=K._LanguagesImpl=K.BulkUnregistration=K.BulkRegistration=K.ErrorMessageTracker=void 0;var E=Se(),st=Io(),Dc=yc(),q=Np(),jb=kp(),Bb=Rp(),Wb=Pp(),Hb=xc(),Vb=Cp(),$b=_p(),zb=Op(),Ub=Dp(),Gb=Ep(),Kb=Ip(),Qb=Fp(),Jb=Ap(),Xb=_c(),Yb=qp();function Oc(e){if(e!==null)return e}var wc=class{constructor(){this._messages=Object.create(null)}add(t){let n=this._messages[t];n||(n=0),n++,this._messages[t]=n}sendErrors(t){Object.keys(this._messages).forEach(n=>{t.window.showErrorMessage(n)})}};K.ErrorMessageTracker=wc;var Br=class{constructor(){}rawAttach(t){this._rawConnection=t}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(t){}initialize(t){}error(t){this.send(E.MessageType.Error,t)}warn(t){this.send(E.MessageType.Warning,t)}info(t){this.send(E.MessageType.Info,t)}log(t){this.send(E.MessageType.Log,t)}debug(t){this.send(E.MessageType.Debug,t)}send(t,n){this._rawConnection&&this._rawConnection.sendNotification(E.LogMessageNotification.type,{type:t,message:n}).catch(()=>{(0,E.RAL)().console.error("Sending log message failed")})}},Ec=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}showErrorMessage(t,...n){let i={type:E.MessageType.Error,message:t,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,i).then(Oc)}showWarningMessage(t,...n){let i={type:E.MessageType.Warning,message:t,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,i).then(Oc)}showInformationMessage(t,...n){let i={type:E.MessageType.Info,message:t,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,i).then(Oc)}},jp=(0,Vb.ShowDocumentFeature)((0,q.ProgressFeature)(Ec)),Bp;(function(e){function t(){return new Wr}e.create=t})(Bp||(K.BulkRegistration=Bp={}));var Wr=class{constructor(){this._registrations=[],this._registered=new Set}add(t,n){let i=st.string(t)?t:t.method;if(this._registered.has(i))throw new Error(`${i} is already added to this registration`);let o=Dc.generateUuid();this._registrations.push({id:o,method:i,registerOptions:n||{}}),this._registered.add(i)}asRegistrationParams(){return{registrations:this._registrations}}},Wp;(function(e){function t(){return new Hi(void 0,[])}e.create=t})(Wp||(K.BulkUnregistration=Wp={}));var Hi=class{constructor(t,n){this._connection=t,this._unregistrations=new Map,n.forEach(i=>{this._unregistrations.set(i.method,i)})}get isAttached(){return!!this._connection}attach(t){this._connection=t}add(t){this._unregistrations.set(t.method,t)}dispose(){let t=[];for(let i of this._unregistrations.values())t.push(i);let n={unregisterations:t};this._connection.sendRequest(E.UnregistrationRequest.type,n).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(t){let n=st.string(t)?t:t.method,i=this._unregistrations.get(n);if(!i)return!1;let o={unregisterations:[i]};return this._connection.sendRequest(E.UnregistrationRequest.type,o).then(()=>{this._unregistrations.delete(n)},r=>{this._connection.console.info(`Un-registering request handler for ${i.id} failed.`)}),!0}},Hr=class{attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}register(t,n,i){return t instanceof Wr?this.registerMany(t):t instanceof Hi?this.registerSingle1(t,n,i):this.registerSingle2(t,n)}registerSingle1(t,n,i){let o=st.string(n)?n:n.method,r=Dc.generateUuid(),s={registrations:[{id:r,method:o,registerOptions:i||{}}]};return t.isAttached||t.attach(this.connection),this.connection.sendRequest(E.RegistrationRequest.type,s).then(u=>(t.add({id:r,method:o}),t),u=>(this.connection.console.info(`Registering request handler for ${o} failed.`),Promise.reject(u)))}registerSingle2(t,n){let i=st.string(t)?t:t.method,o=Dc.generateUuid(),r={registrations:[{id:o,method:i,registerOptions:n||{}}]};return this.connection.sendRequest(E.RegistrationRequest.type,r).then(s=>E.Disposable.create(()=>{this.unregisterSingle(o,i).catch(()=>{this.connection.console.info(`Un-registering capability with id ${o} failed.`)})}),s=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(s)))}unregisterSingle(t,n){let i={unregisterations:[{id:t,method:n}]};return this.connection.sendRequest(E.UnregistrationRequest.type,i).catch(()=>{this.connection.console.info(`Un-registering request handler for ${t} failed.`)})}registerMany(t){let n=t.asRegistrationParams();return this.connection.sendRequest(E.RegistrationRequest.type,n).then(()=>new Hi(this._connection,n.registrations.map(i=>({id:i.id,method:i.method}))),i=>(this.connection.console.info("Bulk registration failed."),Promise.reject(i)))}},Lc=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}applyEdit(t){function n(o){return o&&!!o.edit}let i=n(t)?t:{edit:t};return this.connection.sendRequest(E.ApplyWorkspaceEditRequest.type,i)}},Hp=(0,$b.FileOperationsFeature)((0,Bb.WorkspaceFoldersFeature)((0,jb.ConfigurationFeature)(Lc))),Vr=class{constructor(){this._trace=E.Trace.Off}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}set trace(t){this._trace=t}log(t,n){this._trace!==E.Trace.Off&&this.connection.sendNotification(E.LogTraceNotification.type,{message:t,verbose:this._trace===E.Trace.Verbose?n:void 0}).catch(()=>{})}},$r=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}logEvent(t){this.connection.sendNotification(E.TelemetryEventNotification.type,t).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},zr=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,q.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,n){return(0,q.attachPartialResult)(this.connection,n)}};K._LanguagesImpl=zr;var Vp=(0,Kb.FoldingRangeFeature)((0,Yb.MonikerFeature)((0,Jb.DiagnosticFeature)((0,Qb.InlayHintFeature)((0,Gb.InlineValueFeature)((0,Ub.TypeHierarchyFeature)((0,zb.LinkedEditingRangeFeature)((0,Hb.SemanticTokensFeature)((0,Wb.CallHierarchyFeature)(zr))))))))),Ur=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,q.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,n){return(0,q.attachPartialResult)(this.connection,n)}};K._NotebooksImpl=Ur;var $p=(0,Xb.NotebookSyncFeature)(Ur);function zp(e,t){return function(n){return t(e(n))}}K.combineConsoleFeatures=zp;function Up(e,t){return function(n){return t(e(n))}}K.combineTelemetryFeatures=Up;function Gp(e,t){return function(n){return t(e(n))}}K.combineTracerFeatures=Gp;function Kp(e,t){return function(n){return t(e(n))}}K.combineClientFeatures=Kp;function Qp(e,t){return function(n){return t(e(n))}}K.combineWindowFeatures=Qp;function Jp(e,t){return function(n){return t(e(n))}}K.combineWorkspaceFeatures=Jp;function Xp(e,t){return function(n){return t(e(n))}}K.combineLanguagesFeatures=Xp;function Yp(e,t){return function(n){return t(e(n))}}K.combineNotebooksFeatures=Yp;function Zb(e,t){function n(o,r,s){return o&&r?s(o,r):o||r}return{__brand:"features",console:n(e.console,t.console,zp),tracer:n(e.tracer,t.tracer,Gp),telemetry:n(e.telemetry,t.telemetry,Up),client:n(e.client,t.client,Kp),window:n(e.window,t.window,Qp),workspace:n(e.workspace,t.workspace,Jp),languages:n(e.languages,t.languages,Xp),notebooks:n(e.notebooks,t.notebooks,Yp)}}K.combineFeatures=Zb;function eT(e,t,n){let i=n&&n.console?new(n.console(Br)):new Br,o=e(i);i.rawAttach(o);let r=n&&n.tracer?new(n.tracer(Vr)):new Vr,s=n&&n.telemetry?new(n.telemetry($r)):new $r,u=n&&n.client?new(n.client(Hr)):new Hr,f=n&&n.window?new(n.window(jp)):new jp,g=n&&n.workspace?new(n.workspace(Hp)):new Hp,v=n&&n.languages?new(n.languages(Vp)):new Vp,_=n&&n.notebooks?new(n.notebooks($p)):new $p,w=[i,r,s,u,f,g,v,_];function ee(S){return S instanceof Promise?S:st.thenable(S)?new Promise((T,C)=>{S.then(W=>T(W),W=>C(W))}):Promise.resolve(S)}let De,ve,Re,Q={listen:()=>o.listen(),sendRequest:(S,...T)=>o.sendRequest(st.string(S)?S:S.method,...T),onRequest:(S,T)=>o.onRequest(S,T),sendNotification:(S,T)=>{let C=st.string(S)?S:S.method;return o.sendNotification(C,T)},onNotification:(S,T)=>o.onNotification(S,T),onProgress:o.onProgress,sendProgress:o.sendProgress,onInitialize:S=>(ve=S,{dispose:()=>{ve=void 0}}),onInitialized:S=>o.onNotification(E.InitializedNotification.type,S),onShutdown:S=>(De=S,{dispose:()=>{De=void 0}}),onExit:S=>(Re=S,{dispose:()=>{Re=void 0}}),get console(){return i},get telemetry(){return s},get tracer(){return r},get client(){return u},get window(){return f},get workspace(){return g},get languages(){return v},get notebooks(){return _},onDidChangeConfiguration:S=>o.onNotification(E.DidChangeConfigurationNotification.type,S),onDidChangeWatchedFiles:S=>o.onNotification(E.DidChangeWatchedFilesNotification.type,S),__textDocumentSync:void 0,onDidOpenTextDocument:S=>o.onNotification(E.DidOpenTextDocumentNotification.type,S),onDidChangeTextDocument:S=>o.onNotification(E.DidChangeTextDocumentNotification.type,S),onDidCloseTextDocument:S=>o.onNotification(E.DidCloseTextDocumentNotification.type,S),onWillSaveTextDocument:S=>o.onNotification(E.WillSaveTextDocumentNotification.type,S),onWillSaveTextDocumentWaitUntil:S=>o.onRequest(E.WillSaveTextDocumentWaitUntilRequest.type,S),onDidSaveTextDocument:S=>o.onNotification(E.DidSaveTextDocumentNotification.type,S),sendDiagnostics:S=>o.sendNotification(E.PublishDiagnosticsNotification.type,S),onHover:S=>o.onRequest(E.HoverRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),void 0)),onCompletion:S=>o.onRequest(E.CompletionRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onCompletionResolve:S=>o.onRequest(E.CompletionResolveRequest.type,S),onSignatureHelp:S=>o.onRequest(E.SignatureHelpRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),void 0)),onDeclaration:S=>o.onRequest(E.DeclarationRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onDefinition:S=>o.onRequest(E.DefinitionRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onTypeDefinition:S=>o.onRequest(E.TypeDefinitionRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onImplementation:S=>o.onRequest(E.ImplementationRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onReferences:S=>o.onRequest(E.ReferencesRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onDocumentHighlight:S=>o.onRequest(E.DocumentHighlightRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onDocumentSymbol:S=>o.onRequest(E.DocumentSymbolRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onWorkspaceSymbol:S=>o.onRequest(E.WorkspaceSymbolRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onWorkspaceSymbolResolve:S=>o.onRequest(E.WorkspaceSymbolResolveRequest.type,S),onCodeAction:S=>o.onRequest(E.CodeActionRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onCodeActionResolve:S=>o.onRequest(E.CodeActionResolveRequest.type,(T,C)=>S(T,C)),onCodeLens:S=>o.onRequest(E.CodeLensRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onCodeLensResolve:S=>o.onRequest(E.CodeLensResolveRequest.type,(T,C)=>S(T,C)),onDocumentFormatting:S=>o.onRequest(E.DocumentFormattingRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),void 0)),onDocumentRangeFormatting:S=>o.onRequest(E.DocumentRangeFormattingRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),void 0)),onDocumentOnTypeFormatting:S=>o.onRequest(E.DocumentOnTypeFormattingRequest.type,(T,C)=>S(T,C)),onRenameRequest:S=>o.onRequest(E.RenameRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),void 0)),onPrepareRename:S=>o.onRequest(E.PrepareRenameRequest.type,(T,C)=>S(T,C)),onDocumentLinks:S=>o.onRequest(E.DocumentLinkRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onDocumentLinkResolve:S=>o.onRequest(E.DocumentLinkResolveRequest.type,(T,C)=>S(T,C)),onDocumentColor:S=>o.onRequest(E.DocumentColorRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onColorPresentation:S=>o.onRequest(E.ColorPresentationRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onFoldingRanges:S=>o.onRequest(E.FoldingRangeRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onSelectionRanges:S=>o.onRequest(E.SelectionRangeRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),(0,q.attachPartialResult)(o,T))),onExecuteCommand:S=>o.onRequest(E.ExecuteCommandRequest.type,(T,C)=>S(T,C,(0,q.attachWorkDone)(o,T),void 0)),dispose:()=>o.dispose()};for(let S of w)S.attach(Q);return o.onRequest(E.InitializeRequest.type,S=>{t.initialize(S),st.string(S.trace)&&(r.trace=E.Trace.fromString(S.trace));for(let T of w)T.initialize(S.capabilities);if(ve){let T=ve(S,new E.CancellationTokenSource().token,(0,q.attachWorkDone)(o,S),void 0);return ee(T).then(C=>{if(C instanceof E.ResponseError)return C;let W=C;W||(W={capabilities:{}});let re=W.capabilities;re||(re={},W.capabilities=re),re.textDocumentSync===void 0||re.textDocumentSync===null?re.textDocumentSync=st.number(Q.__textDocumentSync)?Q.__textDocumentSync:E.TextDocumentSyncKind.None:!st.number(re.textDocumentSync)&&!st.number(re.textDocumentSync.change)&&(re.textDocumentSync.change=st.number(Q.__textDocumentSync)?Q.__textDocumentSync:E.TextDocumentSyncKind.None);for(let ge of w)ge.fillServerCapabilities(re);return W})}else{let T={capabilities:{textDocumentSync:E.TextDocumentSyncKind.None}};for(let C of w)C.fillServerCapabilities(T.capabilities);return T}}),o.onRequest(E.ShutdownRequest.type,()=>{if(t.shutdownReceived=!0,De)return De(new E.CancellationTokenSource().token)}),o.onNotification(E.ExitNotification.type,()=>{try{Re&&Re()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}}),o.onNotification(E.SetTraceNotification.type,S=>{r.trace=E.Trace.fromString(S.value)}),Q}K.createConnection=eT});var Zp=L(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.resolveModulePath=Ue.FileSystem=Ue.resolveGlobalYarnPath=Ue.resolveGlobalNodePath=Ue.resolve=Ue.uriToFilePath=void 0;var tT=require("url"),bt=require("path"),Fc=require("fs"),jc=require("child_process");function nT(e){let t=tT.parse(e);if(t.protocol!=="file:"||!t.path)return;let n=t.path.split("/");for(var i=0,o=n.length;i<o;i++)n[i]=decodeURIComponent(n[i]);if(process.platform==="win32"&&n.length>1){let r=n[0],s=n[1];r.length===0&&s.length>1&&s[1]===":"&&n.shift()}return bt.normalize(n.join("/"))}Ue.uriToFilePath=nT;function Ac(){return process.platform==="win32"}function Gr(e,t,n,i){let o="NODE_PATH",r=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((s,u)=>{let f=process.env,g=Object.create(null);Object.keys(f).forEach(v=>g[v]=f[v]),t&&Fc.existsSync(t)&&(g[o]?g[o]=t+bt.delimiter+g[o]:g[o]=t,i&&i(`NODE_PATH value is: ${g[o]}`)),g.ELECTRON_RUN_AS_NODE="1";try{let v=(0,jc.fork)("",[],{cwd:n,env:g,execArgv:["-e",r]});if(v.pid===void 0){u(new Error(`Starting process to resolve node module  ${e} failed`));return}v.on("error",w=>{u(w)}),v.on("message",w=>{w.c==="r"&&(v.send({c:"e"}),w.s?s(w.r):u(new Error(`Failed to resolve module: ${e}`)))});let _={c:"rs",a:e};v.send(_)}catch(v){u(v)}})}Ue.resolve=Gr;function Mc(e){let t="npm",n=Object.create(null);Object.keys(process.env).forEach(r=>n[r]=process.env[r]),n.NO_UPDATE_NOTIFIER="true";let i={encoding:"utf8",env:n};Ac()&&(t="npm.cmd",i.shell=!0);let o=()=>{};try{process.on("SIGPIPE",o);let r=(0,jc.spawnSync)(t,["config","get","prefix"],i).stdout;if(!r){e&&e("'npm config get prefix' didn't return a value.");return}let s=r.trim();return e&&e(`'npm config get prefix' value is: ${s}`),s.length>0?Ac()?bt.join(s,"node_modules"):bt.join(s,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",o)}}Ue.resolveGlobalNodePath=Mc;function iT(e){let t="yarn",n={encoding:"utf8"};Ac()&&(t="yarn.cmd",n.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let o=(0,jc.spawnSync)(t,["global","dir","--json"],n),r=o.stdout;if(!r){e&&(e("'yarn global dir' didn't return a value."),o.stderr&&e(o.stderr));return}let s=r.trim().split(/\r?\n/);for(let u of s)try{let f=JSON.parse(u);if(f.type==="log")return bt.join(f.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",i)}}Ue.resolveGlobalYarnPath=iT;var qc;(function(e){let t;function n(){return t!==void 0||(process.platform==="win32"?t=!1:t=!Fc.existsSync(__filename.toUpperCase())||!Fc.existsSync(__filename.toLowerCase())),t}e.isCaseSensitive=n;function i(o,r){return n()?bt.normalize(r).indexOf(bt.normalize(o))===0:bt.normalize(r).toLowerCase().indexOf(bt.normalize(o).toLowerCase())===0}e.isParent=i})(qc||(Ue.FileSystem=qc={}));function oT(e,t,n,i){return n?(bt.isAbsolute(n)||(n=bt.join(e,n)),Gr(t,n,n,i).then(o=>qc.isParent(n,o)?o:Promise.reject(new Error(`Failed to load ${t} from node path location.`))).then(void 0,o=>Gr(t,Mc(i),e,i))):Gr(t,Mc(i),e,i)}Ue.resolveModulePath=oT});var Bc=L((vR,em)=>{"use strict";em.exports=Se()});var tm=L(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.InlineCompletionFeature=void 0;var rT=Se(),sT=e=>class extends e{get inlineCompletion(){return{on:t=>this.connection.onRequest(rT.InlineCompletionRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n)))}}};Kr.InlineCompletionFeature=sT});var om=L(Me=>{"use strict";var aT=Me&&Me.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),im=Me&&Me.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&aT(t,e,n)};Object.defineProperty(Me,"__esModule",{value:!0});Me.ProposedFeatures=Me.NotebookDocuments=Me.TextDocuments=Me.SemanticTokensBuilder=void 0;var cT=xc();Object.defineProperty(Me,"SemanticTokensBuilder",{enumerable:!0,get:function(){return cT.SemanticTokensBuilder}});var uT=tm();im(Se(),Me);var dT=Pc();Object.defineProperty(Me,"TextDocuments",{enumerable:!0,get:function(){return dT.TextDocuments}});var lT=_c();Object.defineProperty(Me,"NotebookDocuments",{enumerable:!0,get:function(){return lT.NotebookDocuments}});im(Ic(),Me);var nm;(function(e){e.all={__brand:"features",languages:uT.InlineCompletionFeature}})(nm||(Me.ProposedFeatures=nm={}))});var on=L(at=>{"use strict";var fT=at&&at.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),cm=at&&at.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&fT(t,e,n)};Object.defineProperty(at,"__esModule",{value:!0});at.createConnection=at.Files=void 0;var rm=require("node:util"),Wc=Io(),pT=Ic(),Vi=Zp(),_n=Bc();cm(Bc(),at);cm(om(),at);var sm;(function(e){e.uriToFilePath=Vi.uriToFilePath,e.resolveGlobalNodePath=Vi.resolveGlobalNodePath,e.resolveGlobalYarnPath=Vi.resolveGlobalYarnPath,e.resolve=Vi.resolve,e.resolveModulePath=Vi.resolveModulePath})(sm||(at.Files=sm={}));var am;function Qr(){if(am!==void 0)try{am.end()}catch{}}var ci=!1,um;function mT(){let e="--clientProcessId";function t(n){try{let i=parseInt(n);isNaN(i)||(um=setInterval(()=>{try{process.kill(i,0)}catch{Qr(),process.exit(ci?0:1)}},3e3))}catch{}}for(let n=2;n<process.argv.length;n++){let i=process.argv[n];if(i===e&&n+1<process.argv.length){t(process.argv[n+1]);return}else{let o=i.split("=");o[0]===e&&t(o[1])}}}mT();var hT={initialize:e=>{let t=e.processId;Wc.number(t)&&um===void 0&&setInterval(()=>{try{process.kill(t,0)}catch{process.exit(ci?0:1)}},3e3)},get shutdownReceived(){return ci},set shutdownReceived(e){ci=e},exit:e=>{Qr(),process.exit(e)}};function gT(e,t,n,i){let o,r,s,u;return e!==void 0&&e.__brand==="features"&&(o=e,e=t,t=n,n=i),_n.ConnectionStrategy.is(e)||_n.ConnectionOptions.is(e)?u=e:(r=e,s=t,u=n),yT(r,s,u,o)}at.createConnection=gT;function yT(e,t,n,i){let o=!1;if(!e&&!t&&process.argv.length>2){let f,g,v=process.argv.slice(2);for(let _=0;_<v.length;_++){let w=v[_];if(w==="--node-ipc"){e=new _n.IPCMessageReader(process),t=new _n.IPCMessageWriter(process);break}else if(w==="--stdio"){o=!0,e=process.stdin,t=process.stdout;break}else if(w==="--socket"){f=parseInt(v[_+1]);break}else if(w==="--pipe"){g=v[_+1];break}else{var r=w.split("=");if(r[0]==="--socket"){f=parseInt(r[1]);break}else if(r[0]==="--pipe"){g=r[1];break}}}if(f){let _=(0,_n.createServerSocketTransport)(f);e=_[0],t=_[1]}else if(g){let _=(0,_n.createServerPipeTransport)(g);e=_[0],t=_[1]}}var s="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+s);if(!t)throw new Error("Connection output stream is not set. "+s);if(Wc.func(e.read)&&Wc.func(e.on)){let f=e;f.on("end",()=>{Qr(),process.exit(ci?0:1)}),f.on("close",()=>{Qr(),process.exit(ci?0:1)})}let u=f=>{let g=(0,_n.createProtocolConnection)(e,t,f,n);return o&&bT(f),g};return(0,pT.createConnection)(u,hT,i)}function bT(e){function t(i){return i.map(o=>typeof o=="string"?o:(0,rm.inspect)(o)).join(" ")}let n=new Map;console.assert=function(o,...r){if(!o)if(r.length===0)e.error("Assertion failed");else{let[s,...u]=r;e.error(`Assertion failed: ${s} ${t(u)}`)}},console.count=function(o="default"){let r=String(o),s=n.get(r)??0;s+=1,n.set(r,s),e.log(`${r}: ${r}`)},console.countReset=function(o){o===void 0?n.clear():n.delete(String(o))},console.debug=function(...o){e.log(t(o))},console.dir=function(o,r){e.log((0,rm.inspect)(o,r))},console.log=function(...o){e.log(t(o))},console.error=function(...o){e.error(t(o))},console.trace=function(...o){let r=new Error().stack.replace(/(.+\n){2}/,""),s="Trace";o.length!==0&&(s+=`: ${t(o)}`),e.log(`${s}
${r}`)},console.warn=function(...o){e.warn(t(o))}}});var Mt=L((PR,dm)=>{"use strict";dm.exports=on()});var gn=ue(Mt());var Jr=class e{constructor(t,n,i,o){this._uri=t,this._languageId=n,this._version=i,this._content=o,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let n=this.offsetAt(t.start),i=this.offsetAt(t.end);return this._content.substring(n,i)}return this._content}update(t,n){for(let i of t)if(e.isIncremental(i)){let o=fm(i.range),r=this.offsetAt(o.start),s=this.offsetAt(o.end);this._content=this._content.substring(0,r)+i.text+this._content.substring(s,this._content.length);let u=Math.max(o.start.line,0),f=Math.max(o.end.line,0),g=this._lineOffsets,v=lm(i.text,!1,r);if(f-u===v.length)for(let w=0,ee=v.length;w<ee;w++)g[w+u+1]=v[w];else v.length<1e4?g.splice(u+1,f-u,...v):this._lineOffsets=g=g.slice(0,u+1).concat(v,g.slice(f+1));let _=i.text.length-(s-r);if(_!==0)for(let w=u+1+v.length,ee=g.length;w<ee;w++)g[w]=g[w]+_}else if(e.isFull(i))this._content=i.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=lm(this._content,!0)),this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let n=this.getLineOffsets(),i=0,o=n.length;if(o===0)return{line:0,character:t};for(;i<o;){let s=Math.floor((i+o)/2);n[s]>t?o=s:i=s+1}let r=i-1;return{line:r,character:t-n[r]}}offsetAt(t){let n=this.getLineOffsets();if(t.line>=n.length)return this._content.length;if(t.line<0)return 0;let i=n[t.line],o=t.line+1<n.length?n[t.line+1]:this._content.length;return Math.max(Math.min(i+t.character,o),i)}get lineCount(){return this.getLineOffsets().length}static isIncremental(t){let n=t;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||typeof n.rangeLength=="number")}static isFull(t){let n=t;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}},$i;(function(e){function t(o,r,s,u){return new Jr(o,r,s,u)}e.create=t;function n(o,r,s){if(o instanceof Jr)return o.update(r,s),o;throw new Error("TextDocument.update: document must be created by TextDocument.create")}e.update=n;function i(o,r){let s=o.getText(),u=Hc(r.map(TT),(v,_)=>{let w=v.range.start.line-_.range.start.line;return w===0?v.range.start.character-_.range.start.character:w}),f=0,g=[];for(let v of u){let _=o.offsetAt(v.range.start);if(_<f)throw new Error("Overlapping edit");_>f&&g.push(s.substring(f,_)),v.newText.length&&g.push(v.newText),f=o.offsetAt(v.range.end)}return g.push(s.substr(f)),g.join("")}e.applyEdits=i})($i||($i={}));function Hc(e,t){if(e.length<=1)return e;let n=e.length/2|0,i=e.slice(0,n),o=e.slice(n);Hc(i,t),Hc(o,t);let r=0,s=0,u=0;for(;r<i.length&&s<o.length;)t(i[r],o[s])<=0?e[u++]=i[r++]:e[u++]=o[s++];for(;r<i.length;)e[u++]=i[r++];for(;s<o.length;)e[u++]=o[s++];return e}function lm(e,t,n=0){let i=t?[n]:[];for(let o=0;o<e.length;o++){let r=e.charCodeAt(o);(r===13||r===10)&&(r===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}function fm(e){let t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function TT(e){let t=fm(e.range);return t!==e.range?{newText:e.newText,range:t}:e}var pm=["","namespace","class","enum","interface","struct","typeParameter","type","parameter","variable","property","enumMember","decorator","event","function","method","macro","label","comment","string","keyword","number","regexp","operator","builtin","directive"];var mm=["declaration","definition","readonly","static","deprecated","abstract","async","modification","documentation","defaultLibrary",""];var qt=Symbol(),Xr=Symbol();function hm(e){return e===Xr}function rn(e){return e!==qt&&e!==Xr}function gm(e){return e!==void 0&&"nodeName"in e}var sn=require("node:assert");function ym(e){return e===void 0?!1:e.nodeName==="Enum"||e.nodeName==="Class"||e.nodeName==="Interface"}function ui(e){return e===void 0?!1:e.nodeName==="Class"||e.nodeName==="Interface"}function vT(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var zi=class{isType(){return this.kind==="Type"}isVariable(){return this.kind==="Variable"}isFunction(){return this.kind==="Function"}equals(t){return this.identifierText===t.identifierText&&vT(this.scopePath,t.scopePath)}},Pe=class e extends zi{constructor(n,i,o,r,s,u,f,g,v){super();this.identifierToken=n;this.scopePath=i;this.linkedNode=o;this._membersScopePath=r;this.isTypeParameter=s;this._templateTypes=u;this._baseList=f;this.isHandler=g;this.multipleEnumCandidates=v;this.multipleEnumCandidates!==void 0&&sn(this.multipleEnumCandidates.length>1)}get kind(){return"Type"}static create(n){return new e(n.identifierToken,n.scopePath,n.linkedNode,n.membersScopePath,n.isTypeParameter,n.templateTypes,n.baseList,n.isHandler,n.multipleEnumCandidates)}get membersScopePath(){return this._membersScopePath}assignMembersScopePath(n){sn(this._membersScopePath===void 0),this._membersScopePath=n}get templateTypes(){return this._templateTypes}assignTemplateTypes(n){sn(this._templateTypes===void 0),this._templateTypes=n}get baseList(){return this._baseList??[]}assignBaseList(n){sn(this._baseList===void 0),this._baseList=n}get identifierText(){return this.identifierToken.text}toHolder(){return this}isPrimitiveType(){return this.linkedNode===void 0}isNumberType(){return this.identifierToken.isReservedToken()&&this.identifierToken.property.isNumber}isEnumType(){return this.linkedNode?.nodeName==="Enum"}isPrimitiveOrEnum(){return this.isPrimitiveType()||this.isEnumType()}isFunctionHolder(){return!1}toList(){return[this]}},Oe=class e extends zi{constructor(n,i,o,r,s,u){super();this.identifierToken=n;this.scopePath=i;this.type=o;this.isInstanceMember=r;this.accessRestriction=s;this.isVirtualProperty=u}get kind(){return"Variable"}static create(n){return new e(n.identifierToken,n.scopePath,n.type,n.isInstanceMember,n.accessRestriction,n.isVirtualProperty)}get identifierText(){return this.identifierToken.text}toHolder(){return this}isFunctionHolder(){return!1}toList(){return[this]}},an=class e extends zi{constructor(n,i,o,r,s,u,f,g,v){super();this.identifierToken=n;this.scopePath=i;this.linkedNode=o;this.functionScopePath=r;this._returnType=s;this._parameterTypes=u;this.isInstanceMember=f;this.accessRestriction=g;this._templateTypes=v}get kind(){return"Function"}static create(n){return new e(n.identifierToken,n.scopePath,n.linkedNode,n.functionScopePath,n.returnType,n.parameterTypes,n.isInstanceMember,n.accessRestriction)}clone(n){let i=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return n?.identifierToken!==void 0&&(i.identifierToken=n.identifierToken),n?.accessRestriction!==void 0&&(i.accessRestriction=n.accessRestriction),i}get returnType(){return this._returnType}assignReturnType(n){sn(this._returnType===void 0),this._returnType=n}get parameterTypes(){return this._parameterTypes}assignParameterTypes(n){sn(this._parameterTypes.length===0),this._parameterTypes=n}get templateTypes(){return this._templateTypes}assignTemplateTypes(n){sn(this._templateTypes===void 0),this._templateTypes=n}get identifierText(){return this.identifierToken.text}get actualIdentifierToken(){return this.linkedNode.identifier}toHolder(){return new Ui(this)}},Ui=class{constructor(t){this._overloadList=[];Array.isArray(t)?(sn(t.length>0),this._overloadList=t):this._overloadList.push(t)}pushOverload(t){this._overloadList.push(t)}get overloadList(){return this._overloadList}get count(){return this._overloadList.length}get first(){return this._overloadList[0]}get identifierText(){return this.first.identifierToken.text}isVariable(){return!1}isType(){return!1}isFunctionHolder(){return!0}toList(){return this._overloadList}};function Vc(e){return(e.isFunctionHolder()||e.isVariable())===!1?!1:e.toList()[0].isInstanceMember}var bm=ue(on()),me=class e{constructor(t,n){this.line=t;this.character=n}static create(t){return new e(t.line,t.character)}clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}equals(t){return this.line===t.line&&this.character===t.character}isSameLine(t){return this.line===t.line}isLessThan(t){return this.line<t.line?!0:this.line===t.line&&this.character<t.character}compareNearest(t,n){let i=Math.abs(t.line-this.line),o=Math.abs(n.line-this.line);if(i<o)return-1;if(i>o)return 1;let r=Math.abs(t.character-this.character),s=Math.abs(n.character-this.character);return r<s?-1:r>s?1:0}simpleFormat(){return`${this.line}:${this.character}`}movedBy(t,n){let i=this.line+t;i<0&&(i=0);let o=this.character+n;return o<0&&(o=0),new e(i,o)}},Rt=class e{constructor(t,n){this.line_=t;this.character_=n}static create(t){return new e(t.line,t.character)}freeze(){return new me(this.line_,this.character_)}},jt=class e{constructor(t,n){this.start=t;this.end=n}static create(t){return new e(me.create(t.start),me.create(t.end))}positionInRange(t){return!(t.line<this.start.line||t.line>this.end.line||t.line===this.start.line&&t.character<this.start.character||t.line===this.end.line&&t.character>this.end.character)}contains(t){return this.positionInRange(t.start)&&this.positionInRange(t.end)}intersects(t){return!(this.end.isLessThan(t.start)||t.end.isLessThan(this.start))}clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}getDifference(){return{line:this.end.line-this.start.line,character:this.end.character-this.start.character}}},Yr=class e{constructor(t,n){this.start=t;this.end=n}static create(t){return new e(Rt.create(t.start),Rt.create(t.end))}freeze(){return new jt(this.start.freeze(),this.end.freeze())}},qe=class e extends jt{constructor(n,i,o){super(i,o);this.path=n}static createEmpty(){return new e("",new me(0,0),new me(0,0))}clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}equals(n){return this.path===n.path&&this.start.equals(n.start)&&this.end.equals(n.end)}toServerLocation(){return bm.Location.create(this.path,this)}withEnd(n){return new e(this.path,this.start,n)}simpleFormat(){return`${this.path.match(/[^\\/]+[/\\][^\\/]+$/)??this.path}:${this.start.simpleFormat()}-${this.end.simpleFormat()}`}};function $c(e,t){return Sm(e,t)}function Zr(e,t,n){return $c(e,n)?.identifierToken??xT(e,t,n)}function Sm(e,t){let n=e.getContext().filepath;for(let i of e.info.reference)if(i.fromToken.location.positionInRange(t))return i.toSymbol;return vm(n,e,t)}function vm(e,t,n){for(let[i,o]of t.symbolTable)for(let r of o.toList()){let s=r.identifierToken.location;if(s.path===e&&s.positionInRange(n))return r}for(let[i,o]of t.childScopeTable){let r=vm(e,o,n);if(r!==void 0)return r}}function xT(e,t,n){let i=xm(e,n);if(i!==void 0)return i;let{accessScope:o,tokenOnCaret:r,tokenAfterNamespace:s}=NT(e,n);if(o===void 0||r===void 0)return;let u=s===void 0?void 0:Sm(e,s.location.start);if(u!==void 0){let f=u.identifierToken.location.path,g=t.find(v=>v.getContext().filepath===f);if(g!==void 0)return Tm(g,o.scopePath,u.identifierToken.location.start)}for(let f of[e,...t]){let g=Tm(f,o.scopePath,new me(0,0));if(g!==void 0)return g}}function xm(e,t){for(let n of e.namespaceNodes.map(i=>i.linkedToken))if(n.location.positionInRange(t))return n;for(let[n,i]of e.childScopeTable){if(e.isAnonymousScope())continue;let o=xm(i,t);if(o!==void 0)return o}}function NT(e,t){let n,i,o;for(let r of e.info.autocompleteNamespaceAccess)if(r.namespaceToken.location.positionInRange(t)){n=r.accessScope,i=r.namespaceToken,o=r.tokenAfterNamespaces;break}return{accessScope:n,tokenOnCaret:i,tokenAfterNamespace:o}}function Tm(e,t,n){let i=e.resolveScope(t);if(i===void 0)return;let o;ym(i.linkedNode)&&i.linkedNode.identifier.location.path===i.getContext().filepath&&(o=i.linkedNode.identifier);for(let r=i.namespaceNodes.length-1;r>=0;r--){let s=i.namespaceNodes[r].linkedToken;o=o===void 0?s:n.compareNearest(o.location.start,s.location.start)===-1?o:s}return o}var cg=ue(Mt());var Nm={suppressAnalyzerErrors:!0,includePath:[],implicitMutualInclusion:!1,hoistEnumParentScope:!1,explicitPropertyAccessor:!1,supportsForEach:!1,characterLiterals:!1,supportsTypedEnumerations:!1,supportsDigitSeparators:!1,builtinStringType:"string",builtinArrayType:"array",formatter:{maxBlankLines:1,indentSpaces:4,useTabIndent:!1},trace:{server:"off"}},km=Nm;function Rm(e){km=e??Nm}function Y(){return km}var es=ue(Mt());var Pm="AngelScript - Analyzer",Gi=[];function kT(){Gi.length=0}function RT(e,t){let n=Y().suppressAnalyzerErrors?es.DiagnosticSeverity.Warning:es.DiagnosticSeverity.Error;Gi.push({severity:n,range:e.clone(),message:t,source:Pm})}function PT(e,t,n){Gi.push({severity:es.DiagnosticSeverity.Hint,range:e.clone(),message:n,source:Pm,data:t})}function CT(){let e=Gi.slice();return Gi.length=0,e}var A={beginSession:kT,error:RT,hint:PT,endSession:CT};var Ki=require("node:assert");function _T(){return{filepath:"",builtinStringType:void 0,enumScopeList:[],info:{reference:[],scopeRegion:[],autocompleteInstanceMember:[],autocompleteNamespaceAccess:[],functionCall:[],autoTypeResolution:[]}}}var zc=class e{constructor(t,n,i){this.key=n;this._linkedNode=i;this._childScopeTable=new Map;this._symbolTable=new Map;this._namespaceNodes=[];Ki(t!==void 0||this instanceof cn),this._parentScope=t,this.scopePath=t!==void 0?[...t.scopePath,n]:[]}get parentScope(){return this._parentScope}isGlobalScope(){return this._parentScope===void 0}get symbolTable(){return this._symbolTable}get childScopeTable(){return this._childScopeTable}setLinkedNode(t){Ki(this._linkedNode===void 0),this._linkedNode=t}get linkedNode(){return this._linkedNode}isFunctionHolderScope(){return this._childScopeTable.values().next().value?.isFunctionScope()===!0}isFunctionScope(){return this.linkedNode?.nodeName==="Func"}isAnonymousScope(){return Lm(this.key)}isPureNamespaceScope(){return this.linkedNode===void 0&&!this.isFunctionHolderScope()&&!this.isAnonymousScope()}getContext(){return this.getGlobalScope().getContext()}takeParentBy(t){if(t(this))return this;if(this.parentScope!==void 0)return this.parentScope.takeParentBy(t)}takeParentByNode(t){return this.takeParentBy(n=>n.linkedNode!==void 0&&t.includes(n.linkedNode.nodeName))}getGlobalScope(){return this.isGlobalScope()?this:(Ki(this.parentScope!==void 0),this.parentScope.getGlobalScope())}pushNamespaceNode(t,n){this._namespaceNodes.push({node:t,linkedToken:n})}get namespaceNodes(){return this._namespaceNodes}insertScope(t,n){let i=this._childScopeTable.get(t);if(i!==void 0)return i.linkedNode===void 0&&i.setLinkedNode(n),i;let o=new e(this,t,n);return this._childScopeTable.set(t,o),o}insertScopeAndCheck(t,n){let i=this.insertScope(t.text,n);return n!==void 0&&n!==i.linkedNode&&Cm(t),i}lookupScopeWithParent(t){let n=this._childScopeTable.get(t);return n!==void 0?n:this.parentScope===void 0?void 0:this.parentScope.lookupScopeWithParent(t)}lookupScope(t){return this._childScopeTable.get(t)}resolveScope(t){if(t.length===0)return this;let n=this._childScopeTable.get(t[0]);if(n!==void 0)return n.resolveScope(t.slice(1))}insertSymbol(t){let n=t.identifierToken.text,i=this._symbolTable.get(n);if(i===void 0){this._symbolTable.set(n,t.toHolder());return}if((t.isFunction()&&i.isFunctionHolder())===!1)return i;i.pushOverload(t)}insertSymbolAndCheck(t){let n=this.insertSymbol(t);return n!==void 0&&Cm(t.identifierToken),n===void 0}lookupSymbol(t){return this._symbolTable.get(t)}lookupSymbolWithParent(t){let n=this.lookupSymbol(t);return n!==void 0?n:this.parentScope===void 0?void 0:this.parentScope.lookupSymbolWithParent(t)}includeExternalScopeInternal(t,n){for(let[i,o]of t._symbolTable)for(let r of o.toList())r.identifierToken.location.path===n&&this.insertSymbol(r);for(let[i,o]of t._childScopeTable){let r=o.linkedNode?.nodeRange.path===n;if(o.isAnonymousScope()){if(r&&o.isFunctionScope()){let s=this.insertScope(i,o.linkedNode)}}else(o._symbolTable.size>0||o._childScopeTable.size>0)&&this.insertScope(i,r?o.linkedNode:void 0).includeExternalScopeInternal(o,n)}}},cn=class extends zc{constructor(t){super(void 0,"",void 0),typeof t=="string"?(this._context=_T(),this._context.filepath=t):this._context=t}getContext(){return this._context}activateContext(){DT(this)}commitContext(){this._context.builtinStringType=Om(this),this._context.enumScopeList=Dm(this)}includeExternalScope(t){let n=t.getContext().filepath;this.includeExternalScopeInternal(t,n)}get info(){return this._context.info}resolveScope(t){return super.resolveScope(t)}};function Cm(e){A.error(e.location,`Symbol '${e.text}' is already declared in the scope.`)}function Om(e){for(let[t,n]of e.symbolTable)if(n.isType()&&OT(n.linkedNode))return n;for(let[t,n]of e.childScopeTable){if(n.isAnonymousScope())continue;let i=Om(n);if(i!==void 0)return i}}function Dm(e){let t=[];for(let n of e.childScopeTable.values())n.isAnonymousScope()||(n.linkedNode?.nodeName==="Enum"&&t.push(n),t.push(...Dm(n)));return t}function OT(e){if(e===void 0||e.nodeName!="Class")return!1;let t="BuiltinString";return e.metadata.some(n=>n.length===1&&n[0].text===t)?!0:Y().builtinStringType===e.identifier.text}function wm(e){let t=[],n=e;for(;n.parentScope!==void 0;)t.push(n.parentScope),n=n.parentScope;return t}var Uc;function DT(e){Uc=e}function le(){return Ki(Uc!==void 0),Uc}function Ee(e){let t=le().resolveScope(e);return Ki(t!==void 0),t}function Em(e){return e===void 0?le():le().resolveScope(e)}function Gc(e,t){return t===e?!0:e.parentScope===void 0?!1:Gc(e.parentScope,t)}var _m=-1;function Pt(){return _m++,`~${_m}`}function Lm(e){return e.startsWith("~")}function wT(e){Y().trace.server!=="off"&&console.log(e)}function ET(e){Y().trace.server!=="off"&&console.error(e)}function LT(e){Y().trace.server==="verbose"&&console.log(e)}var Ge={message:wT,error:ET,verbose:LT};var di=class{constructor(){this.start=performance.now()}mark(t){Ge.verbose(`${t} : ${performance.now()-this.start} ms`),this.start=performance.now()}};var ts=class{constructor(t){this.value=t,this.children=new Map}},ns=class{constructor(){this.root=new ts(void 0)}insert(t,n){let i=this.root;for(let o of t)i.children.has(o)===!1&&i.children.set(o,new ts(void 0)),i=i.children.get(o);i.value=n}find(t,n){let i=this.root,o="";for(let r=n;r<t.length;++r){let s=t[r];if(i.children.has(s))o+=s,i=i.children.get(s);else break}if(i.value!==void 0)return{key:o,value:i.value}}};var IT=require("assert"),Im=["*","**","/","%","+","-","<=","<",">=",">","(",")","==","!=","?",":","=","+=","-=","*=","/=","%=","**=","++","--","&",",","{","}",";","|","^","~","<<",">>",">>>","&=","|=","^=","<<=",">>=",">>>=",".","...","&&","||","!","[","]","^^","@","!is","::","#"],FT=["*","**","/","%","+","-","<=","<",">","(",")","==","!=","?",":","=","+=","-=","*=","/=","%=","**=","++","--","&",",","{","}",";","|","^","~","<<","&=","|=","^=","<<=",".","...","&&","||","!","[","]","^^","@","::","#"],Fm=["and","auto","bool","break","case","cast","catch","class","const","continue","default","do","double","else","enum","false","float","for","funcdef","if","import","in","inout","int","interface","int8","int16","int32","int64","is","mixin","namespace","not","null","or","out","override","private","protected","return","switch","true","try","typedef","uint","uint8","uint16","uint32","uint64","void","while","xor"],AT=new Set(["-","+","!","++","--","~","@","not"]),MT=new Set(["&","|","^","<<",">>",">>>"]),qT=new Set(["+","-","*","/","%","**"]),jT=new Set(["==","!=","<","<=",">",">=","is","!is"]),BT=new Set(["&&","||","^^","and","or","xor"]),WT=new Set(["=","+=","-=","*=","/=","|=","&=","^=","%=","**=","<<=",">>=",">>>="]),Kc=new Set(["int","int8","int16","int32","int64","uint","uint8","uint16","uint32","uint64","float","double"]),HT=new Set(["void","int","int8","int16","int32","int64","uint","uint8","uint16","uint32","uint64","float","double","bool"]),VT=new Set(["int","int8","int16","int32","int64"]),$T=new Set(["uint","uint8","uint16","uint32","uint64"]),zT=new Set(["float"]),UT=new Set(["double"]);function GT(){return{isMark:!1,isExprPreOp:!1,isExprOp:!1,isBitOp:!1,isMathOp:!1,isCompOp:!1,isLogicOp:!1,isAssignOp:!1,isNumber:!1,isPrimeType:!1,isSignedInteger:!1,isUnsignedInteger:!1,isFloat:!1,isDouble:!1}}var Qc=KT();function KT(){let e=new Map;for(let t of[...Im,...Fm])e.set(t,GT());for(let t of Im)e.get(t).isMark=!0;for(let t of AT)e.get(t).isExprPreOp=!0;for(let t of MT)e.get(t).isExprOp=!0,e.get(t).isBitOp=!0;for(let t of qT)e.get(t).isExprOp=!0,e.get(t).isMathOp=!0;for(let t of jT)e.get(t).isExprOp=!0,e.get(t).isCompOp=!0;for(let t of BT)e.get(t).isExprOp=!0,e.get(t).isLogicOp=!0;for(let t of WT)e.get(t).isAssignOp=!0;for(let t of Kc)e.get(t).isNumber=!0;for(let t of HT)e.get(t).isPrimeType=!0;for(let t of VT)e.get(t).isSignedInteger=!0;for(let t of $T)e.get(t).isUnsignedInteger=!0;for(let t of zT)e.get(t).isFloat=!0;for(let t of UT)e.get(t).isDouble=!0;return e}var QT=JT();function JT(){let e=new ns;for(let t of FT)e.insert(t,Qc.get(t));return e}function Am(e,t){return QT.find(e,t)}var XT=YT();function YT(){let e=new Map;for(let t of Fm)e.set(t,Qc.get(t));return e}function Mm(e){return XT.get(e)}function qm(e){let t=Qc.get(e);if(t!==void 0)return t;IT(!1)}function is(e,t){return e.location.withEnd(t.location.end)}var D=class e{constructor(t,n){this.start=t;this.end=n}getBoundingLocation(){return is(this.start,this.end)}isOneLine(){return this.start.location.start.line===this.end.location.end.line}get path(){return this.start.location.path}extendBackward(t){let n=this.start;for(let i=0;i<t;i++)n=n.prev??n;return new e(n,this.end)}extendForward(t){let n=this.end;for(let i=0;i<t;i++)n=n.next??n;return new e(this.start,n)}};var ZT=require("node:assert");var eS=qe.createEmpty(),On=class{constructor(t,n,i,o=10){this.text=t;this._prevRawToken=void 0;this._nextRawToken=void 0;this._indexInPreprocessedTokenList=-1;this._prevPreprocessedToken=void 0;this._nextPreprocessedToken=void 0;this._coveredRange=void 0;n instanceof qe?this._location=n:n instanceof D&&(this._coveredRange=n),this._highlight={token:i,modifier:o}}get location(){return this._location??this._coveredRange?.getBoundingLocation()??eS}setHighlight(t,n){ZT(this.isVirtual()===!1),n===void 0?this._highlight.token=t:this._highlight={token:t,modifier:n}}get highlight(){return this._highlight}isVirtual(){return this._location===void 0}isReservedToken(){return this.kind==="Reserved"}isNumberToken(){return this.kind==="Number"}isStringToken(){return this.kind==="String"}isCommentToken(){return this.kind==="Comment"}bindRawToken(t){this._nextRawToken=t,t!==void 0&&(t._prevRawToken=this)}bindPreprocessedToken(t,n){this._indexInPreprocessedTokenList=t,this._nextPreprocessedToken=n,n!==void 0&&(n._prevPreprocessedToken=this)}get prevRaw(){return this._prevRawToken}get nextRaw(){return this._nextRawToken}get index(){return this._indexInPreprocessedTokenList}get prev(){return this._prevPreprocessedToken}get next(){return this._nextPreprocessedToken}get coveredRange(){return this._coveredRange}getNextOrSelf(){return this.next??this}equals(t){return t===void 0?!1:this===t||this.location.equals(t.location)}},tt=class e extends On{constructor(t,n,i){super(t,n,20),this.property=i??qm(t)}static createVirtual(t,n){return new e(t,n)}get kind(){return"Reserved"}},Be=class e extends On{constructor(t,n){super(t,n,9)}static createVirtual(t,n){return new e(t,n)}get kind(){return"Identifier"}};var os=class extends On{constructor(n,i,o){super(n,i,21);this.numberLiteral=o}get kind(){return"Number"}},li=class e extends On{constructor(t,n){super(t,n,19)}static createVirtual(t,n){return new e(t,n)}get kind(){return"String"}getStringContent(){return this.text.startsWith('"""')?this.text.slice(3,-3):this.text.slice(1,-1)}},Qi=class extends On{constructor(t,n){super(t,n,18)}get kind(){return"Comment"}};var Bm=ue(on()),Ji=[];function tS(){Ji.length>0&&console.error("diagnostic.endSession() was not called before diagnostic.beginSession()"),Ji=[]}function nS(){let e=Ji;return Ji=[],e}function iS(e,t,n){Ji.push({range:structuredClone(e),message:t,severity:n,source:"AngelScript"})}function oS(e,t){iS(e,t,Bm.DiagnosticSeverity.Error)}var Ke={beginSession:tS,endSession:nS,error:oS};var rs=class{getCursorOffset(){return this._cursorOffset}getCursorPosition(){return this._cursorPosition.freeze()}constructor(t){this._fileContent=t,this._cursorOffset=0,this._cursorPosition=new Rt(0,0)}next(t=0){return this._fileContent[this._cursorOffset+t]}isEnd(){return this._cursorOffset>=this._fileContent.length}isNext(t){return this._fileContent.substring(this._cursorOffset,this._cursorOffset+t.length)===t}isNextWrap(){let t=this.next();return t==="\r"||t===`
`}isNextWhitespace(){let t=this._fileContent[this._cursorOffset];return t===" "||t==="	"}stepNext(){this.isEnd()||(this.isNextWrap()?(this._cursorPosition.line_++,this._cursorPosition.character_=0,this.isNext(`\r
`)?this._cursorOffset+=2:this._cursorOffset+=1):(this._cursorPosition.character_++,this._cursorOffset+=1))}stepFor(t){this._cursorPosition.character_+=t,this._cursorOffset+=t}substrToCursor(t){return this._fileContent.substring(t,this._cursorOffset)}},ss=class{constructor(){this._bufferText="";this._bufferLocation=null}append(t,n){this._bufferLocation===null?this._bufferLocation=Yr.create(t):(t.start.line!==this._bufferLocation.end.line_||t.start.character-this._bufferLocation.end.character_>1)&&(this.flush(),this._bufferLocation.start=Rt.create(t.start)),this._bufferLocation.end=Rt.create(t.end),this._bufferText+=n}flush(){this._bufferText.length!==0&&this._bufferLocation!==null&&(this._bufferLocation.end.character_++,Ke.error(this._bufferLocation.freeze(),"Unknown token: "+this._bufferText),this._bufferText="")}};function as(e,t,n=0){let i=t.next(n);return e.test(i)?!0:Y().supportsDigitSeparators&&/^'$/.test(i)?e.test(t.next(n+1)):!1}function Xi(e,t=0){return as(/^[0-9]$/,e,t)}function sS(e,t=0){return as(/^[01]$/,e,t)}function aS(e,t=0){return as(/^[0-7]$/,e,t)}function cS(e,t=0){return as(/^[A-Fa-f0-9]$/,e,t)}function uS(e,t){if(e.isNext("//"))return dS(e,t);if(e.isNext("/*"))return lS(e,t)}function dS(e,t){let n=e.getCursorOffset();for(e.stepFor(2);!(e.isEnd()||e.isNextWrap());)e.stepNext();return new Qi(e.substrToCursor(n),t.withEnd(e.getCursorPosition()))}function lS(e,t){let n=e.getCursorOffset();for(e.stepFor(2);!e.isEnd();){if(e.isNext("*/")){e.stepFor(2);break}e.stepNext()}return new Qi(e.substrToCursor(n),t.withEnd(e.getCursorPosition()))}function fS(e,t){let n=e.getCursorOffset(),i=pS(e);if(n!==e.getCursorOffset())return new os(e.substrToCursor(n),t.withEnd(e.getCursorPosition()),i)}function pS(e){if(/^[0-9.]/.test(e.next())===!1)return"Integer";if(e.next()==="."&&e.next(1)===".")return"Integer";if(e.next(0)==="."&&/^[fF]$/.test(e.next(1)))return"Integer";if(e.next(0)==="0"){if(/^[bB]$/.test(e.next(1))){for(e.stepFor(2);e.isEnd()===!1&&sS(e);)e.stepNext();return"Integer"}else if(/^[oO]$/.test(e.next(1))){for(e.stepFor(2);e.isEnd()===!1&&aS(e);)e.stepNext();return"Integer"}else if(/^[dD]$/.test(e.next(1))){for(e.stepFor(2);e.isEnd()===!1&&Xi(e);)e.stepNext();return"Integer"}else if(/^[xX]$/.test(e.next(1))){for(e.stepFor(2);e.isEnd()===!1&&cS(e);)e.stepNext();return"Integer"}}for(;e.isEnd()===!1&&Xi(e);)e.stepNext();let t="Integer",n=0;if(e.next()==="."){for(n++;Xi(e,n);)n++;t="Double"}if(/^[eE]$/.test(e.next(n))&&/^[+-]$/.test(e.next(n+1))&&Xi(e,n+2)){for(n+=3;Xi(e,n);)n++;t="Double"}return n>=1&&(e.stepFor(n),t==="Double"&&/^[fF]$/.test(e.next()))?(e.stepNext(),"Float"):t}function mS(e,t){let n=e.getCursorOffset();if(e.next()!=="'"&&e.next()!=='"')return;let i=e.isNext('"""')?'"""':e.isNext('"')?'"':"'";e.stepFor(i.length);let o=!1;for(;!e.isEnd();)if(i!=='"""'&&e.isNextWrap()){Ke.error({start:e.getCursorPosition(),end:e.getCursorPosition()},"Missing end quote "+i);break}else if(o===!1&&e.isNext(i)){e.stepFor(i.length);break}else e.next()==="\\"&&o===!1?o=!0:o=!1,e.stepNext();return new li(e.substrToCursor(n),t.withEnd(e.getCursorPosition()))}function hS(e,t){let n=Am(e._fileContent,e.getCursorOffset());if(n!==void 0)return e.stepFor(n.key.length),Wm(n.key,n.value,t.withEnd(e.getCursorPosition()))}function Wm(e,t,n){return new tt(e,n,t)}function gS(e,t=0){return/^[A-Za-z0-9_]$/.test(e.next(t))}function yS(e,t){let n=e.getCursorOffset();for(;e.isEnd()===!1&&gS(e);)e.stepFor(1);let i=e.substrToCursor(n);if(i==="")return;let o=t.withEnd(e.getCursorPosition()),r=Mm(i);return r!==void 0?Wm(i,r,o):new Be(i,o)}function Hm(e,t){let n=[],i=new rs(t),o=new ss;for(;!i.isEnd();){if(i.isNextWrap()||i.isNextWhitespace()){i.stepNext();continue}let r=new qe(e,i.getCursorPosition(),i.getCursorPosition()),s=uS(i,r);if(s!==void 0){n.push(s);continue}let u=fS(i,r);if(u!==void 0){n.push(u);continue}let f=mS(i,r);if(f!==void 0){n.push(f);continue}let g=hS(i,r);if(g!==void 0){n.push(g);continue}let v=yS(i,r);if(v!==void 0){n.push(v);continue}o.append(r,i.next()),i.stepNext()}o.flush();for(let r=0;r<n.length;r++)n[r].bindRawToken(n[r+1]);return n}function Vm(e){let t=e.filter(i=>i.kind!=="Comment"),n=bS(t);for(let i=t.length-1;i>=1;i--)(t[i-1].isStringToken()&&t[i].isStringToken())!==!1&&(t[i-1]=vS(t[i-1],t[i]),t.splice(i,1));for(let i=0;i<t.length;i++)t[i].bindPreprocessedToken(i,i!=t.length-1?t[i+1]:void 0);return{preprocessedTokens:t,includePathTokens:n}}function bS(e){let t=[],n=[];for(let i=0;i<e.length;i++){if(e[i].text!=="#")continue;let o=SS(e,i);TS(o,t),n.push([i,o.length])}for(let i=n.length-1;i>=0;i--)e.splice(n[i][0],n[i][1]);return t}function TS(e,t){if(e[0].setHighlight(25),e[1]?.text==="include"){e[1].setHighlight(25);let n=e[2];if(n===void 0){Ke.error(e[1].location,"Expected file name for include directive.");return}if(n.isStringToken()===!1){Ke.error(e[2].location,"Expected string literal for include directive.");return}t.push(n)}else e[1]!=null&&e[1].setHighlight(17)}function SS(e,t){let n=t;for(let i=t;i<e.length-1&&e[i].location.end.isSameLine(e[i+1].location.start)!==!1;i++)n=i+1;return e.slice(t,n+1)}function vS(e,t){let n='"'+e.getStringContent()+t.getStringContent()+'"';return li.createVirtual(n,new D(e,t))}var cs=class{constructor(t,n=0){this._tokens=t;this._cursorIndex=n;this._caches=[];this.isPredefinedFile=!1;this._caches=new Array(t.length),this._sofToken=xS(t.at(0)),this._eofToken=NS(t.at(-1)),this.isPredefinedFile=t.at(0)?.location.path.endsWith("as.predefined")??!1}backtrack(t){this._cursorIndex=t.index}isEnd(){return this._cursorIndex>=this._tokens.length}next(t=0){return this._cursorIndex+t>=this._tokens.length?this._eofToken:this._tokens[this._cursorIndex+t]}hasNext(t=0){return this._cursorIndex+t<this._tokens.length}prev(){return this._cursorIndex<=0?this._sofToken:this._tokens[this._cursorIndex-1]}step(){this._cursorIndex++}commit(t){let n=this.next();n.isVirtual()===!1&&n.setHighlight(t),this.step()}expect(t,n){return this.isEnd()?(Ke.error(this.next().location,"Unexpected end of file."),!1):(this.next().kind==="Reserved"&&this.next().text===t)===!1?(Ke.error(this.next().location,`Expected '${t}'.`),!1):(this.commit(n),!0)}error(t){this._lastTokenAtError!==this.next()&&(Ke.error(this.next().location,t),this._lastTokenAtError=this.next())}cache(t){let n=this._cursorIndex,i=this._caches[n],o;return i!==void 0&&i.kind===t&&(o=()=>(this._cursorIndex=i.rangeEnd,i.data)),{restore:o,store:s=>{this._caches[n]={kind:t,rangeEnd:this._cursorIndex,data:s}}}}};function xS(e){if(e===void 0)return new Be("",qe.createEmpty());let t=new me(0,0);return new Be("",new qe(e.location.path,t,t))}function NS(e){if(e===void 0)return new Be("",qe.createEmpty());let t=Rt.create(e.location.end);t.character_+=1;let n=t.freeze();return new Be("",new qe(e.location.path,n,n))}function Jc(e,t){if(e.text!==t[0])return!1;let n=e.next,i=e.location.end.character;for(let o=1;o<t.length;o++){if(n===void 0||n.text!==t[o]||n.location.start.line!==e.location.start.line||n.location.start.character!==i)return!1;i=n.location.end.character,n=n.next}return!0}function us(e,t,n){let i=e.coveredRange?.start??e,o=e.coveredRange?.end??e;for(let u=0;u<t;u++)i=i.prev??i;for(let u=0;u<n;u++)o=o.next??o;let r=i.location.end,s=o.location.start;return new qe(e.location.path,r,s)}function Gm(e){let t=[];for(;e.isEnd()===!1;){if(e.next().text===";"){e.commit(23);continue}let n=MS(e);if(n==="Pending")continue;if(n!=="Mismatch"){t.push(n);continue}let i=wS(e);if(i==="Pending")continue;if(i!=="Mismatch"){t.push(i);continue}let o=qS(e);if(o==="Pending")continue;if(o!=="Mismatch"){t.push(o);continue}let r=kS(e);if(r==="Pending")continue;if(r!=="Mismatch"){t.push(r);continue}let s=Km(e);if(s==="Pending")continue;if(s!=="Mismatch"){t.push(s);continue}let u=IS(e);if(u==="Pending")continue;if(u!=="Mismatch"){t.push(u);continue}let f=PS(e);if(f==="Pending")continue;if(f!=="Mismatch"){t.push(f);continue}let g=Jm(e);if(g==="Pending")continue;if(g!=="Mismatch"){t.push(g);continue}let v=Qm(e);if(v!==void 0){t.push(v);continue}let _=Yc(e);if(_!==void 0){t.push(_);continue}io(e);let w=ls(e);if(w!==void 0){t.push(w);continue}break}return t}function kS(e){if(e.next().text!=="namespace")return"Mismatch";let t=e.next();e.commit(24);let n=[];for(;e.isEnd()===!1;){let o=e.next(),r=Tt(e,1);if(r!==void 0&&n.push(r),Ct(e,"::","{",!0)==="Break")break;e.next()===o&&e.step()}if(n.length===0)return"Pending";let i=Gm(e);return e.expect("}",23),{nodeName:"Namespace",nodeRange:new D(t,e.prev()),namespaceList:n,script:i}}function eo(e,t){let n=e.next();if(n.kind==="Identifier")return e.commit(t),n}function Tt(e,t){let n=eo(e,t);return n===void 0&&e.error("Expected identifier."),n}function RS(e,t){return e.next().text!==t?(e.error(`Expected '${t}'.`),!1):(e.commit(20),!0)}function PS(e){let t=e.next(),n=to(e);if(e.next().text!=="enum")return e.backtrack(t),"Mismatch";e.commit(24);let i=Tt(e,3);if(i===void 0)return"Pending";let o;if(Y().supportsTypedEnumerations&&e.next().text===":"){e.commit(23);let u=iu(e);if(u===void 0)return e.backtrack(t),"Mismatch";o=u}let r=[],s=e.next();return e.next().text===";"?e.commit(23):r=CS(e),{nodeName:"Enum",nodeRange:new D(t,e.prev()),scopeRange:new D(s,e.prev()),entity:n,identifier:i,memberList:r,enumType:o}}function CS(e){let t=[];for(e.expect("{",23);e.isEnd()===!1&&Ct(e,",","}",t.length>0)!=="Break";){if(e.next().text==="}"){e.commit(23);break}let n=Tt(e,11);if(n===void 0)break;let i;e.next().text==="="&&(e.commit(23),i=au(e)),t.push({identifier:n,expr:i})}return t}function to(e){let t=e.cache("EntityAttribute");if(t.restore!==void 0)return t.restore();let n;for(;e.isEnd()===!1;){let i=e.next().text;if((i==="shared"||i==="external"||i==="abstract"||i==="final")===!1)break;n=n??{isShared:!1,isExternal:!1,isAbstract:!1,isFinal:!1},_S(n,i),e.commit(24)}return t.store(n),n}function _S(e,t){t==="shared"?e.isShared=!0:t==="external"?e.isExternal=!0:t==="abstract"?e.isAbstract=!0:t==="final"&&(e.isFinal=!0)}function Km(e){let t=e.next(),n=io(e),i=to(e);if(e.next().text!=="class")return e.backtrack(t),"Mismatch";e.commit(24);let o=Tt(e,2);if(o===void 0)return"Pending";let r=so(e),s=[];if(e.next().text===":")for(e.commit(23);e.isEnd()===!1;){let v=e.next(),_=Tt(e,7);if(_!==void 0&&s.push(_),Ct(e,",","{",!0)==="Break")break;e.next()===v&&e.step()}else e.expect("{",23);let u=e.next(),f=OS(e),g=e.prev();return{nodeName:"Class",nodeRange:new D(t,e.prev()),scopeRange:new D(u,g),metadata:n,entity:i,identifier:o,typeTemplates:r,baseList:s,memberList:f}}function OS(e){let t=[];for(;e.isEnd()===!1&&oo(e,"}")!=="Break";){let n=Jm(e);if(n==="Pending")continue;if(n!=="Mismatch"){t.push(n);continue}let i=Qm(e);if(i!==void 0){t.push(i);continue}let o=Yc(e);if(o!==void 0){t.push(o);continue}let r=ls(e);if(r!==void 0){t.push(r);continue}e.error("Expected class member."),e.step()}return t}function DS(e){let t=e.next(),n=ro(e);if(n===void 0)return;let i=Tt(e,9);if(i!==void 0)return{nodeName:"ForEachVar",nodeRange:new D(t,e.prev()),type:n,identifier:i}}function wS(e){if(e.next().text!=="typedef")return"Mismatch";let t=e.next();e.commit(24);let n=iu(e);if(n===void 0)return e.error("Expected primitive type."),"Pending";let i=e.next();return e.commit(7),e.expect(";",23),{nodeName:"TypeDef",nodeRange:new D(t,e.prev()),type:n,identifier:i}}function ES(e,t){let n=0;for(;!e.isEnd();)if(e.next().text==="{")e.commit(23),t.push({operator:"StartList"}),n++;else if(e.next().text==="}")if(n)e.commit(23),n--,t.push({operator:"EndList"});else break;else if(e.next().text==="repeat"||e.next().text==="repeat_same")e.commit(20),t.push({operator:e.next().text==="repeat"?"Repeat":"RepeatSame"});else if(e.next().text===",")e.commit(23);else{let i=_t(e);if(i===void 0)return!1;t.push({operator:"Type",type:i})}return n===0}function LS(e){if(e.isPredefinedFile===!1)return;let t=e.next();if(e.next().text!=="{")return;e.commit(23);let n=[];for(;!e.isEnd()&&e.next().text!=="}";)if(ES(e,n)===!1){e.backtrack(t);return}if(e.next().text!=="}"||n.length===0){e.backtrack(t);return}e.commit(23)}function Qm(e){let t=e.next();io(e);let n=to(e),i=Xc(e),o;if(e.next().text==="~")e.commit(23),o=qt;else if(e.next(0).kind==="Identifier"&&e.next(1).text==="(")o=Xr;else{let w=_t(e);if(w===void 0){e.backtrack(t);return}let ee=no(e);o={returnType:w,isRef:ee}}let r=e.next();e.commit(rn(o)?14:7);let s=so(e)??[],u=Zc(e);if(u===void 0){e.backtrack(t);return}let f=LS(e),g,v,_=!1;if(f===void 0)if(_=ds(e),v=fs(e),e.next().text===";"){if(e.isPredefinedFile===!1){e.backtrack(t);return}e.commit(23)}else g=Zi(e);else{if(e.next().text!==";"){e.backtrack(t);return}e.commit(23)}return g=g??{nodeName:"StatBlock",nodeRange:new D(e.next(),e.next()),statementList:[]},{nodeName:"Func",nodeRange:new D(t,e.prev()),entity:n,accessor:i,head:o,identifier:r,paramList:u,isConst:_,funcAttr:v,statBlock:g,typeTemplates:s,listPattern:f}}function ds(e){return e.next().text!=="const"?!1:(e.commit(20),!0)}function no(e){let t=e.next().text==="&";return t&&e.commit(24),t}function io(e){let t=e.next();if(e.next().text!=="[")return[];let n=0,i=[[]];for(;e.isEnd()===!1;)if(e.next().text==="[")n>0&&i.at(-1).push(e.next()),n++,e.commit(23);else if(e.next().text==="]")if(n--,e.commit(23),n===0){if(e.next().text==="["){i.push([]);continue}return i}else i.at(-1).push(e.next());else i.at(-1).push(e.next()),e.commit(12);return e.backtrack(t),[]}function Xc(e){let t=e.next().text;if(t==="private"||t==="protected")return e.commit(24),t==="private"?"Private":"Protected"}function IS(e){let t=e.next(),n=to(e);if(e.next().text!=="interface")return e.backtrack(t),"Mismatch";e.commit(24);let i=Tt(e,4);if(i===void 0)return"Pending";let o={nodeName:"Interface",nodeRange:new D(t,e.prev()),entity:n,identifier:i,baseList:[],memberList:[]};if(e.next().text===";")return e.commit(23),o;if(e.next().text===":")for(e.commit(23);e.isEnd()===!1;){let r=e.next(),s=Tt(e,7);if(s!==void 0&&o.baseList.push(s),Ct(e,",","{",!0)==="Break")break;e.next()===r&&e.step()}else e.expect("{",23);return o.memberList=FS(e),o}function FS(e){let t=[];for(;e.isEnd()===!1&&oo(e,"}")!=="Break";){let n=jS(e);if(n!==void 0){t.push(n);continue}let i=Yc(e);if(i!==void 0){t.push(i);continue}e.error("Expected interface member."),e.step()}return t}function ls(e){let t=e.next();io(e);let n=Xc(e),i=_t(e);if(i===void 0){e.backtrack(t);return}if(e.next().kind!=="Identifier"){e.backtrack(t);return}let o=[];for(;e.isEnd()===!1;){let r=Tt(e,9);if(r===void 0)break;if(e.next().text==="="){e.commit(23);let s=AS(e);o.push({identifier:r,initializer:s})}else{let s=ps(e);o.push({identifier:r,initializer:s})}if(Ct(e,",",";",!0)==="Break")break}return{nodeName:"Var",nodeRange:new D(t,e.prev()),accessor:n,type:i,variables:o}}function AS(e){let t=tu(e);if(t!==void 0)return t;let n=Qe(e);if(n!==void 0)return n;e.error("Expected initializer list or assignment.")}function MS(e){let t=e.next();if(e.next().text!=="import")return"Mismatch";e.commit(20);let n=ro(e);if(n===void 0)return"Pending";let i=no(e),o=Tt(e,9);if(o===void 0)return"Pending";let r=Ym(e);if(r===void 0)return"Pending";let s=fs(e);if(RS(e,"from")===!1)return"Pending";let u=e.next();return u.kind!=="String"?(e.error("Expected string path."),"Pending"):(e.commit(19),e.expect(";",23),{nodeName:"Import",nodeRange:new D(t,e.prev()),type:n,isRef:i,identifier:o,paramList:r,funcAttr:s,path:u})}function Jm(e){let t=e.next(),n=to(e);if(e.next().text!=="funcdef")return e.backtrack(t),"Mismatch";e.commit(24);let i=ro(e);if(i===void 0)return"Pending";let o=no(e),r=e.next();e.commit(14);let s=Ym(e);return s===void 0?"Pending":(e.expect(";",23),{nodeName:"FuncDef",nodeRange:new D(t,e.prev()),entity:n,returnType:i,isRef:o,identifier:r,paramList:s})}function Yc(e){let t=e.next();io(e);let n=Xc(e),i=_t(e);if(i===void 0){e.backtrack(t);return}let o=no(e),r=eo(e,9);if(r===void 0){e.backtrack(t);return}if(e.next().text!=="{"){e.backtrack(t);return}e.commit(23);let s,u;for(;e.isEnd()===!1;){let f=e.next().text;if(oo(e,"}")==="Break")break;f==="get"?s=$m(e):f==="set"?u=$m(e):(e.error("Expected getter or setter."),e.step())}return{nodeName:"VirtualProp",nodeRange:new D(t,e.prev()),accessor:n,type:i,isRef:o,identifier:r,getter:s,setter:u}}function $m(e){e.commit(24);let t=ds(e),n=fs(e),i=Zi(e);return{isConst:t,funcAttr:n,statBlock:i}}function qS(e){if(e.next().text!=="mixin")return"Mismatch";let t=e.next();e.commit(24);let n=Km(e);return n==="Pending"?"Pending":n==="Mismatch"?(e.error("Expected class definition."),"Pending"):{nodeName:"Mixin",nodeRange:new D(t,e.prev()),mixinClass:n}}function jS(e){let t=e.next(),n=ro(e);if(n===void 0)return;let i=no(e),o=eo(e,14);if(o===void 0)return;let r=Zc(e);if(r===void 0)return;let s=ds(e),u=fs(e);return e.expect(";",23),{nodeName:"IntfMethod",nodeRange:new D(t,e.prev()),returnType:n,isRef:i,identifier:o,paramList:r,funcAttr:u,isConst:s}}function Xm(e){if(e.next().text!=="{")return;let t=e.next();e.commit(23);let n=[];for(;e.isEnd()===!1&&oo(e,"}")!=="Break";){let i=ls(e);if(i!==void 0){n.push(i);continue}let o=ou(e);if(o!=="Pending"){if(o!=="Mismatch"){n.push(o);continue}e.error("Expected statement."),e.step()}}return{nodeName:"StatBlock",nodeRange:new D(t,e.prev()),statementList:n}}function Zi(e){let t=Xm(e);return t===void 0&&e.error("Expected statement block."),t}function Zc(e){if(e.next().text!=="(")return;if(e.commit(23),e.next().text==="void")return e.commit(24),e.expect(")",23),[];let t=[],n=!1;for(;e.isEnd()===!1&&eu(e,t.length>0)!=="Break";){n&&e.error("Variadic ellipses must be the last parameter.");let i=_t(e);if(i===void 0){if(e.next().kind==="String"||e.next().kind==="Number")return;e.step();continue}let o=eh(e),r;e.next().text==="..."?(e.commit(23),n=!0):e.next().kind==="Identifier"&&(r=e.next(),e.commit(9));let s;e.next().text==="="&&(n&&e.error("Variadic functions cannot have a default expression."),e.commit(23),s=nv(e)),t.push({type:i,modifier:o,identifier:r,defaultExpr:s,isVariadic:n})}return t}function Ym(e){let t=Zc(e);return t===void 0&&e.error("Expected parameter list."),t}function eu(e,t){return Ct(e,",",")",t)}function BS(e){return e===","||e===")"}function Zm(e,t,n,i,o=!1){let r=e.next().text;if(r===n)return e.commit(23),"Break";if(i){if(r!==t)return;if(e.commit(23),o&&e.next().text==n)return e.commit(23),"Break"}return"Through"}function Ct(e,t,n,i,o=!1){let r=Zm(e,t,n,i,o);return r!==void 0?r:(e.error(`Expected '${t}' or '${n}'.`),"Break")}function oo(e,t){return e.next().text===t?(e.commit(23),"Break"):"Through"}function eh(e){let t;if(e.next().text==="&"){e.commit(24);let n=e.next().text;(n==="in"||n==="out"||n==="inout")&&(e.commit(24),n==="in"?t="In":n==="out"?t="Out":t="InOut")}return e.next().text==="+"&&e.commit(24),e.next().text==="if_handle_then_const"&&e.commit(24),t}function _t(e){let t=e.next(),n=ds(e),i=nu(e),o=HS(e);if(o===void 0){e.backtrack(t);return}let r=so(e)??[],{isArray:s,refModifier:u}=WS(e);return{nodeName:"Type",nodeRange:new D(t,e.prev()),isConst:n,scope:i,dataType:o,typeTemplates:r,isArray:s,refModifier:u}}function WS(e){let t=!1,n;for(;e.isEnd()===!1;){if(e.next(0).text==="["&&e.next(1).text==="]"){e.commit(23),e.commit(23),t=!0;continue}else if(e.next().text==="@"){e.commit(24),e.next().text==="+"&&e.commit(24),e.next().text==="const"?(e.commit(24),n="AtConst"):n="At";continue}break}return{isArray:t,refModifier:n}}function ro(e){let t=_t(e);return t===void 0&&e.error("Expected type."),t}function so(e){let t=e.cache("TypeTemplates");if(t.restore!==void 0)return t.restore();let n=e.next();if(e.next().text!=="<")return;e.commit(23);let i=[];for(;e.isEnd()===!1;){let o=_t(e);if(o===void 0){e.backtrack(n);return}i.push(o);let r=Zm(e,",",">",i.length>0);if(r==="Break")break;if(r===void 0){e.backtrack(n),t.store(void 0);return}}return t.store(i),i}function tu(e){if(e.next().text!=="{")return;let t=e.next();e.commit(23);let n=[];for(;e.isEnd()===!1&&Ct(e,",","}",n.length>0,!0)!=="Break";){let i=ms(e);if(i!==void 0){n.push(i);continue}let o=tu(e);if(o!==void 0){n.push(o);continue}e.error("Expected assignment or initializer list."),e.step()}return{nodeName:"InitList",nodeRange:new D(t,e.prev()),initList:n}}function nu(e){let t=e.cache("Scope");if(t.restore!==void 0)return t.restore();let n=e.next(),i=!1;e.next().text==="::"&&(e.commit(23),i=!0);let o=[],r;for(;e.isEnd()===!1;){let u=e.next(0);if(u.kind!=="Identifier")break;if(e.next(1).text==="::"){e.commit(1),e.commit(23),o.push(u);continue}else if(e.next(1).text==="<"){let f=e.next();e.commit(2),r=so(e),r===void 0||e.next().text!=="::"?e.backtrack(f):(e.commit(23),o.push(u))}break}if(i===!1&&o.length===0){t.store(void 0);return}let s={nodeName:"Scope",nodeRange:new D(n,e.prev()),isGlobal:i,scopeList:o,typeTemplates:r??[]};return t.store(s),s}function HS(e){let t=e.next();if(t.kind==="Identifier")return e.commit(7),{nodeName:"DataType",nodeRange:new D(t,t),identifier:t};if(t.text==="?"||t.text==="auto")return e.commit(24),{nodeName:"DataType",nodeRange:new D(t,t),identifier:t};let n=iu(e);if(n!==void 0)return{nodeName:"DataType",nodeRange:new D(t,t),identifier:n}}function iu(e){let t=e.next();if(!(t.isReservedToken()===!1||t.property.isPrimeType===!1))return e.commit(24),t}function fs(e){let t;for(;e.isEnd()===!1;){let n=e.next().text;if((n==="override"||n==="final"||n==="explicit"||n==="property"||n==="delete"||n==="nodiscard")===!1)break;t=t??{isOverride:!1,isFinal:!1,isExplicit:!1,isProperty:!1,isDeleted:!1,isNoDiscard:!1},VS(t,n),e.commit(24)}return t}function VS(e,t){t==="override"?e.isOverride=!0:t==="final"?e.isFinal=!0:t==="explicit"?e.isExplicit=!0:t==="property"?e.isProperty=!0:t==="delete"?e.isDeleted=!0:t==="nodiscard"&&(e.isNoDiscard=!0)}function ou(e){let t=JS(e);if(t==="Pending")return"Pending";if(t!=="Mismatch")return t;let n=US(e);if(n==="Pending")return"Pending";if(n!=="Mismatch")return n;if(Y().supportsForEach){let w=GS(e);if(w==="Pending")return"Pending";if(w!=="Mismatch")return w}let i=KS(e);if(i==="Pending")return"Pending";if(i!=="Mismatch")return i;let o=ev(e);if(o==="Pending")return"Pending";if(o!=="Mismatch")return o;let r=Xm(e);if(r!==void 0)return r;let s=zS(e);if(s!==void 0)return s;let u=XS(e);if(u!==void 0)return u;let f=QS(e);if(f==="Pending")return"Pending";if(f!=="Mismatch")return f;let g=$S(e);if(g==="Pending")return"Pending";if(g!=="Mismatch")return g;let v=ZS(e);if(v==="Pending")return"Pending";if(v!=="Mismatch")return v;let _=ru(e);return _!==void 0?_:"Mismatch"}function fi(e){let t=ou(e);if(t!=="Pending"){if(t==="Mismatch"){e.error("Expected statement.");return}return t}}function $S(e){if(e.next().text!=="switch")return"Mismatch";let t=e.next();e.commit(20),e.expect("(",23);let n=Qe(e);if(n===void 0)return"Pending";e.expect(")",23),e.expect("{",23);let i=[];for(;e.isEnd()===!1&&oo(e,"}")!=="Break";){let o=tv(e);if(o==="Mismatch"){e.error("Expected case statement."),e.step();continue}o!=="Pending"&&i.push(o)}return{nodeName:"Switch",nodeRange:new D(t,e.prev()),assign:n,caseList:i}}function zS(e){if(e.next().text!=="break")return;let t=e.next();return e.commit(20),e.expect(";",23),{nodeName:"Break",nodeRange:new D(t,e.prev())}}function US(e){if(e.next().text!=="for")return"Mismatch";let t=e.next();if(e.commit(20),e.expect("(",23)===!1)return"Pending";let n=ls(e)??ru(e);if(n===void 0)return e.error("Expected initial expression statement or variable declaration."),"Pending";let i={nodeName:"For",nodeRange:new D(t,e.prev()),initial:n,condition:void 0,incrementList:[],statement:void 0};if(i.condition=YS(e),i.condition===void 0)return ke(e,i);for(;e.isEnd()===!1&&Ct(e,",",")",i.incrementList.length>0)!=="Break";){let o=Qe(e);if(o===void 0)break;i.incrementList.push(o)}return i.statement=fi(e),ke(e,i)}function GS(e){if(e.next().text!=="foreach")return"Mismatch";let t=e.next();if(e.commit(20),e.expect("(",23)===!1)return"Pending";let n={nodeName:"ForEach",nodeRange:new D(t,e.prev()),variables:[],statement:void 0,assign:void 0};for(;e.isEnd()===!1&&Ct(e,",",":",n.variables.length>0)!=="Break";){let i=DS(e);if(i===void 0)return e.error("Invalid variable declaration."),"Pending";n.variables.push(i)}return n.assign=Qe(e),e.expect(")",23)===!1||(n.statement=fi(e)),ke(e,n)}function KS(e){if(e.next().text!=="while")return"Mismatch";let t=e.next();if(e.commit(20),e.expect("(",23)===!1)return"Pending";let n=Qe(e);if(n===void 0)return"Pending";let i={nodeName:"While",nodeRange:new D(t,e.prev()),assign:n,statement:void 0};return e.expect(")",23)===!1||(i.statement=fi(e)),ke(e,i)}function QS(e){if(e.next().text!=="do")return"Mismatch";let t=e.next();e.commit(20);let n=fi(e);if(n===void 0)return"Pending";let i={nodeName:"DoWhile",nodeRange:new D(t,e.prev()),statement:n,assign:void 0};return e.expect("while",20)===!1||e.expect("(",23)===!1||(i.assign=Qe(e),i.assign===void 0)||e.expect(")",23)===!1||e.expect(";",23),ke(e,i)}function JS(e){if(e.next().text!=="if")return"Mismatch";let t=e.next();if(e.commit(20),e.expect("(",23)===!1)return"Pending";let n=Qe(e);if(n===void 0)return"Pending";let i={nodeName:"If",nodeRange:new D(t,e.prev()),condition:n,thenStat:void 0,elseStat:void 0};return e.expect(")",23)===!1||(i.thenStat=fi(e),i.thenStat===void 0)||e.next().text==="else"&&(e.commit(20),i.elseStat=fi(e)),ke(e,i)}function ke(e,t){return t.nodeRange=new D(t.nodeRange.start,e.prev()),t}function XS(e){if(e.next().text!=="continue")return;let t=e.next();return e.commit(20),e.expect(";",23),{nodeName:"Continue",nodeRange:new D(t,e.prev())}}function ru(e){let t=e.next();if(e.next().text===";")return e.commit(23),{nodeName:"ExprStat",nodeRange:new D(t,e.prev()),assign:void 0};let n=ms(e);if(n!==void 0)return e.expect(";",23),{nodeName:"ExprStat",nodeRange:new D(t,e.prev()),assign:n}}function YS(e){let t=ru(e);return t===void 0&&e.error("Expected expression statement."),t}function ZS(e){if(e.next().text!=="try")return"Mismatch";let t=e.next();e.commit(20);let n=Zi(e);if(n===void 0)return"Pending";let i={nodeName:"Try",nodeRange:new D(t,e.prev()),tryBlock:n,catchBlock:void 0};return e.expect("catch",20)===!1||(i.catchBlock=Zi(e)),ke(e,i)}function ev(e){if(e.next().text!=="return")return"Mismatch";let t=e.next();e.commit(20);let n={nodeName:"Return",nodeRange:new D(t,e.prev()),assign:void 0};return e.next().text===";"?(e.commit(23),ke(e,n)):(n.assign=Qe(e),n.assign===void 0||e.expect(";",23),ke(e,n))}function tv(e){let t=e.next(),n;if(e.next().text==="case"){if(e.commit(20),n=au(e),n===void 0)return"Pending"}else if(e.next().text==="default")e.commit(20);else return"Mismatch";e.expect(":",23);let i=[];for(;e.isEnd()===!1;){let o=ou(e);if(o==="Mismatch")break;o!=="Pending"&&i.push(o)}return{nodeName:"Case",nodeRange:new D(t,e.prev()),expr:n,statementList:i}}function su(e){let t=e.next(),n=iv(e);if(n===void 0)return;let i=yv(e);if(i===void 0)return{nodeName:"Expr",nodeRange:new D(t,e.prev()),head:n,tail:void 0};let o=au(e);return o===void 0?{nodeName:"Expr",nodeRange:new D(t,e.prev()),head:n,tail:void 0}:{nodeName:"Expr",nodeRange:new D(t,e.prev()),head:n,tail:{operator:i,expression:o}}}function au(e){let t=su(e);return t===void 0&&e.error("Expected expression."),t}function nv(e){if(e.next().text==="void"){let n=e.next();return e.commit(20),{nodeName:"ExprVoid",nodeRange:new D(n,e.prev())}}let t=su(e);return t===void 0&&e.error("Expected expression."),t}function iv(e){let t=ov(e);if(t!==void 0)return t;let n=rv(e);if(n!==void 0)return n}function ov(e){let t=e.next(),n=_t(e);if(n!==void 0){if(e.next().text!=="="){e.backtrack(t);return}e.commit(23)}let i=tu(e);if(i===void 0){e.backtrack(t);return}return{nodeName:"ExprTerm",nodeRange:new D(t,e.prev()),exprTerm:1,type:n,initList:i}}function rv(e){let t=e.next(),n=[];for(;e.isEnd()===!1;){let r=e.next();if(r.isReservedToken()===!1||r.property.isExprPreOp===!1)break;n.push(e.next()),e.commit(23)}let i=sv(e);if(i==="Mismatch"&&e.backtrack(t),i==="Mismatch"||i==="Pending")return;let o=[];for(;e.isEnd()===!1;){let r=cv(e);if(r===void 0)break;o.push(r)}return{nodeName:"ExprTerm",nodeRange:new D(t,e.prev()),exprTerm:2,preOps:n,value:i,postOps:o}}function sv(e){let t=lv(e);if(t==="Pending")return"Pending";if(t!=="Mismatch")return t;if(e.next().text==="("){e.commit(23);let u=Qe(e);return u===void 0?"Pending":(e.expect(")",23),u)}let n=mv(e);if(n!==void 0)return n;let i=fv(e);if(i==="Pending")return"Pending";if(i!=="Mismatch")return i;let o=nh(e);if(o!==void 0)return o;let r=av(e);if(r!==void 0)return r;let s=hv(e);return s!==void 0?s:"Mismatch"}function av(e){let t=e.next(),n=_t(e);if(n===void 0)return;let i=ps(e);if(i===void 0){e.backtrack(t);return}return{nodeName:"ConstructCall",nodeRange:new D(t,e.prev()),type:n,argList:i}}function cv(e){let t=e.next(),n=uv(e);if(n!==void 0)return n;let i=dv(e);if(i!==void 0)return i;let o=ps(e);if(o!==void 0)return{nodeName:"ExprPostOp",nodeRange:new D(t,e.prev()),postOp:3,args:o};let r=e.next().text;if(r==="++"||r==="--")return e.commit(23),{nodeName:"ExprPostOp",nodeRange:new D(t,e.prev()),postOp:4,operator:r}}function uv(e){if(e.next().text!==".")return;let t=e.next();e.commit(23);let n=nh(e);if(n!==void 0)return{nodeName:"ExprPostOp",nodeRange:new D(t,e.prev()),postOp:1,member:n};let i=Tt(e,9);return{nodeName:"ExprPostOp",nodeRange:new D(t,e.prev()),postOp:1,member:i}}function dv(e){if(e.next().text!=="[")return;let t=e.next();e.commit(23);let n=[];for(;e.isEnd()===!1;){let i=e.next(),o=th(e),r=Qe(e);if(r!==void 0&&n.push({identifier:o,assign:r}),Ct(e,",","]",n.length>0)==="Break")break;e.next()===i&&e.step()}return{nodeName:"ExprPostOp",nodeRange:new D(t,e.prev()),postOp:2,indexingList:n}}function th(e){if(e.next(0).kind==="Identifier"&&e.next(1).text===":"){let t=e.next();return e.commit(8),e.commit(23),t}}function lv(e){if(e.next().text!=="cast")return"Mismatch";let t=e.next();if(e.commit(20),e.expect("<",23)===!1)return"Pending";let n=ro(e);if(n===void 0)return"Pending";if(e.expect(">",23)===!1)return"Pending";if(e.expect("(",23)===!1)return"Pending";let i=Qe(e);return i===void 0?"Pending":(e.expect(")",23),{nodeName:"Cast",nodeRange:new D(t,e.prev()),type:n,assign:i})}var fv=e=>{if(pv(e)===!1)return"Mismatch";let t=e.next();e.commit(24),e.expect("(",23);let n={nodeName:"Lambda",nodeRange:new D(t,e.prev()),paramList:[],statBlock:void 0};for(;e.isEnd()===!1&&eu(e,n.paramList.length>0)!=="Break";){if(e.next(0).kind==="Identifier"&&BS(e.next(1).text)){n.paramList.push({type:void 0,typeMod:void 0,identifier:e.next()}),e.commit(8);continue}let i=_t(e),o=i!==void 0?eh(e):void 0,r=eo(e,8);n.paramList.push({type:i,typeMod:o,identifier:r})}return n.statBlock=Zi(e),ke(e,n)};function pv(e){if(e.next(0).text!=="function"||e.next(1).text!=="(")return!1;let t=2;for(;e.hasNext(t);){if(e.next(t).text===")")return e.next(t+1).text==="{";t++}return!1}function mv(e){let t=e.next();if(t.kind==="Number")return e.commit(21),{nodeName:"Literal",nodeRange:new D(t,t),value:t};if(t.kind==="String")return e.commit(19),{nodeName:"Literal",nodeRange:new D(t,t),value:t};if(t.text==="true"||t.text==="false"||t.text==="null")return e.commit(24),{nodeName:"Literal",nodeRange:new D(t,t),value:t}}function nh(e){let t=e.next(),n=nu(e),i=eo(e,14);if(i===void 0){e.backtrack(t);return}let o=so(e)??[],r=ps(e);if(r===void 0){e.backtrack(t);return}return{nodeName:"FuncCall",nodeRange:new D(t,e.prev()),scope:n,identifier:i,argList:r,typeTemplates:o}}function hv(e){let t=e.next(),n=nu(e),i=e.next();if(i.kind!=="Identifier")return n===void 0?void 0:(e.error("Expected identifier."),{nodeName:"VarAccess",nodeRange:new D(t,e.prev()),scope:n,identifier:void 0});let o=n===void 0&&i.text==="this";return e.commit(o?24:9),{nodeName:"VarAccess",nodeRange:new D(t,e.prev()),scope:n,identifier:i}}function ps(e){if(e.next().text!=="(")return;let t=e.next();e.commit(23);let n=[];for(;e.isEnd()===!1&&eu(e,n.length>0)!=="Break";){let i=th(e),o=Qe(e);if(o===void 0)break;n.push({identifier:i,assign:o})}return{nodeName:"ArgList",nodeRange:new D(t,e.prev()),argList:n}}function ms(e){let t=e.next(),n=gv(e);if(n===void 0)return;let i=Tv(e),o={nodeName:"Assign",nodeRange:new D(t,e.prev()),condition:n,tail:void 0};if(i===void 0)return o;let r=ms(e);return r===void 0||(o.tail={operator:i,assign:r},o.nodeRange=new D(t,e.prev())),o}function Qe(e){let t=ms(e);return t===void 0&&e.error("Expected assignment."),t}function gv(e){let t=e.next(),n=su(e);if(n===void 0)return;let i={nodeName:"Condition",nodeRange:new D(t,t),expr:n,ternary:void 0};if(e.next().text==="?"){e.commit(23);let o=Qe(e);if(o===void 0)return i;e.expect(":",23);let r=Qe(e);if(r===void 0)return i;i.ternary={trueAssign:o,falseAssign:r}}return i.nodeRange=new D(t,e.prev()),i}function yv(e){let t=e.next(),n=ih(e);if(n.isReservedToken()===!1){e.backtrack(t);return}return n.property.isExprOp===!1?(e.backtrack(t),bv(e)):(e.commit(n.text==="is"?24:23),n)}function bv(e){if(Jc(e.next(),["!","is"])===!1)return;let t=new D(e.next(),e.next(1));return e.commit(24),e.commit(24),tt.createVirtual("!is",t)}function Tv(e){let t=e.next(),n=ih(e);if(n.isReservedToken()===!1||n.property.isAssignOp===!1){e.backtrack(t);return}return e.commit(23),n}function ih(e){if(e.next().text!==">")return e.next();let t=(u,f)=>{if(Jc(e.next(1),u)===!1)return;let g=new D(e.next(0),e.next(u.length));for(let v=0;v<u.length;++v)e.commit(23);return tt.createVirtual(f,g)},n=t(["="],">=");if(n!==void 0)return n;let i=t([">",">","="],">>>=");if(i!==void 0)return i;let o=t([">",">"],">>>");if(o!==void 0)return o;let r=t([">","="],">>=");if(r!==void 0)return r;let s=t([">"],">>");return s!==void 0?s:e.next()}function oh(e){let t=new cs(e),n=[];for(;t.isEnd()===!1;)n.push(...Gm(t)),t.isEnd()===!1&&(t.error("Unexpected token."),t.step());return n}var hs=class{constructor(){this._timer=void 0}reschedule(t,n){this._timer!==void 0&&clearTimeout(this._timer),this._timer=setTimeout(t,n)}cancel(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}};var pi=require("node:url"),ao=ue(require("url")),mi=ue(require("fs")),Dn=ue(require("path"));function wn(e,t){try{let n=new URL(e);return ao.format(new URL(t,n))}catch{return""}}function co(e,t){let n=wn(e,t);if(gs(n))return n;for(let i of Y().includePath){let o=(0,pi.pathToFileURL)(sh(i)).toString()+"/",r=wn(o,t);if(gs(r))return r}return n}function rh(){let e=[];for(let t of Y().includePath){let n=(0,pi.pathToFileURL)(sh(t)).toString()+"/";e.push({path:t,uri:n})}return e}function sh(e,t=process.cwd()){return Dn.isAbsolute(e)?e:Dn.resolve(t,e)}function gs(e){try{let t=(0,pi.fileURLToPath)(e);return mi.statSync(t).isFile()}catch{return!1}}function ys(e){try{let t=(0,pi.fileURLToPath)(e);return mi.existsSync(t)===!1?void 0:mi.readFileSync(t,"utf8")}catch{return}}function ah(e){let t=ao.parse(e),n=t.pathname;if(n===null)return[];let i=[],o=n;for(;o!==Dn.dirname(o);)o=Dn.dirname(o),i.push(ao.format({protocol:t.protocol,slashes:!0,hostname:t.hostname,pathname:o}));return i}function un(e,t){if(e===void 0||t===void 0)return e;if(e.typeOrFunc.templateTypes?.length===0||e.templateTranslator===void 0)return e.typeOrFunc.isType()&&e.typeOrFunc.isTypeParameter?t.get(e.typeOrFunc.identifierToken)??e:e;let n=new Map;for(let[i,o]of e.templateTranslator)o?.identifierToken!==void 0&&t.has(o?.identifierToken)?n.set(i,t.get(o?.identifierToken)):n.set(i,un(o,t));return e.cloneWithTemplateTranslator(t)}var ie=class e{constructor(t,n,i){this.typeOrFunc=t;this.isHandler=n;this.templateTranslator=i}static create(t){return new e(t.typeOrFunc,t.isHandler,t.templateTranslator)}cloneWithTemplateTranslator(t){return new e(this.typeOrFunc,this.isHandler,t)}get scopePath(){return this.typeOrFunc.scopePath}get identifierToken(){return this.typeOrFunc.identifierToken}get identifierText(){return this.typeOrFunc.identifierToken.text}equals(t){if(t===void 0||this.typeOrFunc.equals(t.typeOrFunc)===!1)return!1;if(this.typeOrFunc.templateTypes!==void 0&&t.typeOrFunc.templateTypes!==void 0){if(this.typeOrFunc.templateTypes.length!==t.typeOrFunc.templateTypes.length)return!1;let n=this.typeOrFunc.templateTypes.map(o=>this.templateTranslator?.get(o)),i=t.typeOrFunc.templateTypes.map(o=>t.templateTranslator?.get(o));for(let o=0;o<n.length;o++)if(n[o]?.equals(i[o])===!1)return!1}return!0}};var Sv=require("node:assert");function uo(e){return Pe.create({identifierToken:e,scopePath:[],linkedNode:void 0,membersScopePath:void 0})}var lo=(()=>{let e=new Map;for(let t of Kc)e.set(t,uo(tt.createVirtual(t)));return e})(),vv=lo.get("int"),dn=new ie(vv),xv=lo.get("uint"),ch=new ie(xv),Nv=lo.get("float"),uh=new ie(Nv),kv=lo.get("double"),dh=new ie(kv);function Rv(e){let t=lo.get(e);if(t!==void 0)return t;Sv(!1)}var ln=uo(tt.createVirtual("bool")),fo=new ie(ln),Pv=uo(tt.createVirtual("void")),Cv=uo(tt.createVirtual("?")),_v=uo(tt.createVirtual("auto"));function bs(e){if(e.kind!=="Reserved")return;let t=e.text;if(t==="bool")return ln;if(t==="void")return Pv;if(t==="?")return Cv;if(t==="auto")return _v;if(e.isReservedToken()&&e.property.isNumber)return Rv(t)}var lh=Be.createVirtual("this"),fh=Be.createVirtual("value");var ct=require("node:assert");function Ts(e,t){return hh({allowObjectConstruct:!0},e,t)}function hh(e,t,n){if(t=Ot(t),n=Ot(n),t===void 0||n===void 0)return 255;let i=t.typeOrFunc,o=n.typeOrFunc;if(bh(t,n)===!1)return;if(i.isFunction()||o.isFunction())return!i.isFunction()||!o.isFunction()?void 0:Lv(i,o)?10:void 0;let r=i,s=o;return r.identifierText==="void"?0:s.identifierText==="?"||s.identifierText==="auto"?16:s.isPrimitiveOrEnum()?r.isPrimitiveOrEnum()?Ov(t,n):gh(t,n):r.isPrimitiveOrEnum()?wv(e,t,n):Ev(e,t,n)}var ph=new Map([["double",8],["float",4],["int64",8],["uint64",8],["int",4],["uint",4],["int16",2],["uint16",2],["int8",1],["uint8",1]]),mh=4;function Ov(e,t){let n=e.typeOrFunc,i=t.typeOrFunc;if(ct(n.isType()&&i.isType()),ct(n.isPrimitiveOrEnum()||i.isPrimitiveOrEnum()),n.equals(i))return 0;if(n.isEnumType()&&i.isEnumType()){for(let ee of n.multipleEnumCandidates??[])if(ee.type?.typeOrFunc.equals(i))return 0;return}if(e.identifierText==="bool"||t.identifierText==="bool")return;let o=e.identifierText,r=t.identifierText,s=n.identifierToken,u=i.identifierToken,f=s.isReservedToken()?s.property:void 0,g=u.isReservedToken()?u.property:void 0,v=ph.get(o)??mh,_=ph.get(r)??mh,w=0;return(f?.isFloat||f?.isDouble)&&(g?.isSignedInteger||g?.isUnsignedInteger)?w=9:(f?.isSignedInteger||f?.isUnsignedInteger)&&(g?.isFloat||g?.isDouble)?w=8:n.isEnumType()&&g?.isSignedInteger&&v===_?w=2:n.isEnumType()&&g?.isSignedInteger&&v!==_?w=3:f?.isSignedInteger&&g?.isUnsignedInteger?w=6:f?.isUnsignedInteger&&g?.isSignedInteger?w=7:v<_?w=4:v>_&&(w=5),w}var Dv=new Map([["double",["double","float","int64","uint64","int","uint","int16","uint16","int8","uint8"]],["float",["float","double","int64","uint64","int","uint","int16","uint16","int8","uint8"]],["int64",["int64","uint64","int","uint","int16","uint16","int8","uint8","double","float"]],["uint64",["uint64","int64","uint","int","uint16","int16","uint8","int8","double","float"]],["int",["int","uint","int64","uint64","int16","uint16","int8","uint8","double","float"]],["uint",["uint","int","uint64","int64","uint16","int16","uint8","int8","double","float"]],["int16",["int16","uint16","int","uint","int64","uint64","int8","uint8","double","float"]],["uint16",["uint16","int16","uint","int","uint64","int64","uint8","int8","double","float"]],["int8",["int8","uint8","int16","uint16","int","uint","int64","uint64","double","float"]],["uint8",["uint8","int8","uint16","int16","uint","int","uint64","int64","double","float"]]]);function gh(e,t){let n=e.typeOrFunc,i=t.typeOrFunc;ct(n.isType()&&i.isType()),ct(n.isPrimitiveOrEnum()===!1||i.isPrimitiveOrEnum());let o=Th(n),r;if(i.isNumberType()){let u=Dv.get(t.identifierText);ct(u!==void 0);for(let f of u){for(let g of o)if(Ot(g.returnType)?.identifierText===f){r=g;break}if(r!==void 0)break}}else for(let u of o)if(u.returnType?.typeOrFunc?.identifierToken.equals(i.identifierToken)){r=u;break}if(r===void 0)return;let s=r.returnType;return ct(s!==void 0),12+(gh(s,t)??0)}function wv(e,t,n){let i=t.typeOrFunc,o=n.typeOrFunc;return ct(i.isType()&&o.isType()),ct(i.isPrimitiveOrEnum()&&o.isPrimitiveOrEnum()===!1),yh(e,t,n)}function Ev(e,t,n){let i=t.typeOrFunc,o=n.typeOrFunc;if(ct(i.isType()&&o.isType()),ct(i.isPrimitiveOrEnum()===!1&&o.isPrimitiveOrEnum()===!1),t.identifierToken?.equals(n.identifierToken))return 0;if(Ss(i,o))return 14;let r=yh(e,t,n);if(r!==void 0)return r;let s=Th(i);for(let u of s)if(u.returnType?.equals(n))return 14}function Ot(e){if(e!==void 0)return e.identifierText==="int32"?dn:e.identifierText==="uint32"?ch:e}function yh(e,t,n){if(!e.allowObjectConstruct)return;let i=t.typeOrFunc,o=n.typeOrFunc;ct(i.isType()&&o.isType());let s=Ee(o.scopePath).lookupScope(o.identifierText);if(s?.linkedNode?.nodeName!=="Class")return;let u=s.lookupSymbol(o.identifierText);if(!(u===void 0||u?.isFunctionHolder()===!1))for(let f of u.toList()){if(f.parameterTypes.length!==1)continue;let g=f.parameterTypes[0];if(g===void 0||g.typeOrFunc.isType()===!1||g===n)continue;ct(e.allowObjectConstruct),e.allowObjectConstruct=!1;let v=hh(e,t,g);if(e.allowObjectConstruct=!0,v!==void 0)return 14+v}}function Ss(e,t){let n=e.linkedNode;if(e.isPrimitiveType())return!1;if(e.identifierToken.equals(t.identifierToken))return!0;if(ui(n)){if(e.baseList===void 0)return!1;for(let i of e.baseList)if(i?.typeOrFunc!==void 0&&i.typeOrFunc.isType()!==!1&&Ss(i.typeOrFunc,t))return!0}return!1}function Lv(e,t){if(e.parameterTypes.length!==t.parameterTypes.length)return!1;for(let n=0;n<e.parameterTypes.length;n++){let i=Ot(e.parameterTypes[n]),o=Ot(t.parameterTypes[n]);if(!(i===void 0||o===void 0)&&i.equals(o)===!1)return!1}return!0}function bh(e,t){if(e.typeOrFunc.isFunction()||t.typeOrFunc.isFunction())return!0;let n=e.typeOrFunc,i=t.typeOrFunc;if(n.templateTypes?.length!==i.templateTypes?.length)return!1;if(n.templateTypes===void 0||i.templateTypes===void 0||n.templateTypes.length==0)return!0;let o=n.templateTypes?.map(s=>e.templateTranslator?.get(s)),r=i.templateTypes?.map(s=>t.templateTranslator?.get(s));for(let s=0;s<o.length;s++){let u=Ot(o[s]),f=Ot(r[s]);if(!(u===void 0||f===void 0)&&(u.typeOrFunc.equals(f.typeOrFunc)===!1||bh(u,f)===!1))return!1}return!0}function Th(e){let t=[],n=Ee(e.scopePath).lookupScope(e.identifierText)?.symbolTable.values()??[];for(let i of n)i.isFunctionHolder()&&["opConv","opImplConv"].includes(i.identifierText)&&t.push(...i.toList());return t}var Sh=require("node:assert");function vh(e){return e!==void 0&&e.typeOrFunc instanceof Pe&&e.typeOrFunc.identifierText==="auto"}function Z(e){if(e===void 0)return"(undefined)";let t="";if(e.isHandler===!0&&(t=`${t}@`),e.typeOrFunc.isFunction()){let i=e.typeOrFunc,o=i.returnType,r=i.parameterTypes.map(s=>Z(s)).join(", ");return`${Z(o)}(${r})`+t}let n=e.typeOrFunc.templateTypes;return n!==void 0&&(t=`<${n.map(o=>Z(e.templateTranslator?.get(o))??o.text).join(", ")}>${t}`),e.typeOrFunc.identifierText+t}function hi(e){return e.map(t=>Z(t)).join(", ")}function vs(e){let t=e.identifierToken.text;if(e instanceof Pe)return t;if(e instanceof an)return`${e.returnType===void 0?"":Z(e.returnType)+" "}${t}(${hi(e.parameterTypes)})`;if(e instanceof Oe)return`${Z(e.type)} ${t}`;Sh(!1)}function cu(e,t=""){let n="";e.isGlobalScope()&&(n+=`${t}${e.getContext().filepath}
`);let i=[],o="\u251C\u2500\u2500 ",r="\u2514\u2500\u2500 ";for(let[s,u]of e.symbolTable)for(let f of u.toList())i.push(`${t}${o}${s} (${f.identifierToken.location.simpleFormat()})`);for(let[s,u]of e.childScopeTable){let f=[];u.linkedNode!==void 0&&f.push(u.linkedNode.nodeRange.getBoundingLocation().simpleFormat());for(let v of u.namespaceNodes)f.push(v.linkedToken.location.simpleFormat());let g=cu(u,t+"\u2502   ");g.length>0&&(g=`
`+g),i.push(`${t}${o}${s}::(${f.join(", ")})`+g)}return i.sort(),i.length>0&&(i[i.length-1]=i[i.length-1].replace(o,r)),n+=i.join(`
`),n}function xh(e,t){if(e!==void 0)return{symbol:e,scope:t}}function fn(e,t){let n=e.symbolTable.get(t);if(n!==void 0)return{symbol:n,scope:e};if(e.parentScope!==void 0)return fn(e.parentScope,t)}function xs(e,t){let n=t.toList()[0];if(n.isType()||n.accessRestriction===void 0)return!0;let i=Ee(n.scopePath);if(n.accessRestriction==="Private")return Gc(e,i);if(n.accessRestriction==="Protected"){if(i.linkedNode===void 0)return!1;let o=e.takeParentByNode(["Class","Interface"]);if(o===void 0||o.parentScope===void 0)return!1;let r=o.parentScope.lookupSymbol(o.key);if(r===void 0||r.isType()===!1||i.parentScope===void 0)return!1;let s=i.parentScope.lookupSymbol(i.key);return s===void 0||s.isType()===!1?!1:Ss(r,s)}else Sh(!1)}function uu(e){return e.dataType.identifier}function Ns(e,t,n){if(e===void 0||t===void 0)return!1;if(e.typeOrFunc.isType()&&e.typeOrFunc.multipleEnumCandidates!==void 0){let o=Ee(t.scopePath??[]).lookupScope(t.identifierText)?.lookupSymbol(e.typeOrFunc.identifierText);o?.isVariable()&&le().getContext().info.reference.push({fromToken:e.typeOrFunc.identifierToken,toSymbol:o})}}function ut(e,t,n){return dt(e,t,n)?!0:(A.error(n.getBoundingLocation(),`'${Z(e)}' cannot be converted to '${Z(t)}'.`),!1)}function dt(e,t,n){return e===void 0||t===void 0?!0:Ts(e,t)===void 0?!1:(Ns(e,t,n),!0)}function Rh(e){return Ch(e)}function Ph(e){let t=Ch(e);return t.sideEffect(),t.returnType}var Nh=new Map([["TooManyArguments",0],["FewerArguments",0],["InvalidNamedArgumentOrder",10],["DuplicateNamedArgument",10],["NotFoundNamedArgument",10],["ParameterMismatch",5]]);function gi(e){return typeof e!="number"}function Ch(e){let{callerIdentifier:t,calleeFuncHolder:n,calleeDelegateVariable:i}=e,o=Iv(e);if(o!==void 0)return o;let r,s={reason:"TooManyArguments"};for(let u of n.toList()){let f=[],g=Fv(e,u,f);if(gi(g)){Nh.get(g.reason)>=Nh.get(s.reason)&&(s=g);continue}(r===void 0||g<r.cost)&&(r={function:u,cost:g,sideEffects:f})}return r!==void 0?{bestMatching:r.function,returnType:un(r.function.returnType,e.calleeTemplateTranslator),sideEffect:()=>{r?.sideEffects.forEach(u=>u()),le().info.reference.push({toSymbol:i??r.function,fromToken:t}),kh(e.callerArgs,r.function)}}:{bestMatching:void 0,returnType:void 0,sideEffect:()=>{qv(e,s);let u=n.first;le().info.reference.push({toSymbol:i??u,fromToken:t}),kh(e.callerArgs,u)}}}function kh(e,t){if(t.functionScopePath===void 0)return;let n=Ee(t.functionScopePath);for(let i of e){if(i.name===void 0)continue;let o=i.name.text;if(t.linkedNode.paramList.findIndex(u=>u.identifier?.text===o)===-1)continue;let s=n.lookupSymbol(o);s===void 0||s.isVariable()===!1||le().info.reference.push({toSymbol:s,fromToken:i.name})}}function Iv(e){let{callerIdentifier:t,callerArgs:n,calleeFuncHolder:i,calleeTemplateTranslator:o}=e;if(i.first.linkedNode.nodeName!=="FuncDef")return;let r=ie.create({typeOrFunc:i.first,templateTranslator:o});if(n.length===1&&dt(n[0].type,r))return{bestMatching:i.first,returnType:un(r,o),sideEffect:()=>{le().info.reference.push({toSymbol:i.first,fromToken:t})}}}function Fv(e,t,n){let{callerArgs:i}=e,o=0;if(t.parameterTypes.length<i.length&&!t.linkedNode.paramList.at(-1)?.isVariadic)return{reason:"TooManyArguments"};let r=Av(e,t,n);if(gi(r))return r;o+=r;let s=Mv(e,t,n);return gi(s)?s:(o+=s,o)}function Av(e,t,n){let{callerArgs:i}=e,o=0,r=!1;for(let s=0;s<i.length;s++){let u=i[s].name?.text;if(u===void 0){if(r)return{reason:"InvalidNamedArgumentOrder",invalidArgumentIndex:s};continue}r=!0;for(let f=0;f<s;f++)if(i[f].name?.text===u)return{reason:"DuplicateNamedArgument",nameIndex:s};for(let f=0;f<t.parameterTypes.length;f++){let g=t.linkedNode.paramList[f].identifier?.text;if(u===g){let v=du(e,s,t.parameterTypes[f],n);if(gi(v))return v;o+=v;break}if(f===t.parameterTypes.length-1)return{reason:"NotFoundNamedArgument",nameIndex:s}}}return o}function Mv(e,t,n){let{callerArgs:i}=e,o=0;for(let r=0;r<t.parameterTypes.length;r++){if(r>=i.length){if(t.linkedNode.paramList[r].defaultExpr!==void 0)break;return{reason:"FewerArguments"}}if(i[r].name!==void 0)break;let s=du(e,r,t.parameterTypes[r],n);if(gi(s))return s;o+=s}if(t.linkedNode.paramList.at(-1)?.isVariadic)for(let r=t.parameterTypes.length;r<i.length;r++){let s=du(e,r,t.parameterTypes.at(-1),n);if(gi(s))return s;o+=s}return o}function du(e,t,n,i){let{callerArgs:o,calleeTemplateTranslator:r}=e,s=un(n,r),u=o[t].type,f=Ts(u,s);return f===void 0?{reason:"ParameterMismatch",mismatchIndex:t,expectedType:s,actualType:u}:(i.push(()=>{Ns(u,s,o[t].range)}),f)}function qv(e,t){let{callerRange:n,callerArgs:i,calleeFuncHolder:o,calleeTemplateTranslator:r}=e;if(t.reason==="InvalidNamedArgumentOrder"){let s=i[t.invalidArgumentIndex].range;A.error(s?.getBoundingLocation()??n.getBoundingLocation(),"Positional arguments cannot be passed after named arguments.");return}else if(t.reason==="DuplicateNamedArgument"){let s=i[t.nameIndex].name?.location;A.error(s??n.getBoundingLocation(),`Duplicate named argument '${i[t.nameIndex].name?.text}'.`);return}else if(t.reason==="NotFoundNamedArgument"){let s=i[t.nameIndex].name?.location;A.error(s??n.getBoundingLocation(),`Named argument '${i[t.nameIndex].name?.text}' does not found in '${o.identifierText}'.`);return}if(o.count===1){let s=o.first;if(t.reason==="TooManyArguments"||t.reason==="FewerArguments")A.error(n.getBoundingLocation(),`Function has ${s.linkedNode.paramList.length} parameters, but ${i.length} were provided.`);else{let u=Z(t.actualType),f=Z(t.expectedType),g=i[t.mismatchIndex].range;A.error(g?.getBoundingLocation()??n.getBoundingLocation(),`Cannot convert '${u}' to parameter type '${f}'.`)}}else{let s=`No viable function.
`;s+=`Arguments types: (${hi(i.map(u=>u.type))})
`,s+="Candidates considered:";for(let u of o.overloadList){let f=u.parameterTypes.map(g=>un(g,r));s+=`
(${hi(f)})`}A.error(n.getBoundingLocation(),s)}}function _h(e,t){let n=new cn(e);n.activateContext();for(let i of t)n.includeExternalScope(i.getPureGlobalScope());return n}var yi=class{getPureGlobalScope(){return this._pureGlobalScope===void 0&&(this._pureGlobalScope=new cn(this.globalScope.getContext()),this._pureGlobalScope.includeExternalScope(this.globalScope)),this._pureGlobalScope}constructor(t,n){this.filepath=t,this.globalScope=n}};var po=require("node:assert");function bi(e){return jv(e)}function ks(e,t){if(!(e.typeOrFunc.isType()===!1||t.typeOrFunc.isType()===!1)){if(e=e.typeOrFunc.isEnumType()?dn:e,t=t.typeOrFunc.isEnumType()?dn:t,po(e.typeOrFunc.isType()&&t.typeOrFunc.isType()),e.typeOrFunc.isNumberType()&&t.typeOrFunc.isNumberType())return Wv(e,t);if(e.typeOrFunc.isNumberType()){if(dt(t,e))return e}else if(t.typeOrFunc.isNumberType()&&dt(e,t))return t}}function wh(e,t){if(dt(e,t))return e;if(dt(t,e))return t}function jv(e){let t=Dh({callerOperator:e.callerOperator,alias:e.alias,lhs:e.lhs,rhs:e.rhs,rhsRange:e.rhsRange,rhsArgNames:e.rhsArgNames});if(e.alias_r===void 0)if(lu(t)){Oh(e,t);return}else return t;else if(lu(t)===!1)return t;let n=Dh({callerOperator:e.callerOperator,alias:e.alias_r,lhs:e.rhs,rhs:e.lhs,rhsRange:e.lhsRange,rhsArgNames:e.rhsArgNames});if(lu(n)){Oh(e,t,n);return}else return n}function Oh(e,t,n){let{callerOperator:i,alias:o,alias_r:r,lhs:s,rhs:u}=e,f=us(i,1,1);if(t.reason==="MissingAliasOperator")if(t.foundButNotFunction){A.error(f,`The operator '${o}' in ${Z(s)} is found, but it is not a function.`);return}else if(r!==void 0){A.error(f,`The operator '${Z(s)}::${o}' or '${Z(u)}::${r}' is not defined.`);return}else{A.error(f,`The operator '${o}' in ${Z(s)} is not defined.`);return}else if(t.reason==="MismatchOverload"){let g=Array.isArray(u)?hi(u):Z(u);A.error(f,`The operator '${o}' in ${Z(s)} does not match the argument types ${g}.`);return}po(!1)}function lu(e){return e===void 0?!1:"reason"in e}function Dh(e){let{callerOperator:t,alias:n,lhs:i,rhs:o,rhsRange:r,rhsArgNames:s}=e,u=Array.isArray(e.rhs)?e.rhs:[e.rhs];if(i.typeOrFunc.isType()&&i.typeOrFunc.isPrimitiveType())return{reason:"MissingAliasOperator"};if(i.scopePath===void 0)return{reason:"MissingAliasOperator"};let f=Ee(i.scopePath).lookupScope(i.identifierText)?.lookupSymbol(n);if(f===void 0)return{reason:"MissingAliasOperator"};if(f.isFunctionHolder()===!1)return{reason:"MissingAliasOperator",foundButNotFunction:!0};let g=u.map((_,w)=>({name:s!==void 0?s[w]:void 0,range:void 0,type:_})),v=Rh({callerIdentifier:t,callerRange:new D(t,t),callerArgs:g,calleeFuncHolder:f,calleeTemplateTranslator:i.templateTranslator});return v.bestMatching===void 0?{reason:"MismatchOverload"}:(v.sideEffect(),v.returnType)}var Bv=["double","float","int64","uint64","int","uint","int16","uint16","int8","uint"];function Wv(e,t){e=Ot(e),t=Ot(t),po(e.typeOrFunc.isType()&&e.typeOrFunc.isNumberType()),po(t.typeOrFunc.isType()&&t.typeOrFunc.isNumberType());for(let n of Bv){if(e.identifierText===n)return e;if(t.identifierText===n)return t}po(!1)}var Hv=ue(require("node:assert"));function Rs(e){if(e?.scopePath===void 0)return;let t=e.typeOrFunc.identifierText,n=Ee(e.scopePath).lookupScope(t);return n!==void 0?n.lookupSymbol(t):void 0}function Eh(e,t,n,i){let o=i.typeOrFunc.identifierToken;o?.isVirtual()===!1&&le().info.reference.push({toSymbol:i.typeOrFunc,fromToken:e});let r=i.typeOrFunc;if(r.isType()&&r.isPrimitiveOrEnum()){if(n.length!==1){let s=n.length===0?`Primitive type '${o.text}' requires an argument`:`Too many arguments for type '${o.text}'`;A.error(t.getBoundingLocation(),s)}else ut(n[0],i,t);return i}else{if(n.length!==0){let s=()=>Z(n[0]),u=n.length===1?`Type '${o.text}' does not have a constructor that accepts the argument '${s()}'`:`Too many arguments for type '${o.text}'`;A.error(t.getBoundingLocation(),u)}return i}}function Lh(e,t){Hv(t.identifier.text==="super");let n=t.nodeRange,i=e.takeParentByNode(["Func"]),o=i?.takeParentByNode(["Class"]),r=i?.linkedNode?.nodeName==="Func"&&hm(i.linkedNode.head);if(i===void 0||o===void 0||r===!1){A.error(n.getBoundingLocation(),"Cannot call 'super()' in a non-constructor method.");return}let s=o.parentScope?.lookupSymbol(o.key);if(!s?.isType()){A.error(n.getBoundingLocation(),`Class '${o.key}' does not exist.`);return}if(s.baseList===void 0||s.baseList.length===0){A.error(n.getBoundingLocation(),`Class '${o.key}' does not have a base class.`);return}}var En=require("node:assert");function mo(e,t){le().info.scopeRegion.push({boundingLocation:t.getBoundingLocation(),targetScope:e})}function Mh(e,t){if(t.head===qt){Bt(e,t.statBlock);return}let n=fn(e,t.identifier.text);if(n===void 0){A.error(t.identifier.location,`'${t.identifier}' is not defined.`);return}let i=jh(e,t.typeTemplates,n.symbol?.first?.templateTypes);$v(e,t.paramList),Bt(e,t.statBlock)}function qh(e,t,n){let i=Je(e,t.type);for(let o of t.variables){let r=o.initializer;if(r===void 0)continue;let s=mu(e,i,o.identifier,r);s!==void 0&&vh(i)&&(i=s,i!==void 0&&le().info.autoTypeResolution.push({autoToken:o.identifier,resolvedType:s}))}pu(e,i,t,n)}function Vv(e,t,n){let i=Oe.create({identifierToken:t.identifier,scopePath:e.scopePath,type:Je(e,t.type),isInstanceMember:!1,accessRestriction:void 0});e.insertSymbolAndCheck(i)}function pu(e,t,n,i){for(let o of n.variables){let r=Oe.create({identifierToken:o.identifier,scopePath:e.scopePath,type:t,isInstanceMember:i,accessRestriction:n.accessor});e.insertSymbolAndCheck(r)}}function mu(e,t,n,i){if(i.nodeName==="InitList")return Bh(e,i);if(i.nodeName==="Assign"){let o=Le(e,i);return ut(o,t,i.nodeRange),o}else if(i.nodeName==="ArgList")return t===void 0||t.typeOrFunc.isFunction()?void 0:gu(e,n,i,t)}function Bt(e,t){mo(e,t.nodeRange);for(let n of t.statementList)n.nodeName==="Var"?qh(e,n,!1):pn(e,n)}function $v(e,t){for(let n of t)n.defaultExpr===void 0||n.defaultExpr.nodeName==="ExprVoid"||hu(e,n.defaultExpr)}function Je(e,t){let n=t.isArray?void 0:Uv(e,t);if(n!==void 0)return n;let i=t.dataType.identifier,o=t.scope!==void 0?Ps(e,t.scope)??e:e,r=t.typeTemplates,s=i.text;if(t.isArray){s=Y().builtinArrayType;let v={...t};v.isArray=!1,r=[v]}let u=fn(o,s);if(u!==void 0&&zv(u.symbol)&&u.scope.parentScope!==void 0&&(u=xh(u.scope.parentScope.lookupSymbol(s),u.scope.parentScope)),u===void 0){A.error(i.location,`'${s}' is not defined.`);return}let{symbol:f,scope:g}=u;if(f.isFunctionHolder()&&f.first.linkedNode.nodeName==="FuncDef")return Ih(e,i,f.first,g,!0);if(f instanceof Pe){let v=jh(e,r,f.templateTypes);return Ih(e,i,f,g,void 0,v)}else{A.error(i.location,`'${s}' is not a type.`);return}}function zv(e){if(e.isFunctionHolder()===!1)return!1;let t=e.first.linkedNode;return t.nodeName!=="Func"?!1:rn(t.head)===!1}function Ih(e,t,n,i,o,r){return le().info.reference.push({toSymbol:n,fromToken:t}),ie.create({typeOrFunc:n,isHandler:o,templateTranslator:r})}function Uv(e,t){let n=t.dataType.identifier;if(n.kind!=="Reserved")return;t.scope!==void 0&&(Ps(e,t.scope),A.error(n.location,"A primitive type cannot have namespace qualifiers."));let i=bs(n);if(i!==void 0)return new ie(i)}function jh(e,t,n){if(n===void 0)return;let i=new Map;for(let o=0;o<t.length;o++){if(o>=n.length){A.error(t[t.length-1].nodeRange.getBoundingLocation(),"Too many template types.");break}let r=t[o];i.set(n[o],Je(e,r))}return i}function Bh(e,t){for(let n of t.initList)n.nodeName==="Assign"?Le(e,n):n.nodeName==="InitList"&&Bh(e,n)}function Ps(e,t){let n=t.isGlobal?e.getGlobalScope():e,i=Fh(n,t);for(;!(i.ok||n.parentScope===void 0);){n=n.parentScope;let o=Fh(n,t);(o.ok||o.accessIndex>i.accessIndex)&&(i=o)}return i.sideEffects.forEach(o=>o()),i.accessScope}function Fh(e,t){let n=[],i=t.nodeRange.end.next,o=e,r;for(r=0;r<t.scopeList.length;++r){let u=t.scopeList[r],f=o.lookupScope(u.text);if(f===void 0||f.isFunctionHolderScope()){n.push(()=>{A.error(t.scopeList[r].location,`Undefined scope: ${t.scopeList[r].text}`)});break}o=f,n.push(()=>{le().info.autocompleteNamespaceAccess.push({autocompleteLocation:us(u,0,2),accessScope:f,namespaceToken:u,tokenAfterNamespaces:i})})}return{ok:r===t.scopeList.length&&o.lookupSymbol(i?.text??"")!==void 0,accessScope:o,accessIndex:r,sideEffects:n}}function pn(e,t){switch(t.nodeName){case"If":Yv(e,t);break;case"For":{let n=e.insertScope(Pt(),t);Kv(n,t);break}case"ForEach":{let n=e.insertScope(Pt(),t);Qv(n,t);break}case"While":{let n=e.insertScope(Pt(),t);Jv(n,t);break}case"Return":ex(e,t);break;case"StatBlock":{let n=e.insertScope(Pt(),t);Bt(n,t);break}case"Break":break;case"Continue":break;case"DoWhile":{let n=e.insertScope(Pt(),t);Xv(n,t);break}case"Switch":Gv(e,t);break;case"ExprStat":fu(e,t);break;case"Try":{let n=e.insertScope(Pt(),t);Zv(n,t);break}default:break}}function Gv(e,t){Le(e,t.assign);for(let n of t.caseList)tx(e,n)}function Kv(e,t){t.initial.nodeName==="Var"?qh(e,t.initial,!1):fu(e,t.initial),t.condition!==void 0&&fu(e,t.condition);for(let n of t.incrementList)Le(e,n);t.statement!==void 0&&pn(e,t.statement)}function Qv(e,t){Le(e,t.assign);for(let n of t.variables)Vv(e,n,t.assign);t.statement!==void 0&&pn(e,t.statement)}function Jv(e,t){let n=Le(e,t.assign);ut(n,new ie(ln),t.assign.nodeRange),t.statement!==void 0&&pn(e,t.statement)}function Xv(e,t){if(pn(e,t.statement),t.assign===void 0)return;let n=Le(e,t.assign);ut(n,new ie(ln),t.assign.nodeRange)}function Yv(e,t){let n=Le(e,t.condition);ut(n,new ie(ln),t.condition.nodeRange),t.thenStat!==void 0&&pn(e,t.thenStat),t.elseStat!==void 0&&pn(e,t.elseStat)}function fu(e,t){if(t.assign===void 0)return;let n=Le(e,t.assign);n?.isHandler!==!0&&n?.typeOrFunc.isFunction()&&A.error(t.assign.nodeRange.getBoundingLocation(),"Function call without handler.")}function Zv(e,t){Bt(e,t.tryBlock),t.catchBlock!==void 0&&Bt(e,t.catchBlock)}function ex(e,t){let n=t.assign!==void 0?Le(e,t.assign):void 0,i=e.takeParentByNode(["Func","VirtualProp","Lambda"]);if(!(i===void 0||i.linkedNode===void 0))if(i.linkedNode.nodeName==="Func"){let o=i.parentScope;En(o!==void 0);let r=o.parentScope?.symbolTable.get(o.key);if(r?.isFunctionHolder()===!1)return;let s=r.first;for(let f of r.toList())if(f.linkedNode===i.linkedNode){s=f;break}let u=s.returnType?.typeOrFunc;if(u?.isType()&&u?.identifierText==="void"){if(t.assign===void 0)return;A.error(t.nodeRange.getBoundingLocation(),"Function does not return a value.")}else ut(n,s.returnType,t.nodeRange)}else if(i.linkedNode.nodeName==="VirtualProp"){let o=i.key;if(o.startsWith("get_")===!1){if(t.assign===void 0)return;A.error(t.nodeRange.getBoundingLocation(),"Property setter does not return a value.");return}let s=o.substring(4,o.length),u=i.parentScope?.symbolTable.get(s);if(u===void 0||!(u instanceof Oe))return;ut(n,u.type,t.nodeRange)}else i.linkedNode.nodeName,"Lambda"}function tx(e,t){t.expr!==void 0&&hu(e,t.expr);for(let n of t.statementList)pn(e,n)}function hu(e,t){function n(f){return"text"in f}function i(f){return n(f)?nx(f):1}let o=[];for(let f=t;o.push([ix(e,f.head),f.head.nodeRange]),f.tail!==void 0;)o.push(f.tail.operator),f=f.tail.expression;let r=[],s=[];for(;o.length>0||r.length>0;)r.length===0||o.length>0&&i(o[0])>i(r[r.length-1])?r.push(o.shift()):s.push(r.pop());let u=[];for(;s.length>0;){let f=s.shift();if(n(f)){let g=u.pop(),v=u.pop();if(v===void 0||g===void 0)return;u.push([bx(e,f,v[0],g[0],v[1],g[1]),new D(v[1].start,g[1].end)])}else u.push(f)}return u.length>0?u[0][0]:void 0}function nx(e){switch(e.text){case"**":return 0;case"*":case"/":case"%":return-1;case"+":case"-":return-2;case"<<":case">>":case">>>":return-3;case"&":return-4;case"^":return-5;case"|":return-6;case"<":case">":case"<=":case">=":return-7;case"==":case"!=":case"xor":case"^^":case"is":case"!is":return-8;case"and":case"&&":return-9;case"or":case"||":return-10;default:En(!1)}}function ix(e,t){if(t.exprTerm!==1){if(t.exprTerm===2)return ox(e,t)}}function ox(e,t){let n=rx(e,t.value);for(let i of t.postOps){if(n===void 0)break;n=ax(e,i,n,t.nodeRange)}for(let i of t.preOps){if(n===void 0)break;n=sx(e,i,n)}return n}function rx(e,t){switch(t.nodeName){case"ConstructCall":{let n=Je(e,t.type);return n===void 0?void 0:gu(e,t.type.dataType.identifier,t.argList,n)}case"FuncCall":return px(e,t);case"VarAccess":return hx(e,t);case"Cast":return dx(e,t);case"Literal":return fx(e,t);case"Assign":return Le(e,t);case"Lambda":return lx(e,t);default:break}}function gu(e,t,n,i){let o=Rs(i);if(o===void 0||o.isFunctionHolder()===!1){let r=n.argList.map(s=>Le(e,s.assign));return Eh(t,n.nodeRange,r,i)}return Ti(e,t,n,o,i.templateTranslator),i}function sx(e,t,n){return n}function ax(e,t,n,i){if(t.postOp===1)return cx(e,t,n);if(t.postOp===2)return ux(e,t,n,i)}function cx(e,t,n){if(!(n.typeOrFunc instanceof Pe)){A.error(t.nodeRange.getBoundingLocation(),"Invalid access to type.");return}let i=is(t.nodeRange.start,t.nodeRange.start.getNextOrSelf());le().info.autocompleteInstanceMember.push({autocompleteLocation:i,targetType:n.typeOrFunc});let o=t.member,r=gm(o),s=r?o.identifier:o;if(s===void 0)return;if(ui(n.typeOrFunc.linkedNode)===!1){A.error(s.location,`'${s.text}' is not a member.`);return}let u=n.typeOrFunc.membersScopePath;if(u!==void 0)if(r){let f=Ee(u).lookupSymbol(s.text);if(f===void 0){A.error(s.location,`'${s.text}' is not defined.`);return}if(f.isFunctionHolder())return Ti(e,s,o.argList,f,n.templateTranslator);if(f.isVariable()&&f.type?.typeOrFunc.isFunction()){let g=f.type.typeOrFunc.toHolder();return Ti(e,s,o.argList,g,n.templateTranslator,f)}A.error(s.location,`'${s.text}' is not a method.`);return}else return Wh(e,Ee(u),s)}function ux(e,t,n,i){let o=t.indexingList.map(r=>Le(e,r.assign));return bi({callerOperator:t.nodeRange.end,alias:"opIndex",lhs:n,lhsRange:i,rhs:o,rhsRange:t.nodeRange,rhsArgNames:t.indexingList.map(r=>r.identifier)})}function dx(e,t){let n=Je(e,t.type);return Le(e,t.assign),n}function lx(e,t){let n=e.insertScope(Pt(),t);for(let i of t.paramList){if(i.identifier===void 0)continue;let o=Oe.create({identifierToken:i.identifier,scopePath:e.scopePath,type:i.type!==void 0?Je(e,i.type):void 0,isInstanceMember:!1,accessRestriction:void 0});n.insertSymbolAndCheck(o)}t.statBlock!==void 0&&Bt(n,t.statBlock)}function fx(e,t){let n=t.value;if(n.isNumberToken())switch(n.numberLiteral){case"Integer":return dn;case"Float":return uh;case"Double":return dh}if(n.kind==="String"){if(n.text[0]==="'"&&Y().characterLiterals)return dn;let i=le().getContext().builtinStringType;return i===void 0?void 0:new ie(i)}if(n.text==="true"||n.text==="false")return fo}function px(e,t){let n=e;if(t.scope!==void 0){let s=Ps(e,t.scope);if(s===void 0)return;n=s}let i=fn(n,t.identifier.text);if(i?.symbol===void 0){t.identifier.text==="super"?Lh(e,t):A.error(t.identifier.location,`'${t.identifier.text}' is not defined.`);return}let[o,r]=[i.symbol,i.scope];if(o instanceof Pe){let s=new ie(o);return gu(e,t.identifier,t.argList,s)}if(o.isVariable()&&o.type?.typeOrFunc.isFunction())return Ti(e,t.identifier,t.argList,new Ui(o.type.typeOrFunc),void 0,o);if(o instanceof Oe)return mx(e,t,o);if(o.isFunctionHolder()===!1){A.error(t.identifier.location,`'${t.identifier.text}' is not a function.`);return}return Ti(e,t.identifier,t.argList,o,void 0)}function mx(e,t,n){let i=n.type;if(i===void 0||i.scopePath===void 0){A.error(t.identifier.location,`'${t.identifier.text}' is not callable.`);return}let o=Ee(i.scopePath).lookupScope(i.typeOrFunc.identifierText);if(o===void 0)return;let r=o.lookupSymbol("opCall");if(r===void 0||r.isFunctionHolder()===!1){A.error(t.identifier.location,`'opCall' is not defined in type '${i.typeOrFunc.identifierText}'.`);return}return Ti(e,t.identifier,t.argList,r,i.templateTranslator)}function Ti(e,t,n,i,o,r){le().info.functionCall.push({callerIdentifier:t,callerArgumentsNode:n,calleeFuncHolder:i,calleeTemplateTranslator:o});let s=yx(e,n),u=n.argList.map((f,g)=>({name:f.identifier,range:f.assign.nodeRange,type:s[g]}));return Ph({callerIdentifier:t,callerRange:n.nodeRange,callerArgs:u,calleeFuncHolder:i,calleeTemplateTranslator:o,calleeDelegateVariable:r})}function hx(e,t){let n=e;if(t.scope!==void 0){let o=e.takeParentByNode(["Class"])??e,r=Ps(o,t.scope);if(r===void 0)return;n=r}if(t.identifier===void 0)return;let i=t.identifier;return Wh(e,n,i)}function Wh(e,t,n){let i=fn(t,n.text);if(i===void 0){let o=gx(e,t,n);if(o!==void 0)return o;A.error(n.location,`'${n.text}' is not defined.`);return}if(i.symbol.isType()){A.error(n.location,`'${n.text}' is type.`);return}if(xs(e,i.symbol)===!1){A.error(n.location,`'${n.text}' is not public member.`);return}return i.symbol.toList()[0].identifierToken.location.path!==""&&le().info.reference.push({toSymbol:i.symbol.toList()[0],fromToken:n}),i.symbol instanceof Oe?i.symbol.type:new ie(i.symbol.first)}function gx(e,t,n){t=e===t?le():t;let i=t.scopePath,o=[];for(let s of le().getContext().enumScopeList)if(i.length===0||i.every((f,g)=>f===s.scopePath[g])){let f=s.lookupSymbol(n.text);f!==void 0&&f.isVariable()&&o.push(f)}if(o.length===0)return;if(o.length==1)return o[0].type;let r=Pe.create({identifierToken:n,scopePath:[],linkedNode:{nodeName:"Enum",nodeRange:new D(n,n),scopeRange:new D(n,n),entity:void 0,identifier:n,memberList:[],enumType:void 0},membersScopePath:void 0,multipleEnumCandidates:o});return new ie(r)}function yx(e,t){let n=[];for(let i of t.argList)n.push(Le(e,i.assign));return n}function Le(e,t){let n=t,i=Ah(e,t.condition);for(;n.tail!==void 0;){let o=Ah(e,n.tail.assign.condition);i=Px(e,n.tail.operator,i,o,n.condition.nodeRange,n.tail.assign.condition.nodeRange),n=n.tail.assign}return i}function Ah(e,t){let n=hu(e,t.expr);if(t.ternary===void 0)return n;ut(n,new ie(ln),t.expr.nodeRange);let i=Le(e,t.ternary.trueAssign),o=Le(e,t.ternary.falseAssign);if(i===void 0&&o!==void 0)return o;if(i!==void 0&&o===void 0)return i;if(!(i===void 0||o===void 0)){if(dt(i,o))return o;if(dt(o,i))return i;A.error(is(t.ternary.trueAssign.nodeRange.start,t.ternary.falseAssign.nodeRange.end),`Type mismatches between '${Z(i)}' and '${Z(o)}'.`)}}function bx(e,t,n,i,o,r){if(t.isReservedToken()!==!1&&!(n===void 0||i===void 0)){if(t.property.isMathOp)return vx(e,t,n,i,o,r);if(t.property.isCompOp)return Nx(e,t,n,i,o,r);if(t.property.isLogicOp)return Rx(e,t,n,i,o,r);if(t.property.isBitOp)return Tx(e,t,n,i,o,r);En(!1)}}function Tx(e,t,n,i,o,r){let s=ks(n,i);if(s)return s;let u=Sx.get(t.text);En(u!==void 0);let[f,g]=u;return bi({callerOperator:t,alias:f,alias_r:g,lhs:n,lhsRange:o,rhs:i,rhsRange:r})}var Sx=new Map([["&",["opAnd","opAnd_r"]],["|",["opOr","opOr_r"]],["^",["opXor","opXor_r"]],["<<",["opShl","opShl_r"]],[">>",["opShr","opShr_r"]],[">>>",["opShrU","opShrU_r"]]]);function vx(e,t,n,i,o,r){let s=ks(n,i);if(s)return s;let u=xx.get(t.text);En(u!==void 0);let[f,g]=u;return bi({callerOperator:t,alias:f,alias_r:g,lhs:n,lhsRange:o,rhs:i,rhsRange:r})}var xx=new Map([["+",["opAdd","opAdd_r"]],["-",["opSub","opSub_r"]],["*",["opMul","opMul_r"]],["/",["opDiv","opDiv_r"]],["%",["opMod","opMod_r"]],["**",["opPow","opPow_r"]]]);function Nx(e,t,n,i,o,r){if(wh(n,i))return fo;let s=kx.get(t.text);return En(s!==void 0),bi({callerOperator:t,alias:s,lhs:n,lhsRange:o,rhs:i,rhsRange:r})}var kx=new Map([["==","opEquals"],["!=","opEquals"],["<","opCmp"],["<=","opCmp"],[">","opCmp"],[">=","opCmp"],["is","opEquals"],["!is","opEquals"]]);function Rx(e,t,n,i,o,r){return ut(n,fo,o),ut(i,fo,r),new ie(ln)}function Px(e,t,n,i,o,r){if(n===void 0||i===void 0)return;if(t.text==="="&&dt(i,n))return n;let s=ks(n,i);if(s)return s;let u=Cx.get(t.text);return En(u!==void 0),bi({callerOperator:t,alias:u,lhs:n,lhsRange:o,rhs:i,rhsRange:r})}var Cx=new Map([["=","opAssign"],["+=","opAddAssign"],["-=","opSubAssign"],["*=","opMulAssign"],["/=","opDivAssign"],["%=","opModAssign"],["**=","opPowAssign"],["&=","opAndAssign"],["|=","opOrAssign"],["^=","opXorAssign"],["<<=","opShlAssign"],[">>=","opShrAssign"],[">>>=","opUShrAssign"]]);function Hh(e,t){let{globalScope:n,analyzeQueue:i}=t;for(n.commitContext();i.length>0;){let o=i.shift();o!==void 0&&o()}return new yi(e,n)}function Vh(e,t,n,i){for(let o of t){let r=o.nodeName;r==="Enum"?Ox(e,o):r==="TypeDef"?Ex(e,o):r==="Class"?$h(e,o,n,i):r==="Mixin"?Fx(e,o,n,i):r==="Interface"?Lx(e,o,n,i):r==="FuncDef"?Xh(e,o,n,i):r==="VirtualProp"?yu(e,o,n,i,!1):r==="Var"?Jh(e,o,n,!1):r==="Func"?Kh(e,o,n,i,!1):r==="Namespace"&&_x(e,o,n)}}function _x(e,t,n){if(t.namespaceList.length===0)return;let i=e;for(let o=0;o<t.namespaceList.length;o++){let r=t.namespaceList[o];i=i.insertScopeAndCheck(r,void 0),i.pushNamespaceNode(t,r)}Vh(i,t.script,n,n),mo(i,t.nodeRange)}function Ox(e,t){let n=Pe.create({identifierToken:t.identifier,scopePath:e.scopePath,linkedNode:t,membersScopePath:void 0});if(e.insertSymbolAndCheck(n)===!1)return;let i=e.insertScopeAndCheck(t.identifier,t);n.assignMembersScopePath(i.scopePath),Dx(i,t.memberList,new ie(n))}function Dx(e,t,n){for(let i of t)e.insertSymbolAndCheck(Oe.create({identifierToken:i.identifier,scopePath:e.scopePath,type:n,isInstanceMember:!1,accessRestriction:void 0}))}function $h(e,t,n,i){let o=Pe.create({identifierToken:t.identifier,scopePath:e.scopePath,linkedNode:t,membersScopePath:void 0});if(e.insertSymbolAndCheck(o)===!1)return;let r=e.insertScopeAndCheck(t.identifier,t);o.assignMembersScopePath(r.scopePath);let s=Oe.create({identifierToken:lh,scopePath:e.scopePath,type:new ie(o),isInstanceMember:!1,accessRestriction:"Private"});r.insertSymbolAndCheck(s);let u=zh(r,t.typeTemplates);u.length>0&&o.assignTemplateTypes(u),o.assignBaseList(Uh(r,t)),i.push(()=>{wx(r,t,n,i),i.push(()=>{if(o.baseList===void 0)return;Gh(r,o.baseList);let f=o.baseList.length>=1?o.baseList[0]:void 0,g=Rs(f);if(g?.isFunctionHolder())for(let v of g.toList()){let _=v.clone({identifierToken:Be.createVirtual("super",new D(v.identifierToken,v.identifierToken)),accessRestriction:"Private"});r.insertSymbol(_)}})}),mo(r,t.nodeRange)}function zh(e,t){let n=[];for(let i of t??[])e.insertSymbolAndCheck(Pe.create({identifierToken:uu(i),scopePath:e.scopePath,linkedNode:void 0,membersScopePath:void 0,isTypeParameter:!0})),n.push(uu(i));return n}function Uh(e,t){if(t.baseList.length===0)return;let n=[];for(let i of t.baseList){let o=fn(e,i.text);o===void 0?(A.error(i.location,`'${i.text}' is not defined type`),n.push(void 0)):o.symbol instanceof Pe?(n.push(new ie(o.symbol)),le().info.reference.push({toSymbol:o.symbol,fromToken:i})):(A.error(i.location,`'${i.text}' is not class or interface`),n.push(void 0))}return n}function Gh(e,t){for(let n of t){if(n===void 0||n.typeOrFunc.isFunction())continue;let i=Em(n.typeOrFunc.membersScopePath);if(i!==void 0){for(let[o,r]of i.symbolTable)if(o!=="this")for(let s of r.toList()){if((s.isFunction()||s.isVariable())&&s.accessRestriction==="Private")continue;let u=e.insertSymbol(s);if(u===void 0)continue;(s.isVariable()&&s.isVirtualProperty)===!1&&A.error(u.toList()[0].identifierToken.location,`Duplicated symbol '${o}'`)}}}}function wx(e,t,n,i){for(let o of t.memberList)o.nodeName==="VirtualProp"?yu(e,o,n,i,!0):o.nodeName==="Func"?Kh(e,o,n,i,!0):o.nodeName==="Var"?Jh(e,o,n,!0):o.nodeName==="FuncDef"&&Xh(e,o,n,i)}function Ex(e,t){let n=bs(t.type);if(n===void 0)return;let i=Pe.create({identifierToken:t.identifier,scopePath:e.scopePath,linkedNode:n.linkedNode,membersScopePath:void 0});e.insertSymbolAndCheck(i)}function Kh(e,t,n,i,o){if(t.head===qt)return;let s=e.insertScope(t.identifier.text,void 0).insertScope(Pt(),t),u=an.create({identifierToken:t.identifier,scopePath:e.scopePath,returnType:void 0,parameterTypes:[],linkedNode:t,functionScopePath:s.scopePath,isInstanceMember:o,accessRestriction:t.accessor}),f=zh(s,t.typeTemplates);f.length>0&&u.assignTemplateTypes(f),e.insertSymbolAndCheck(u)!==!1&&(i.push(()=>{let g=rn(t.head)?Je(s,t.head.returnType):void 0;u.assignReturnType(g),Qh(e,t,g,o),u.assignParameterTypes(Mx(s,t.paramList))}),n.push(()=>{Mh(s,t)}))}function Qh(e,t,n,i){if(t.identifier.text.startsWith("get_")||t.identifier.text.startsWith("set_")){if(t.funcAttr?.isProperty===!0||Y().explicitPropertyAccessor===!1){let o=Be.createVirtual(t.identifier.text.substring(4),new D(t.identifier,t.identifier)),r=Oe.create({identifierToken:o,scopePath:e.scopePath,type:n,isInstanceMember:i,accessRestriction:t.nodeName==="IntfMethod"?void 0:t.accessor,isVirtualProperty:!0});e.insertSymbol(r)}}else t.funcAttr?.isProperty===!0&&A.error(t.identifier.location,'Property accessor must start with "get_" or "set_"')}function Lx(e,t,n,i){let o=Pe.create({identifierToken:t.identifier,scopePath:e.scopePath,linkedNode:t,membersScopePath:void 0});if(e.insertSymbolAndCheck(o)===!1)return;let r=e.insertScopeAndCheck(t.identifier,t);o.assignMembersScopePath(r.scopePath);let s=Uh(r,t);s!==void 0&&o.assignBaseList(s),i.push(()=>{Ix(r,t,n,i),s!==void 0&&Gh(r,s)}),mo(r,t.nodeRange)}function Ix(e,t,n,i){for(let o of t.memberList)o.nodeName==="VirtualProp"?yu(e,o,n,i,!0):o.nodeName==="IntfMethod"&&Ax(e,o)}function Jh(e,t,n,i){let o=Je(e,t.type);n.push(()=>{for(let r of t.variables){let s=r.initializer;s!==void 0&&mu(e,o,r.identifier,s)}}),pu(e,o,t,i)}function Xh(e,t,n,i){let o=an.create({identifierToken:t.identifier,scopePath:e.scopePath,returnType:void 0,parameterTypes:[],linkedNode:t,functionScopePath:void 0,isInstanceMember:!1,accessRestriction:void 0});e.insertSymbolAndCheck(o)!==!1&&(i.push(()=>{o.assignReturnType(Je(e,t.returnType))}),i.push(()=>{o.assignParameterTypes(t.paramList.map(r=>Je(e,r.type)))}))}function yu(e,t,n,i,o){let r=Je(e,t.type),s=t.identifier,u=Oe.create({identifierToken:s,scopePath:e.scopePath,type:r,isInstanceMember:o,accessRestriction:t.accessor});e.insertSymbolAndCheck(u);let f=t.getter;if(f!==void 0&&f.statBlock!==void 0){let v=e.insertScope(`get_${s.text}`,t),_=f.statBlock;n.push(()=>{Bt(v,_)})}let g=t.setter;if(g!==void 0&&g.statBlock!==void 0){let v=e.insertScope(`set_${s.text}`,t);if(r!==void 0){let w=Oe.create({identifierToken:fh,scopePath:e.scopePath,type:new ie(r.typeOrFunc),isInstanceMember:!1,accessRestriction:t.accessor});v.insertSymbolAndCheck(w)}let _=g.statBlock;n.push(()=>{Bt(v,_)})}}function Fx(e,t,n,i){$h(e,t.mixinClass,n,i)}function Ax(e,t){let n=an.create({identifierToken:t.identifier,scopePath:e.scopePath,returnType:Je(e,t.returnType),parameterTypes:[],linkedNode:t,functionScopePath:void 0,isInstanceMember:!0,accessRestriction:void 0});e.insertSymbolAndCheck(n)!==!1&&Qh(e,t,n.returnType,!0)}function Mx(e,t){let n=[];for(let i of t){let o=Je(e,i.type);o===void 0?n.push(void 0):n.push(o),i.identifier!==void 0&&e.insertSymbolAndCheck(Oe.create({identifierToken:i.identifier,scopePath:e.scopePath,type:o,isInstanceMember:!1,accessRestriction:void 0}))}return n}function Yh(e,t){let n=[],i=[];for(Vh(t,e,n,i);i.length>0;){let o=i.shift();o!==void 0&&o()}return{globalScope:t,analyzeQueue:n}}var tg=require("node:url"),ng=ue(require("fs"));var Dw=require("node:assert");var Cs=class{constructor(){this._directQueue=[];this._indirectQueue=[]}clear(){this._directQueue=[],this._indirectQueue=[]}hasDirect(){return this._directQueue.length>0}hasIndirect(){return this._indirectQueue.length>0}isInQueue(t){return this._directQueue.some(n=>n.record.uri===t)||this._indirectQueue.some(n=>n.record.uri===t)}frontPushDirect(t){this._directQueue=this._directQueue.filter(n=>n.record.uri!==t.record.uri),this._directQueue.unshift(t),this._indirectQueue=this._indirectQueue.filter(n=>n.record.uri!==t.record.uri)}pushDirect(t){let n=this._directQueue.find(i=>i.record.uri===t.record.uri);n!==void 0?n.reanalyzeDependents=n.reanalyzeDependents||t.reanalyzeDependents:this._directQueue.push(t),this._indirectQueue=this._indirectQueue.filter(i=>i.record.uri!==t.record.uri)}pushIndirect(t){let n=this._directQueue.find(o=>o.record.uri===t.record.uri);if(n!==void 0){n.reanalyzeDependents=n.reanalyzeDependents||t.reanalyzeDependents;return}let i=this._indirectQueue.find(o=>o.record.uri===t.record.uri);i!==void 0?i.reanalyzeDependents=i.reanalyzeDependents||t.reanalyzeDependents:this._indirectQueue.push(t)}frontPop(){if(this._directQueue.length>0)return{...this._directQueue.shift(),queue:"Direct"};if(this._indirectQueue.length>0)return{...this._indirectQueue.shift(),queue:"Indirect"}}};var Zh="as.predefined",eg=12,qx=500,jx=100,Bx=10,_s=class{constructor(t,n,i){this._inspectRecords=t;this._inspectRequest=n;this._diagnosticsCallback=i;this._analyzerTask=new hs;this._analysisQueue=new Cs;this._resolvedPredefinedFilepaths=new Set}reset(){this._analysisQueue.clear(),this._resolvedPredefinedFilepaths.clear()}request(t,n){this._analysisQueue.pushDirect({record:t,reanalyzeDependents:n}),this._analyzerTask.reschedule(()=>{this.handleAnalyze()},qx)}rescheduleAnalyzeRemaining(){let t;if(this._analysisQueue.hasDirect())t=Bx;else if(this._analysisQueue.hasIndirect())t=jx;else return;this._analyzerTask.reschedule(()=>{this.handleAnalyze()},t)}popAndAnalyze(){let t=this._analysisQueue.frontPop();if(t!==void 0&&(this.analyzeFile(t.record),t.reanalyzeDependents)){let n=t.queue==="Direct";this.reanalyzeFilesWithDependency(t.record.uri,n)}}flush(t){for(;this._analysisQueue.hasDirect();)this.popAndAnalyze();if(t===void 0)for(;this._analysisQueue.hasIndirect();)this.popAndAnalyze();else if(this._analysisQueue.isInQueue(t)){let n=this._inspectRecords.get(t);if(n===void 0)return;this._analysisQueue.frontPushDirect({record:n,reanalyzeDependents:!1}),this.popAndAnalyze()}}handleAnalyze(){this.popAndAnalyze(),this.rescheduleAnalyzeRemaining()}analyzeFile(t){let n=this.findPredefinedUri(t.uri);Ge.message(`[Analyzer]
${t.uri}`),A.beginSession();let i=this.collectIncludeScope(t,n),o=new di,r=Yh(t.ast,_h(t.uri,i));o.mark("Hoist".padEnd(eg)),t.analyzerScope=Hh(t.uri,r),o.mark("Analyzer".padEnd(eg)),t.diagnosticsInAnalyzer=A.endSession(),t.isAnalyzerPending=!1,this._diagnosticsCallback({uri:t.uri,diagnostics:[...t.diagnosticsInParser,...t.diagnosticsInAnalyzer]}),Ge.message(`(${process.memoryUsage().heapUsed/1024/1024} MB used)`)}reanalyzeFilesWithDependency(t,n){let i=new Set;this.reanalyzeFilesWithDependencyInternal(i,t,n)}reanalyzeFilesWithDependencyInternal(t,n,i){if(t.has(n))return;let o=Array.from(this._inspectRecords.values()).filter(r=>this.resolveIncludePaths(r,this.findPredefinedUri(r.uri)).some(s=>co(r.uri,s)===n));for(let r of o)this._analysisQueue.pushIndirect({record:r,reanalyzeDependents:i}),t.add(r.uri);for(let r of o)this.reanalyzeFilesWithDependencyInternal(t,r.uri,i)}resolveIncludePaths(t,n){let i=new Set;if(t.uri!==n&&n!==void 0&&i.add(n),this.resolveIncludePathsInternal(i,t),i.delete(t.uri),Y().implicitMutualInclusion&&t.uri.endsWith(Zh)===!1&&n!==void 0){let o=wn(n,".");return[...Array.from(i),...Array.from(this._inspectRecords.keys()).filter(r=>r.startsWith(o)).filter(r=>r.endsWith(".as")&&r!==t.uri)]}return Array.from(i)}resolveIncludePathsInternal(t,n){if(t.has(n.uri))return;t.add(n.uri);let i=n.preprocessedOutput.includePathTokens.map(o=>o.getStringContent());i.forEach(o=>t.add(o));for(let o of i){let r=wn(n.uri,o),s=this._inspectRecords.get(r);s!==void 0&&this.resolveIncludePathsInternal(t,s)}}findPredefinedUri(t){let n=ah(t);for(let i of n){let o=i+`/${Zh}`;if(this._inspectRecords.get(o)!==void 0&&this._resolvedPredefinedFilepaths.has(o))return o;if(t!==o){let r=ys(o);if(r===void 0)continue;this._inspectRequest(o,r)}return this.inspectUnderDirectory(wn(o,".")),this._resolvedPredefinedFilepaths.add(o),o}}inspectUnderDirectory(t){let n=this.getDirectoryEntries(t);for(let i of n){let o=wn(t,i.name);if(i.isDirectory())this.inspectUnderDirectory(`${o}/`);else if(i.isFile()&&o.endsWith(".as")){let r=ys(o);r!==void 0&&this._inspectRequest(o,r)}}}getDirectoryEntries(t){try{return ng.readdirSync((0,tg.fileURLToPath)(t),{withFileTypes:!0})}catch{return[]}}collectIncludeScope(t,n){let i=t.preprocessedOutput,o=t.uri,r=this.resolveIncludePaths(t,n),s=[];for(let u of r){let f=co(o,u),g=this._inspectRecords.get(f);if(g!==void 0){s.push(g.analyzerScope);continue}let v=ys(f);if(v!==void 0){this._inspectRequest(f,v);continue}let _=i.includePathTokens.find(w=>w.getStringContent()===u);_!==void 0&&A.error(_.location,`File not found: ${u}`)}return s}};function Wx(e,t){let n=e.boundingLocation.getDifference(),i=t.boundingLocation.getDifference();return n.line<i.line?e:n.line>i.line?t:n.character<i.character?e:t}function Os(e,t){let n=e.getContext().filepath,i;for(let o of e.info.scopeRegion){let r=o.boundingLocation;r.path===n&&r.positionInRange(t)&&(i=i===void 0?o:Wx(i,o))}return{scope:i?.targetScope??e,location:i?.boundingLocation}}var ig=ue(Mt()),Hx=ue(require("node:assert"));function og(e,t){for(let n of t)sg(e,n)}function rg(e,t){for(let n of t)sg(e,n)}function Vx(e){let t=0,n=0,i=0;for(let o=0;o<e.length;o++){let r=e[o];r==="\r"?(e[o+1]===`
`&&o++,t++,i=0):r===`
`?(t++,i=0):i++}return n=i,{lineBreaks:t,lastLineLength:n}}function sg(e,t){Hx(ig.TextDocumentContentChangeEvent.isIncremental(t));let n=t.range,i=Vx(t.text);for(let o of e){let r="range"in o?o.range:{start:o.position,end:{...o.position}};if(n.end.line<r.start.line){let s=-(n.end.line-n.start.line);s+=i.lineBreaks,r.start.line+=s,r.end.line+=s}else if(n.end.line===r.start.line&&n.end.character<=r.start.character){let s=n.start.line-n.end.line;if(s+=i.lineBreaks,r.start.line+=s,r.end.line+=s,s!=0){let u=r.start.character-n.end.character;if(s<0?u+=n.start.character+i.lastLineLength:u+=i.lastLineLength,r.start.line===r.end.line){let f=r.end.character-r.start.character;r.end.character=u+f}r.start.character=u}else{let u=-(n.end.character-n.start.character);u+=i.lastLineLength,r.start.character+=u,r.end.character+=u}}}}function ag(e,t){return{content:t,uri:e,diagnosticsInParser:[],diagnosticsInAnalyzer:[],rawTokens:[],preprocessedOutput:{preprocessedTokens:[],includePathTokens:[]},ast:[],isAnalyzerPending:!1,analyzerScope:new yi(e,new cn(e))}}var bu=12,Ds=class{constructor(){this._inspectRecords=new Map;this._diagnosticsCallback=()=>{};this._analysisResolver=new _s(this._inspectRecords,(t,n)=>this.inspectFile(t,n),t=>this._diagnosticsCallback(t))}registerDiagnosticsCallback(t){this._diagnosticsCallback=t}createRecordAndInsert(t,n){let i=ag(t,n);return this._inspectRecords.set(t,i),i}getRecord(t){let n=this._inspectRecords.get(t);return n===void 0?ag(t,""):n}getAllRecords(){return Array.from(this._inspectRecords.values())}flushRecord(t){this._analysisResolver.flush(t)}inspectFile(t,n,i){Ge.message(`[Tokenizer and Parser]
${t}`);let o=this._inspectRecords.get(t)??this.createRecordAndInsert(t,n);o.content=n,Ke.beginSession();let r=new di;o.rawTokens=Hm(t,n),r.mark("Tokenizer".padEnd(bu)),o.preprocessedOutput=Vm(o.rawTokens),r.mark("Preprocessor".padEnd(bu)),o.ast=oh(o.preprocessedOutput.preprocessedTokens),r.mark("Parser".padEnd(bu)),o.diagnosticsInParser=Ke.endSession(),i?.changes!==void 0&&og(o.diagnosticsInAnalyzer,i.changes),o.isAnalyzerPending=!0,this._diagnosticsCallback({uri:t,diagnostics:[...o.diagnosticsInParser,...o.diagnosticsInAnalyzer]}),this._analysisResolver.request(o,$x(o.analyzerScope.globalScope,i?.changes)),Ge.message(`(${process.memoryUsage().heapUsed/1024/1024} MB used)`)}deleteRecord(t){this._inspectRecords.delete(t)}reinspectAllFiles(){for(let t of this._inspectRecords.keys())this.inspectFile(t,this._inspectRecords.get(t).content)}reset(){this._inspectRecords.clear(),this._analysisResolver.reset()}};function $x(e,t){if(t===void 0)return!0;for(let n of t)if(zx(e,n)===!1)return!0;return!1}function zx(e,t){if(cg.TextDocumentContentChangeEvent.isIncremental(t)===!1)return!1;let n=me.create(t.range.start),i=Os(e,n);return i.scope.isAnonymousScope()&&i.location?.contains(t.range)===!0}var mn=ue(Mt());function ug(e,t){let n=[],i=Os(e,t).scope,o=Gx(e,i,t);if(o!==void 0)return o;for(let r of[...wm(i),i])n.push(...dg(r,!0));return n.push(...lg(e,[])),n}function dg(e,t){let n=[];for(let[i,o]of e.symbolTable)t===!1&&(Vc(o)||o.isVariable()&&o.identifierToken.isVirtual()&&o.identifierText==="this")||n.push(Tu(i,o));for(let[i,o]of e.childScopeTable)o.isPureNamespaceScope()!==!1&&n.push({item:{label:i,kind:mn.CompletionItemKind.Module}});return n}function lg(e,t){if(Y().hoistEnumParentScope===!1)return[];let n=[];for(let i of e.getContext().enumScopeList)if(t.every((o,r)=>o===i.scopePath[r])!==!1)for(let[o,r]of i.symbolTable)n.push(Tu(o,r));return n}function Ux(e,t,n){let i=[];for(let[o,r]of n.symbolTable)Vc(r)!==!1&&xs(t,r)!==!1&&i.push(Tu(o,r));return i}function Gx(e,t,n){for(let i of e.info.autocompleteInstanceMember)if(i.autocompleteLocation.positionInRange(n)){let r=Kx(e,t,i);if(r!==void 0&&r.length>0)return r}for(let i of e.info.autocompleteNamespaceAccess)if(i.autocompleteLocation.positionInRange(n)){let r=dg(i.accessScope,!1);if(r!==void 0&&r.length>0)return i.accessScope.linkedNode?.nodeName!=="Enum"&&r.push(...lg(e,i.accessScope.scopePath)),r}}function Kx(e,t,n){if(n.targetType.membersScopePath===void 0)return[];let i=e.getGlobalScope().resolveScope(n.targetType.scopePath)?.lookupScope(n.targetType.identifierToken.text);return i===void 0?[]:Ux(e,t,i)}function Tu(e,t){let n={label:e};return t.isType()?t.isPrimitiveType()||t.linkedNode===void 0?n.kind=mn.CompletionItemKind.Keyword:t.isEnumType()?n.kind=mn.CompletionItemKind.Enum:t.linkedNode.nodeName==="Interface"?n.kind=mn.CompletionItemKind.Interface:n.kind=mn.CompletionItemKind.Class:t.isFunctionHolder()?n.kind=mn.CompletionItemKind.Function:n.kind=mn.CompletionItemKind.Variable,{item:n,symbol:t}}var fg=ue(Mt());function pg(e){let t=new fg.SemanticTokensBuilder;return e.forEach((n,i)=>{Qx(t,n)}),t.build()}function Qx(e,t){if(e.push(t.location.start.line,t.location.start.character,t.text.length,t.highlight.token,t.highlight.modifier),t.location.start.line!==t.location.end.line){for(let n=t.location.start.line+1;n<t.location.end.line;n++)e.push(n,0,t.text.length,t.highlight.token,t.highlight.modifier);e.push(t.location.end.line,0,t.location.end.character,t.highlight.token,t.highlight.modifier)}}function mg(e,t,n){let i=Zr(e,t,n);if(i===void 0)return[];let o=t.flatMap(r=>Jx(r,i));return o.length===0&&o.push(...hg(e.getGlobalScope(),i)),o.push(i),o}function Jx(e,t){let n=[];for(let i of e.info.reference)i.toSymbol.identifierToken.equals(t)&&n.push(i.fromToken);return n}function hg(e,t){let n=[];if(e.isGlobalScope())for(let i of e.info.autocompleteNamespaceAccess)i.namespaceToken.text===t.text&&n.push(i.namespaceToken);for(let i of e.namespaceNodes.map(o=>o.linkedToken))i.text===t.text&&n.push(i);for(let[i,o]of e.childScopeTable)o.isAnonymousScope()||n.push(...hg(o,t));return n}function Xx(){return Y().formatter.useTabIndent?"	":" ".repeat(Y().formatter.indentSpaces)}var ws=class{constructor(t,n,i){this.content=t;this.tokens=n;this.ast=i;this.resultEdits=[];this.cursor={line:0,character:0};this.indentStack=[];this.indentBuffer="";this.condenseStack=!1;this.wrapStack=!1;this.indentUnit=Xx();this.textLines=Yx(t),this.map=new Su(this.textLines,n)}getResult(){return this.resultEdits}pushEdit(t,n,i){this.resultEdits.push({range:{start:t,end:n},newText:i})}getText(t,n,i=1){return n===void 0?this.textLines[t]:this.textLines[t].substring(n,n+i)}getTextAt(t,n=1){return this.textLines[t.line].substring(t.character,t.character+n)}cursoredText(){return this.getTextAt(this.cursor)}getCursor(){return{line:this.cursor.line,character:this.cursor.character}}setCursor(t){this.cursor.line=t.line,this.cursor.character=t.character}setCursorToTail(t){this.setCursor(t.location.end)}stepCursor(){this.setCursor(ho(this.textLines,this.cursor))}isFinished(){return this.cursor.line>=this.textLines.length}getIndent(){return this.indentBuffer}pushIndent(){let t={line:this.cursor.line,isApplied:!1},n=this.indentStack[this.indentStack.length-1];this.indentStack.length===0||n.line!==t.line?(this.indentBuffer+=this.indentUnit,t.isApplied=!0):n.isApplied&&(n.isApplied=!1,t.isApplied=!0),this.indentStack.push(t)}popIndent(){let t=this.indentStack.pop();if(t?.isApplied===!0){let n=this.indentStack[this.indentStack.length-1];t.line===this.cursor.line&&n?.isApplied===!1?n.isApplied=!0:this.indentBuffer=this.indentBuffer.substring(0,this.indentBuffer.length-this.indentUnit.length)}}pushCondense(){this.condenseStack=!0}popCondense(){let t=this.condenseStack;return this.condenseStack=!1,t}pushWrap(){this.wrapStack=!0}popWrap(){let t=this.wrapStack;return this.wrapStack=!1,t}};function ho(e,t){let n={character:t.character,line:t.line};return n.line>=e.length||(n.character++,n.character>=e[n.line].length&&(n.line++,n.character=0)),n}function Yx(e){let t=e.split(/(\r?\n|\r)/),n=[];for(let i=0;i<t.length;i+=2){let o=t[i],r=i+1<t.length?t[i+1]:"";n.push(o+r)}return n}function gg(e,t){for(let n of e)if(n.range.start.line===t&&n.newText.includes(`
`))return!0;return!1}var Su=class{constructor(t,n){this.map=[];for(let i=0;i<t.length;i++){let o=new Array(t[i].length).fill(void 0);this.map.push(o)}for(let i of n){let o=i.location.start,r=i.location.end;for(let s=o.line;s<=r.line;s++){let u=this.map[s],f=s===o.line?o.character:0,g=s===r.line?r.character:t[s].length;for(let v=f;v<g;v++)u[v]=i}}}getToken(t,n){return this.map[t][n]}getTokenAt(t){return this.map[t.line][t.character]}};function Zx(e){return e===void 0?!1:/\s/.test(e)}function Es(e,t){let n=t.line,i=t.character;for(;i>0&&Zx(e.getText(n,i-1))!==!1;)i--;return{line:n,character:i}}function vu(e,t){let n={line:t.location.start.line,character:t.location.start.character},i=Es(e,n);if(i.character===0){e.setCursorToTail(t);return}let o=e.map.getTokenAt({line:i.line,character:i.character-1}),r=eN(o,t)?" ":"";e.pushEdit(i,n,i.character>0?r:e.getIndent()),e.setCursorToTail(t)}function eN(e,t){let n=e?.location?.end,i=t.location.start;return!(n?.line===i.line&&n.character===i.character||e?.text==="#")}function H(e,t){xu(e,t.nodeRange.start.location.start)}function xu(e,t){let n=e.getCursor();for(;e.isFinished()===!1;){if(n.line>=e.textLines.length){let r={line:e.textLines.length-1,character:e.textLines[e.textLines.length-1].length};e.pushEdit(e.getCursor(),r,`
`);return}let i=e.map.getTokenAt(n);if(i===void 0){n=ho(e.textLines,n);continue}if(n.line-e.getCursor().line>1+Nu()&&yg(e,e.getCursor().line+1,n.line-1),(n.line>t.line||n.line===t.line&&n.character>=t.character)===!1){vu(e,i),n=e.getCursor();continue}break}}function St(e){let t=e.getCursor();for(;e.isFinished()===!1;){let n=e.map.getTokenAt(t);if(n===void 0){t=ho(e.textLines,t);continue}else if(n.kind==="Comment"){vu(e,n),t=e.getCursor();continue}return n}}function N(e,t,n){let i=e.getCursor();for(;e.isFinished()===!1;){let o=e.map.getTokenAt(i);if(o===void 0){i=ho(e.textLines,i);continue}else if(o.kind==="Comment"){vu(e,o),i=e.getCursor();continue}return e.getTextAt(i,t.length)!==t?(Ge.verbose(`'${t}' not found at ${i.line}:${i.character}`),!1):(tN(e,t,n,i,o),!0)}return!1}function Nu(){return Math.max(1,Y().formatter.maxBlankLines)}function yg(e,t,n){for(let i=t;i<=n;i++)if(/^\s*$/.test(e.textLines[i])===!1){Ge.verbose(`Not a blank line at ${i}`);return}e.pushEdit({line:t,character:0},{line:n,character:e.textLines[n].length-1},`
`.repeat(Nu()-1)),e.setCursor({line:n+1,character:0})}function tN(e,t,n,i,o){let r=e.popCondense()||n.condenseSides===!0||n.condenseLeft===!0;(n.condenseSides===!0||n.condenseRight===!0)&&e.pushCondense();let u=e.popWrap()||n.forceWrap===!0,f=r?"":" ",g={line:o.location.start.line,character:o.location.start.character};if(u===!1&&n.connectTail===!0){let v=Es(e,e.getCursor());e.pushEdit(v,g,(v.character===0?e.getIndent():"")+f)}else{i.line-e.getCursor().line>1+Nu()&&yg(e,e.getCursor().line+1,i.line-1);let v=e.getCursor(),_=Es(e,v);if(_.character===0)e.pushEdit(_,g,e.getIndent());else{let w=v.line===g.line,ee=w?_:Es(e,g),De=w?u?`
`+e.getIndent():f:e.getIndent();e.pushEdit(ee,g,De)}}i.character+=t.length,e.setCursor(i)}function Tg(e,t){for(let n of t){let i=n.nodeName;i==="Import"?sN(e,n):i==="Enum"?iN(e,n):i==="TypeDef"?oN(e,n):i==="Class"?Sg(e,n):i==="Mixin"?aN(e,n):i==="Interface"?rN(e,n):i==="FuncDef"?xg(e,n):i==="VirtualProp"?Pu(e,n):i==="Var"?Ls(e,n):i==="Func"?vg(e,n):i==="Namespace"&&nN(e,n)}}function nN(e,t){H(e,t),e.pushWrap(),N(e,"namespace",{}),e.pushIndent();for(let n=0;n<t.namespaceList.length;n++){n>0&&N(e,"::",{condenseSides:!0});let i=t.namespaceList[n];N(e,i.text,{})}e.popIndent(),hn(e,()=>{Tg(e,t.script)})}function hn(e,t,n=!0){if(N(e,"{",{connectTail:!0})===!1)return;let i=e.getCursor().line;n&&e.pushIndent(),t(),n&&e.popIndent();let o=i!==e.getCursor().line||gg(e.getResult(),i);N(e,"}",{forceWrap:o})}function iN(e,t){H(e,t),e.pushWrap(),go(e),N(e,"enum",{}),N(e,t.identifier.text,{}),hn(e,()=>{for(let n=0;n<t.memberList.length;n++){n>0&&N(e,",",{condenseLeft:!0}),N(e,t.memberList[n].identifier.text,{});let i=t.memberList[n].expr;i!==void 0&&(N(e,"=",{}),yo(e,i))}})}function Sg(e,t){H(e,t),e.pushWrap(),go(e),N(e,"class",{}),N(e,t.identifier.text,{}),St(e)?.text===";"?N(e,";",{condenseLeft:!0,connectTail:!0}):hn(e,()=>{for(let n of t.memberList)n.nodeName==="VirtualProp"?Pu(e,n):n.nodeName==="FuncDef"?xg(e,n):n.nodeName==="Var"?Ls(e,n):n.nodeName==="Func"&&vg(e,n)})}function oN(e,t){H(e,t),e.pushWrap(),N(e,"typedef",{}),N(e,t.type.text,{}),N(e,t.identifier.text,{}),N(e,";",{condenseLeft:!0,connectTail:!0})}function vg(e,t){H(e,t),e.pushWrap(),go(e),Ru(e),rn(t.head)?(lt(e,t.head.returnType),t.head.isRef&&N(e,"&",{condenseLeft:!0})):t.head===qt&&N(e,"~",{condenseRight:!0}),N(e,t.identifier.text,{}),Is(e,t.paramList),t.isConst&&N(e,"const",{}),Fs(e),St(e)?.text===";"?N(e,";",{condenseLeft:!0,connectTail:!0}):Si(e,t.statBlock)}function go(e){for(;;){let t=St(e);if(t===void 0)return;if(t.text==="shared"||t.text==="abstract"||t.text==="final"||t.text==="external")N(e,t.text,{});else return}}function Ru(e){let t=St(e);t!==void 0&&(t.text==="private"||t.text==="protected")&&N(e,t.text,{})}function rN(e,t){H(e,t),e.pushWrap(),go(e),N(e,"interface",{}),N(e,t.identifier.text,{}),St(e)?.text===";"?N(e,";",{condenseLeft:!0,connectTail:!0}):hn(e,()=>{for(let n of t.memberList)n.nodeName==="VirtualProp"?Pu(e,n):n.nodeName==="IntfMethod"&&cN(e,n)})}function Ls(e,t){H(e,t),Ru(e),lt(e,t.type);for(let n=0;n<t.variables.length;n++){n>0&&N(e,",",{condenseLeft:!0}),N(e,t.variables[n].identifier.text,{});let i=t.variables[n].initializer;i!==void 0&&(i.nodeName==="InitList"?(N(e,"=",{}),Cu(e,i)):i.nodeName==="Assign"?(e.pushIndent(),N(e,"=",{}),je(e,i),e.popIndent()):As(e,i))}N(e,";",{condenseLeft:!0,connectTail:!0})}function sN(e,t){H(e,t),e.pushWrap(),N(e,"import",{}),lt(e,t.type),t.isRef&&N(e,"&",{condenseLeft:!0}),N(e,t.identifier.text,{}),Is(e,t.paramList),Fs(e),N(e,"from",{}),N(e,t.path.text,{}),N(e,";",{condenseLeft:!0,connectTail:!0})}function xg(e,t){H(e,t),e.pushWrap(),go(e),N(e,"funcdef",{}),lt(e,t.returnType),t.isRef&&N(e,"&",{condenseLeft:!0}),N(e,t.identifier.text,{}),Is(e,t.paramList),N(e,";",{condenseLeft:!0,connectTail:!0})}function Pu(e,t){H(e,t),e.pushWrap(),Ru(e),lt(e,t.type),t.isRef&&N(e,"&",{condenseLeft:!0}),N(e,t.identifier.text,{}),hn(e,()=>{for(;;){let n=t.getter,i=t.setter,o=St(e);if(o?.text==="get"&&n!==void 0)N(e,"get",{}),bg(e,n.isConst,n.statBlock);else if(o?.text==="set"&&i!==void 0)N(e,"set",{}),bg(e,i.isConst,i.statBlock);else break}})}function bg(e,t,n){t&&N(e,"const",{}),Fs(e),n===void 0?N(e,";",{condenseLeft:!0,connectTail:!0}):Si(e,n)}function aN(e,t){H(e,t),e.pushWrap(),N(e,"mixin",{}),Sg(e,t.mixinClass)}function cN(e,t){H(e,t),e.pushWrap(),lt(e,t.returnType),t.isRef&&N(e,"&",{condenseLeft:!0}),N(e,t.identifier.text,{}),Is(e,t.paramList),t.isConst&&N(e,"const",{}),t.funcAttr&&Fs(e),N(e,";",{condenseLeft:!0,connectTail:!0})}function Si(e,t){H(e,t);let n=t.nodeRange.isOneLine();hn(e,()=>{for(let i of t.statementList)n===!1&&e.pushWrap(),i.nodeName==="Var"?Ls(e,i):Ln(e,i)})}function Is(e,t){Dt(e,()=>{t.length===0&&St(e)?.text==="void"&&N(e,"void",{});for(let n=0;n<t.length;n++){n>0&&N(e,",",{condenseLeft:!0}),lt(e,t[n].type),Ng(e);let i=t[n].identifier;i!==void 0&&N(e,i.text,{});let o=t[n].defaultExpr;o!==void 0&&o.nodeName!=="ExprVoid"&&(N(e,"=",{}),yo(e,o))}})}function Dt(e,t,n=!0){N(e,"(",{condenseLeft:n,condenseRight:!0})!==!1&&(e.pushIndent(),t(),e.popIndent(),N(e,")",{condenseLeft:!0}))}function Ng(e){let t=St(e);if(t!==void 0&&t.text==="&"){N(e,"&",{condenseLeft:!0});let n=St(e);if(n===void 0)return;(n.text==="in"||n.text==="out"||n.text==="inout")&&N(e,t.text,{})}}function lt(e,t){H(e,t),t.isConst&&N(e,"const",{}),t.scope!==void 0&&_u(e,t.scope),dN(e,t.dataType),uN(e,t.typeTemplates),t.isArray&&(N(e,"[",{condenseSides:!0}),N(e,"]",{condenseLeft:!0})),t.refModifier!==void 0&&(N(e,"@",{condenseLeft:!0}),t.refModifier==="AtConst"&&N(e,"const",{}))}function uN(e,t){t.length!==0&&kg(e,()=>{for(let n=0;n<t.length;n++)n>0&&N(e,",",{condenseLeft:!0}),lt(e,t[n])})}function kg(e,t){N(e,"<",{condenseSides:!0})!==!1&&(e.pushIndent(),t(),e.popIndent(),N(e,">",{condenseLeft:!0}))}function Cu(e,t){H(e,t),hn(e,()=>{for(let n=0;n<t.initList.length;n++){n>0&&N(e,",",{condenseLeft:!0});let i=t.initList[n];i.nodeName==="InitList"?Cu(e,i):je(e,i)}})}function _u(e,t){H(e,t),t.isGlobal&&N(e,"::",{condenseSides:!0});for(let n=0;n<t.scopeList.length;n++){let i=t.scopeList[n];N(e,i.text,{}),N(e,"::",{condenseSides:!0})}}function dN(e,t){H(e,t),N(e,t.identifier.text,{})}function Fs(e){for(;;){let t=St(e);if(t===void 0)return;if(t.text==="override"||t.text==="final"||t.text==="explicit"||t.text==="property")N(e,t.text,{});else return}}function Ln(e,t,n=!1){let i=n&&t.nodeName!=="StatBlock";switch(i&&e.pushIndent(),t.nodeName){case"If":gN(e,t);break;case"For":pN(e,t);break;case"While":mN(e,t);break;case"Return":TN(e,t);break;case"StatBlock":Si(e,t);break;case"Break":fN(e,t);break;case"Continue":yN(e,t);break;case"DoWhile":hN(e,t);break;case"Switch":lN(e,t);break;case"ExprStat":ku(e,t);break;case"Try":bN(e,t);break}i&&e.popIndent()}function lN(e,t){H(e,t),N(e,"switch",{}),Dt(e,()=>{je(e,t.assign)}),hn(e,()=>{for(let n of t.caseList)SN(e,n)},!1)}function fN(e,t){H(e,t),N(e,"break",{}),N(e,";",{condenseLeft:!0,connectTail:!0})}function pN(e,t){H(e,t),N(e,"for",{}),Dt(e,()=>{t.initial.nodeName==="Var"?Ls(e,t.initial):ku(e,t.initial),t.condition!==void 0&&ku(e,t.condition);for(let n of t.incrementList)je(e,n)},!1),t.statement!==void 0&&Ln(e,t.statement,!0)}function mN(e,t){H(e,t),N(e,"while",{}),Dt(e,()=>{je(e,t.assign)},!1),t.statement!==void 0&&Ln(e,t.statement,!0)}function hN(e,t){H(e,t),N(e,"do",{}),t.statement!==void 0&&Ln(e,t.statement,!0),N(e,"while",{connectTail:!0}),Dt(e,()=>{t.assign!==void 0&&je(e,t.assign)},!1),N(e,";",{condenseLeft:!0,connectTail:!0})}function gN(e,t){H(e,t),N(e,"if",{}),Dt(e,()=>{je(e,t.condition)},!1),t.thenStat!==void 0&&Ln(e,t.thenStat,!0),t.elseStat!==void 0&&(N(e,"else",{connectTail:!0}),Ln(e,t.elseStat,!0))}function yN(e,t){H(e,t),N(e,"continue",{}),N(e,";",{condenseLeft:!0,connectTail:!0})}function ku(e,t){H(e,t),t.assign!==void 0&&je(e,t.assign),N(e,";",{condenseLeft:!0,connectTail:!0})}function bN(e,t){H(e,t),N(e,"try",{}),Si(e,t.tryBlock),N(e,"catch",{connectTail:!0}),t.catchBlock!==void 0&&Si(e,t.catchBlock)}function TN(e,t){H(e,t),N(e,"return",{}),e.pushIndent(),t.assign!==void 0&&je(e,t.assign),N(e,";",{condenseLeft:!0,connectTail:!0}),e.popIndent()}function SN(e,t){H(e,t),t.expr!==void 0?(N(e,"case",{}),yo(e,t.expr)):N(e,"default",{}),N(e,":",{condenseLeft:!0,connectTail:!0}),e.pushIndent();for(let n of t.statementList)Ln(e,n,!1);e.popIndent()}function yo(e,t){H(e,t),vN(e,t.head),t.tail!==void 0&&(e.pushIndent(),N(e,t.tail.operator.text,{}),yo(e,t.tail.expression),e.popIndent())}function vN(e,t){if(H(e,t),t.exprTerm===1)t.type!==void 0&&lt(e,t.type),N(e,"=",{}),Cu(e,t.initList);else if(t.exprTerm===2){for(let n=0;n<t.preOps.length;n++)N(e,t.preOps[n].text,{condenseRight:!0});xN(e,t.value);for(let n=0;n<t.postOps.length;n++)kN(e,t.postOps[n])}}function xN(e,t){t.nodeName==="ConstructCall"?NN(e,t):t.nodeName==="FuncCall"?Rg(e,t):t.nodeName==="VarAccess"?_N(e,t):t.nodeName==="Cast"?PN(e,t):t.nodeName==="Literal"?N(e,t.value.text,{}):t.nodeName==="Assign"?Dt(e,()=>{je(e,t)},!1):t.nodeName==="Lambda"&&CN(e,t)}function NN(e,t){H(e,t),lt(e,t.type),As(e,t.argList)}function kN(e,t){H(e,t),e.pushIndent(),t.postOp===1?(N(e,".",{condenseSides:!0}),t.member!==void 0&&("nodeName"in t.member?Rg(e,t.member):N(e,t.member.text,{}))):t.postOp===2?RN(e,()=>{for(let n=0;n<t.indexingList.length;n++){n>0&&N(e,",",{condenseLeft:!0});let i=t.indexingList[n];i.identifier!==void 0&&(N(e,i.identifier.text,{}),N(e,":",{condenseLeft:!0,connectTail:!0})),je(e,i.assign)}}):t.postOp===3?As(e,t.args):t.postOp===4&&N(e,t.operator,{condenseLeft:!0}),e.popIndent()}function RN(e,t){N(e,"[",{condenseSides:!0})!==!1&&(e.pushIndent(),t(),e.popIndent(),N(e,"]",{condenseLeft:!0}))}function PN(e,t){H(e,t),N(e,"cast",{}),kg(e,()=>{lt(e,t.type)}),Dt(e,()=>{je(e,t.assign)})}function CN(e,t){H(e,t),N(e,"function",{}),Dt(e,()=>{for(let n=0;n<t.paramList.length;n++){n>0&&N(e,",",{condenseLeft:!0});let i=t.paramList[n];i.type!==void 0&&lt(e,i.type),Ng(e),i.identifier!==void 0&&N(e,i.identifier.text,{})}}),t.statBlock!==void 0&&Si(e,t.statBlock)}function Rg(e,t){H(e,t),t.scope!==void 0&&_u(e,t.scope),N(e,t.identifier.text,{}),As(e,t.argList)}function _N(e,t){H(e,t),t.scope!==void 0&&_u(e,t.scope),t.identifier!==void 0&&N(e,t.identifier.text,{})}function As(e,t){H(e,t),Dt(e,()=>{for(let n=0;n<t.argList.length;n++){n>0&&N(e,",",{condenseLeft:!0});let i=t.argList[n];i.identifier!==void 0&&(N(e,i.identifier.text,{}),N(e,":",{condenseLeft:!0,connectTail:!0})),je(e,i.assign)}})}function je(e,t){H(e,t),ON(e,t.condition),t.tail!==void 0&&(N(e,t.tail.operator.text,{}),je(e,t.tail.assign))}function ON(e,t){H(e,t),yo(e,t.expr),t.ternary!==void 0&&(e.pushIndent(),N(e,"?",{}),je(e,t.ternary.trueAssign),N(e,":",{}),je(e,t.ternary.falseAssign),e.popIndent())}function Pg(e,t,n){let i=new ws(e,t,n);return Tg(i,n),xu(i,{line:i.textLines.length,character:0}),i.getResult()}function vi(e,t){return Du(e,t,0,e.length)}function Du(e,t,n,i){let o=i-n;if(o<=8){for(let u=n;u<i;u++){let f=e[u];if(f.location.positionInRange(t))return{token:f,index:u}}return}let r=n+Math.floor(o/2),s=e[r];return s.location.positionInRange(t)?{token:s,index:r}:s.location.start.isLessThan(t)?Du(e,t,r+1,i):Du(e,t,n,r)}function Ms(e){return e.isType()?e.linkedNode===void 0?"unknown type":Ou(e.linkedNode.nodeRange.start):e.isVariable()?Ou(e.identifierToken):e.linkedNode===void 0?"unknown function":Ou(e.linkedNode.nodeRange.start)}function DN(e){let t=wN(e);if(t!==void 0&&t.location.end.line-e.location.start.line<=1){let i=t?.prevRaw;if(i?.isCommentToken()||i?.location.end.line!==t.location.start.line)return t}let n=e.nextRaw;for(;n!==void 0&&n.location.start.line===e.location.end.line;){if(n?.isCommentToken())return n;if(n.nextRaw===void 0)break;n=n.nextRaw}}function wN(e){let t=e,n=e.location.start.line;for(;t!==void 0;){if(t.location.end.line!==n)return t;t=t.prevRaw}}function Ou(e){let t="",n=DN(e),i=16;for(let o=0;o<i&&!(n===void 0||n.isCommentToken()===!1);o++){let r=n.text;if(r.startsWith("//")?r=r.replace(/^\/+/,""):r.startsWith("/*")&&(r=r.substring(2,r.length-2)),t=t.length>0?r+`

`+t:r,n.prevRaw===void 0)break;if(n.location.start.line-n.prevRaw.location.end.line>=2)break;n=n.prevRaw}return t}function Cg(e,t,n){let i=[];for(let o=0;o<e.info.functionCall.length;o++){let r=e.info.functionCall[o],s=r.callerArgumentsNode.nodeRange.end.location.end.character>t.character;if(r.callerArgumentsNode.nodeRange.extendForward(s?1:0).getBoundingLocation().positionInRange(t)){let f=r.calleeFuncHolder.first,g=e.resolveScope(f.scopePath)?.lookupSymbolWithParent(f.actualIdentifierToken.text);if(!g?.isFunctionHolder())continue;for(let v of g.overloadList)i.push(EN(r,v,new me(t.line,t.character)));break}}return{signatures:i}}function EN(e,t,n){let i=[],o=0,r=t.linkedNode.identifier.text+"(";for(let u=0;u<t.linkedNode.paramList.length;u++){let f=t.linkedNode.paramList[u],g=t.parameterTypes[u],v=Z(un(g,e.calleeTemplateTranslator));f.identifier!==void 0&&(v+=" "+f.identifier?.text);let _={label:v};u>0&&(r+=", "),r+=v;let w=e.callerArgumentsNode.argList.map(ee=>ee.assign.nodeRange);u<w.length&&n.isLessThan(w[u].start.location.start)===!1&&(o=u,w[u].end.next?.text===","&&o++),i.push(_)}return r+=")",{label:r,parameters:i,activeParameter:o,documentation:Ms(t)}}function _g(e,t){return[...Og(e,t),...IN(e,t),...LN(e,t)]}function LN(e,t){let n=[];for(let i of e.info.functionCall){let o=i.callerIdentifier;if(t.intersects(o.location)===!1)continue;let r=e.info.reference.find(f=>f.fromToken===i.callerIdentifier);if(r===void 0)continue;let s=r.toSymbol;if(s.isFunction()===!1)continue;let u=i.callerArgumentsNode.argList;for(let f=0;f<u.length;f++){if(u[f].identifier!==void 0)continue;if(u[f].assign.tail===void 0){let v=u[f].assign.condition.expr.head;if(v.exprTerm===2&&v.value.nodeName!=="Literal")continue}let g=s.linkedNode.paramList[f]?.identifier?.text;g!==void 0&&n.push({position:u[f].assign.nodeRange.start.location.start,label:g+": "})}}return n}function IN(e,t){let n=[];for(let i of e.info.autoTypeResolution)n.push({position:i.autoToken.location.end,label:": "+Z(i.resolvedType)});return n}function Og(e,t){let n=[];if(e.linkedNode!==void 0&&ui(e.linkedNode)){if(e.linkedNode.nodeRange.path!==t.path)return[];if(e.linkedNode.nodeRange.getBoundingLocation().intersects(t)===!1)return[];for(let[i,o]of e.symbolTable){if(o.isFunctionHolder()===!1)continue;let r=FN.get(i);if(r!==void 0)for(let s of o.toList()){if(s.linkedNode===void 0||s.linkedNode.nodeRange.getBoundingLocation().intersects(t)===!1)continue;let u=s.linkedNode.identifier;n.push({position:u.location.end,label:`: ${r} `})}}}for(let i of e.childScopeTable.values())i.isAnonymousScope()||n.push(...Og(i,t));return n}var FN=new Map([["opNeg","-"],["opCom","~"],["opPreInc","++"],["opPreDec","--"],["opPostInc","++"],["opPostDec","--"],["opEquals","=="],["opCmp","<=>"],["opAssign","="],["opAddAssign","+="],["opSubAssign","-="],["opMulAssign","*="],["opDivAssign","/="],["opModAssign","%="],["opPowAssign","**="],["opAndAssign","&="],["opOrAssign","|="],["opXorAssign","^="],["opShlAssign","<<="],["opShrAssign",">>="],["opUShrAssign",">>>="],["opAdd","+"],["opAdd_r","+"],["opSub","-"],["opSub_r","-"],["opMul","*"],["opMul_r","*"],["opDiv","/"],["opDiv_r","/"],["opMod","%"],["opMod_r","%"],["opPow","**"],["opPow_r","**"],["opAnd","&"],["opAnd_r","&"],["opOr","|"],["opOr_r","|"],["opXor","^"],["opXor_r","^"],["opShl","<<"],["opShl_r","<<"],["opShr",">>"],["opShr_r",">>"],["opUShr",">>>"],["opUShr_r",">>>"],["opIndex","[-]"],["get_opIndex","[-]"],["set_opIndex","[-]"],["opCall","(-)"],["opConv","convert"],["opImplConv","convert"],["opCast","cast"],["opImplCast","cast"]]);var Dg=ue(on());function wg(e,t){for(let n of e.info.functionCall)if(n.callerIdentifier.location.intersects(t))return[{action:{title:"Convert to named arguments",kind:Dg.CodeActionKind.RefactorRewrite},resolver:i=>{i.edit={changes:{[n.callerIdentifier.location.path]:AN(e,n)}}}}];return[]}function AN(e,t){let n=t.callerArgumentsNode;if(n===void 0)return[];let i;for(let u of e.info.reference)if(u.toSymbol.isFunction()!==!1&&u.fromToken===t.callerIdentifier){i=u.toSymbol;break}if(i===void 0)return[];let o=[],r=i.linkedNode.paramList;for(let u=0;u<r.length;++u)if(r[u].identifier!==void 0){if(n.argList.length<=u)break;if(n.argList[u].identifier===void 0){let f=n.argList[u].assign.nodeRange.start,g=r[u].identifier?.text;o.push({range:f.location,newText:`${g}: ${f.text}`})}}let s="";for(let u=n.argList.length;u<r.length;++u){if(r[u].identifier===void 0)continue;u>0&&(s+=", ");let f=r[u].identifier?.text;s+=`${f}: ${f}`}if(s!==""){let u=n.nodeRange.end;o.push({range:u.location,newText:s+u.text})}return o}function Eg(e,t,n){return[...wg(e,n)]}var wu=ue(Mt()),qs=ue(require("node:path")),js=ue(require("node:fs")),Ig=require("node:url");function Fg(e,t){let n=vi(e,t);if(n===void 0)return;let i=n.token.location.path;if(n.token.isStringToken()&&qN(e,n.index))return MN(n.token.getStringContent(),i)}function MN(e,t){let n=[];n.push(...Lg(t,e).map(i=>({label:i,kind:wu.CompletionItemKind.File})));for(let i of rh())n.push(...Lg(i.uri,e).map(o=>({label:o,kind:wu.CompletionItemKind.File,detail:"(include path) "+i.path,sortText:"|"+o})));return n}function qN(e,t){let n=e[t];if(n.isStringToken()===!1)return!1;if(t>=2&&e.slice(t-2,t).map(r=>r.text).join("")==="#include")return!0;let i=n.getStringContent();return i.startsWith("./")||i.startsWith("../")}function Lg(e,t){let n=(0,Ig.fileURLToPath)(e),i=js.statSync(n).isFile()?qs.dirname(n):n,o=t.endsWith("/")?t:t.substring(0,t.lastIndexOf("/")+1),r=qs.resolve(i,o);try{return js.readdirSync(r)}catch{return[]}}var Ag=ue(Mt());var Eu=ue(on());var Mg=ue(require("path"));function qg(e,t){let n=t.item,i=t.symbol;return i?.isVariable()?jN(n,i):i?.isType()?BN(e,n,i):i?.isFunctionHolder()?HN(n,i):n.kind===Ag.CompletionItemKind.Module?$N(n):n}function jN(e,t){return e.detail=Z(t.type)+" "+t.identifierText,e}function BN(e,t,n){return t.detail=WN(n),t.detail+=" "+[...n.scopePath,n.identifierText].join("::"),e.getContext().filepath!==n.identifierToken.location.path&&(t.detail+=`  from ${Mg.basename(n.identifierToken.location.path)}`),t}function WN(e){let t=e.linkedNode?.nodeName;return t==="Enum"?"enum":t==="Class"?"class":t==="Interface"?"interface":"type"}function HN(e,t){let n=t.first;return e.detail=vs(n),n.linkedNode.nodeName==="FuncDef"||(e.insertText=e.label+(VN(t)?"($0)":"()"),e.insertTextFormat=Eu.InsertTextFormat.Snippet),e}function VN(e){return e.toList().length!==1?!0:e.first.parameterTypes.length>0}function $N(e){return e.detail="namespace",e.insertText=e.label+"::",e.insertTextFormat=Eu.InsertTextFormat.Snippet,e}function jg(e,t){let n=$c(e,t);if(n===void 0)return;let i=Ms(n);return{contents:{kind:"markdown",value:"```cpp\n"+vs(n)+`;
\`\`\`
***
${i}`}}}var Wt=ue(on());function Bg(e){return Wg(e.getContext().filepath,e)}function Wg(e,t){let n=[];if(t.linkedNode!==void 0){let i=zN(t.linkedNode);i!==void 0&&t.linkedNode.nodeRange.path===e&&n.push({name:t.key,kind:i,location:t.linkedNode.nodeRange.getBoundingLocation().toServerLocation()})}else if(t.isFunctionHolderScope())for(let[i,o]of t.childScopeTable)o.linkedNode!==void 0&&o.linkedNode.nodeRange.path===e&&n.push({name:t.key,kind:Wt.SymbolKind.Function,location:o.linkedNode.nodeRange.getBoundingLocation().toServerLocation()});for(let i of t.namespaceNodes)i.linkedToken.location.path===e&&i.node.namespaceList.at(-1)===i.linkedToken&&n.push({name:i.node.namespaceList.map(o=>o.text).join("::"),kind:Wt.SymbolKind.Namespace,location:i.node.nodeRange.getBoundingLocation().toServerLocation()});for(let[i,o]of t.childScopeTable)o.isAnonymousScope()||n.push(...Wg(e,o));return n}function zN(e){switch(e.nodeName){case"Enum":return Wt.SymbolKind.Enum;case"Class":return Wt.SymbolKind.Class;case"VirtualProp":return Wt.SymbolKind.Property;case"Interface":return Wt.SymbolKind.Interface;case"Func":return Wt.SymbolKind.Function;case"Lambda":return Wt.SymbolKind.Function}}var Hg=ue(on());function Vg(e,t,n,i){if(i==="\b")return UN(e,n)}function UN(e,t){let n=t.movedBy(0,-1);return vi(e,n)!==void 0?[]:[Hg.TextEdit.del(new jt(new me(t.line-1,1e6),t))]}var xi=ue(require("fs")),Bs=ue(require("path")),$g=require("url");function zg(e,t){let n;try{e.startsWith("file://")?n=(0,$g.fileURLToPath)(e):n=Bs.resolve(e);let i=Bs.dirname(n);return xi.existsSync(i)||xi.mkdirSync(i,{recursive:!0}),xi.writeFileSync(n,t,{encoding:"utf-8",flag:"w"}),!0}catch{return!1}}function Ug(e,t,n){let i=t.getContext().filepath,o=vi(e,n);if(o?.token.isStringToken()){let r=GN(i,o.token);if(r!==void 0)return r}}function GN(e,t){let n=co(e,t.getStringContent());if(gs(n)!==!1)return{uri:n,range:{start:{line:0,character:0},end:{line:0,character:0}}}}var U=gn.createConnection(gn.ProposedFeatures.all),Gg=!1,Lu=!1,KN=!1;U.onInitialize(e=>{let t=e.capabilities;Gg=t.workspace?.configuration!==void 0,Lu=t.workspace?.workspaceFolders!==void 0,KN=t.textDocument?.publishDiagnostics?.relatedInformation!==void 0;let n={capabilities:{textDocumentSync:gn.TextDocumentSyncKind.Incremental,definitionProvider:!0,declarationProvider:!0,referencesProvider:!0,documentSymbolProvider:!0,codeActionProvider:{codeActionKinds:["quickfix"],resolveProvider:!0},renameProvider:!0,hoverProvider:!0,signatureHelpProvider:{triggerCharacters:["(",")",","],retriggerCharacters:["="]},completionProvider:{resolveProvider:!0,triggerCharacters:[" ",".",":","/"]},semanticTokensProvider:{legend:{tokenTypes:pm,tokenModifiers:mm},range:!1,full:!0},inlayHintProvider:!0,documentFormattingProvider:!0,documentRangeFormattingProvider:!0,documentOnTypeFormattingProvider:{firstTriggerCharacter:";",moreTriggerCharacter:["}",`
`]}}};if(Lu){let i={scheme:"file",pattern:{glob:"**/{as.predefined,*.as}"}};n.capabilities.workspace={workspaceFolders:{supported:!0},fileOperations:{didRename:{filters:[i]},didDelete:{filters:[i]}}}}return n});function Kg(){U.workspace.getConfiguration("angelScript").then(e=>{Rm(e),oe.reinspectAllFiles(),U.languages.diagnostics.refresh()})}U.onInitialized(()=>{Gg&&U.client.register(gn.DidChangeConfigurationNotification.type,void 0),Lu&&U.workspace.onDidChangeWorkspaceFolders(e=>{U.console.log("Workspace folder change event received.")}),Kg()});U.onDidChangeConfiguration(e=>{Kg()});var Qg=new Map,oe=new Ds;U.onDidOpenTextDocument(e=>{let t=e.textDocument;Qg.set(e.textDocument.uri,$i.create(t.uri,t.languageId,t.version,t.text)),oe.getRecord(t.uri).content!==t.text&&oe.inspectFile(t.uri,t.text,{isOpen:!0})});U.onDidChangeTextDocument(e=>{let t=Qg.get(e.textDocument.uri);if(t===void 0){U.console.error("Missing a document: "+e.textDocument.uri);return}$i.update(t,e.contentChanges,e.textDocument.version),oe.inspectFile(t.uri,t.getText(),{isOpen:!0,changes:e.contentChanges});let n=Iu.get(t.uri);n!==void 0&&rg(n,e.contentChanges)});U.onDidCloseTextDocument(e=>{});U.workspace.onDidRenameFiles(e=>{for(let t of e.files)oe.deleteRecord(t.oldUri)});U.workspace.onDidDeleteFiles(e=>{for(let t of e.files)oe.deleteRecord(t.uri)});U.onDidChangeWatchedFiles(e=>{});U.languages.semanticTokens.on(e=>pg(oe.getRecord(e.textDocument.uri).rawTokens));var Iu=new Map;U.languages.inlayHint.on(e=>{let t=e.textDocument.uri,n=jt.create(e.range),i=oe.getRecord(t);if(i.isAnalyzerPending)return Iu.get(t);let o=_g(i.analyzerScope.globalScope,new qe(t,n.start,n.end));return Iu.set(t,o),o});U.onDefinition(e=>{let t=oe.getRecord(e.textDocument.uri),n=t.analyzerScope.globalScope,i=me.create(e.position),o=Zr(n,Fu(),i);return o!==void 0?o.location.toServerLocation():Ug(t.rawTokens,n,i)});function Fu(){return oe.getAllRecords().map(e=>e.analyzerScope.globalScope)}function Jg(e){oe.flushRecord(e.textDocument.uri);let t=oe.getRecord(e.textDocument.uri).analyzerScope.globalScope,n=me.create(e.position);return mg(t,Fu(),n).map(o=>o.location.toServerLocation())}U.onReferences(e=>Jg(e));U.onDocumentSymbol(e=>Bg(oe.getRecord(e.textDocument.uri).analyzerScope.globalScope));var Ws=[];U.onCodeAction(e=>{let t=oe.getRecord(e.textDocument.uri).analyzerScope.globalScope,n=jt.create(e.range);return Ws=Eg(t,Fu(),n),Ws.forEach((i,o)=>i.action.data=o),Ws.map(i=>i.action)});U.onCodeActionResolve(e=>{let t=e.data,n=Ws[t];return n===void 0?(Ge.error("Received an invalid code action."),e):(n.resolver(e),e)});U.onRenameRequest(e=>{let t=Jg(e),n={};return t.forEach(i=>{let o=i.uri;n[o]===void 0&&(n[o]=[]),n[o].push({range:i.range,newText:e.newName})}),{changes:n}});U.onHover(e=>{oe.flushRecord(e.textDocument.uri);let t=oe.getRecord(e.textDocument.uri).analyzerScope.globalScope,n=me.create(e.position);return jg(t,n)});var Hs={uri:"",items:[]};U.onCompletion(e=>{let t=e.textDocument.uri,n=me.create(e.position),i=Fg(oe.getRecord(t).rawTokens,n);if(i!==void 0)return i;oe.flushRecord(t);let o=oe.getRecord(t).analyzerScope;if(o===void 0)return[];let r=ug(o.globalScope,me.create(e.position));return r.forEach((s,u)=>{s.item.data=u}),Hs.uri=t,Hs.items=r,r.map(s=>s.item)});U.onCompletionResolve(e=>{let t=oe.getRecord(Hs.uri).analyzerScope.globalScope;if(typeof e.data!="number")return e;let n=Hs.items[e.data];return n.item.label!==e.label&&Ge.error("Received an invalid completion item."),qg(t,n)});U.onSignatureHelp(e=>{let t=e.textDocument.uri;oe.flushRecord(t);let n=oe.getRecord(t).analyzerScope;return n===void 0?null:Cg(n.globalScope,e.position,t)});U.onDocumentFormatting(e=>{oe.flushRecord();let t=oe.getRecord(e.textDocument.uri);return Pg(t.content,t.rawTokens,t.ast)});U.onExecuteCommand(e=>{});U.onDocumentOnTypeFormatting(e=>{let t=oe.getRecord(e.textDocument.uri);return Vg(t.rawTokens,t.analyzerScope.globalScope,me.create(e.position),e.ch)});U.onRequest("angelScript/printGlobalScope",e=>{let t=e.uri,n=oe.getRecord(t).analyzerScope.globalScope,i=cu(n),o=t+".out";return zg(o,i)?o:void 0});U.listen();oe.registerDiagnosticsCallback(U.sendDiagnostics);
